<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multi-Group Confirmatory Factor Analysis • learnSEM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-Group Confirmatory Factor Analysis">
<meta name="description" content="This vignette includes the lecture slides for multigroup confirmatory factor analysis (part 10).
">
<meta property="og:description" content="This vignette includes the lecture slides for multigroup confirmatory factor analysis (part 10).
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">learnSEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lecture_cfa.html">CFA: Basics</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_data_screen.html">Data Screening</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_efa.html">Exploratory Factor Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_introR.html">Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_irt.html">Item Response Theory</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_lgm.html">Latent Growth Models</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_mgcfa.html">Multi-Group Confirmatory Factor Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_mtmm.html">Multi-Trait Multi-Method</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_path.html">Path Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_secondcfa.html">Confirmatory Factor Analysis: Second Order</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_sem.html">Full SEM</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_terms.html">Terms and Concepts</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multi-Group Confirmatory Factor Analysis</h1>
            
      

      <div class="d-none name"><code>lecture_mgcfa.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="multigroup-models">Multigroup Models<a class="anchor" aria-label="anchor" href="#multigroup-models"></a>
</h2>
<ul>
<li>Let’s start with some terminology specific to multigroup models:
invariance = equivalence</li>
<li>Under different conditions, do the measurements yield the same
measurement of attributes?</li>
<li>Generally, we’ve seen that latent variable models are estimating the
data based on the covariances. For these models, we will also add the
mean structure.</li>
<li>While you can test many groups in these models, you will want to
generally compare two at a time.</li>
</ul>
</div>
<div class="section level2">
<h2 id="mean-structure">Mean Structure<a class="anchor" aria-label="anchor" href="#mean-structure"></a>
</h2>
<ul>
<li>Mean structure represents the intercept of our manifest
variables</li>
<li>In regression, remember that the Y-intercept is the mean of Y (given
X = 0 or no X variables)
<ul>
<li>That’s your best guess for what someone is going to score on that
item without any other X information</li>
<li>Same idea in a latent variable model - it’s the starting value for
that manifest variable.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="latent-means">Latent Means<a class="anchor" aria-label="anchor" href="#latent-means"></a>
</h2>
<ul>
<li>Latent means are the estimated score on the latent variable for
participants.</li>
<li>It’s a weighted score of each item’s original value with their path
coefficient, and all items are averaged together.</li>
<li>We can use <code><a href="https://rdrr.io/pkg/lavaan/man/lavPredict.html" class="external-link">lavPredict()</a></code> to calculate these for us.</li>
</ul>
</div>
<div class="section level2">
<h2 id="multigroup-questions">Multigroup Questions<a class="anchor" aria-label="anchor" href="#multigroup-questions"></a>
</h2>
<ul>
<li>Do items act the same across groups?</li>
<li>Is the factor structure the same across groups?</li>
<li>Are the paths equal across groups?</li>
<li>Are the latent means equal across groups?</li>
</ul>
</div>
<div class="section level2">
<h2 id="how-to-mg">How to MG<a class="anchor" aria-label="anchor" href="#how-to-mg"></a>
</h2>
<ul>
<li>First, test the model as a regular CFA with everyone in the dataset
<ul>
<li>This model will tell you if you have problems with your CFA</li>
<li>This model is the least restrictive</li>
<li>Do not use grouping variables</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="how-to-mg-1">How to MG<a class="anchor" aria-label="anchor" href="#how-to-mg-1"></a>
</h2>
<ul>
<li>Second, test each group separately with the same CFA structure to
determine that each individual group fits ok.</li>
<li>Fit indices often decrease slightly here, because sample size is
smaller (which usually has a bit more error variance).</li>
<li>Mainly, you are looking for models that completely break down
<ul>
<li>You could have a poor fitting CFA overall and use this step to see
if that’s because one group just does not fit.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="how-to-mg-2">How to MG<a class="anchor" aria-label="anchor" href="#how-to-mg-2"></a>
</h2>
<ul>
<li>The next steps will be to nest the two models together.</li>
<li>Nesting is like stacking the models together (like pancakes).</li>
<li>For the nested model steps, most people use Brown’s terminology and
procedure.</li>
</ul>
</div>
<div class="section level2">
<h2 id="how-to-mg-3">How to MG<a class="anchor" aria-label="anchor" href="#how-to-mg-3"></a>
</h2>
<ul>
<li>All the possible paths:
<ul>
<li>The whole model (the picture)</li>
<li>Loadings (regression weights)</li>
<li>Intercepts (y-intercept for each item)</li>
<li>Error variances (variance)</li>
<li>Factor variances (variances for the latents)</li>
<li>Factor covariances (correlation)</li>
<li>Factor means (latent means)</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="equal-form-configural-invariance">Equal Form / Configural Invariance<a class="anchor" aria-label="anchor" href="#equal-form-configural-invariance"></a>
</h2>
<ul>
<li>In this model, you put the two groups together into the same
model.</li>
<li>You do not force any of the paths to be the same, but you are
forcing the model picture to be the same.</li>
<li>You are testing if both groups show the same factor structure
(configuration).</li>
</ul>
</div>
<div class="section level2">
<h2 id="metric-invariance">Metric Invariance<a class="anchor" aria-label="anchor" href="#metric-invariance"></a>
</h2>
<ul>
<li>In this model, you are forcing all the factor loadings (regression
weights) to be exactly the same.</li>
<li>This step will tell you if the groups have the same weights for each
question – or if some questions have different signs or strengths.</li>
</ul>
</div>
<div class="section level2">
<h2 id="scalar-invariance">Scalar Invariance<a class="anchor" aria-label="anchor" href="#scalar-invariance"></a>
</h2>
<ul>
<li>In this model, you are forcing the intercepts of the items to be the
same.</li>
<li>This step will tell you if items have the same starting point –
remember that the y-intercept is the mean of the item.</li>
<li>If a MG model is going to indicate non-invariance – this step is
often the one that breaks.</li>
</ul>
</div>
<div class="section level2">
<h2 id="strict-factorial-invariance">Strict Factorial Invariance<a class="anchor" aria-label="anchor" href="#strict-factorial-invariance"></a>
</h2>
<ul>
<li>In this model, you are forcing the error variances for each item to
be the same.</li>
<li>This step will tell you if the variance (the spread) of the item is
the same for each group.<br>
</li>
<li>If you get differences, that indicates one group has a larger range
of answers than another, which indicates they are more
heterogeneous.</li>
</ul>
</div>
<div class="section level2">
<h2 id="other-steps">Other Steps<a class="anchor" aria-label="anchor" href="#other-steps"></a>
</h2>
<ul>
<li>Most of the previous steps are on the manifest/measured variables
only.</li>
<li>Generally, we focus on those because they indicate performance of
the scale.</li>
<li>Population Heterogeneity:
<ul>
<li>Equal factor variances: Testing if latents have the same set of
variance – means that the overall score has the same spread</li>
<li>Equal factor covariances: Testing if the correlations between
factors is the same for each group</li>
<li>Equal latent means: Testing if the overall latent means are equal
for each group</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="how-to-judge">How to Judge<a class="anchor" aria-label="anchor" href="#how-to-judge"></a>
</h2>
<ul>
<li>How can I tell if steps are invariant?</li>
<li>You will expect fit to get worse as you go because you are being
more and more restrictive.</li>
<li>While we can use change in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>,
most suggest a change in CFI &gt; .01 to be a difference in fit.</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-breakdown">Model Breakdown<a class="anchor" aria-label="anchor" href="#model-breakdown"></a>
</h2>
<ul>
<li>What do I do if steps are NOT invariant?</li>
<li>Partial invariance – when strict invariance cannot be met, you can
test for partial invariance</li>
<li>Partial invariance occurs when most of the items are invariant but a
couple.</li>
<li>You have to meet the invariance criteria, so you trying to bring
your bad model “up” to the invariant level</li>
<li>You want to do as few of items as possible</li>
</ul>
</div>
<div class="section level2">
<h2 id="partial-invariance">Partial Invariance<a class="anchor" aria-label="anchor" href="#partial-invariance"></a>
</h2>
<ul>
<li>So, how do I test partial invariance?</li>
<li>We can use modification indices to see which paths are the most
problematic.</li>
<li>You will change ONE item at a time.</li>
<li>Slowly add items to bring CFI up to an acceptable change level
(i.e. .01 or less change from the previous model).</li>
</ul>
</div>
<div class="section level2">
<h2 id="test-latent-means">Test Latent Means<a class="anchor" aria-label="anchor" href="#test-latent-means"></a>
</h2>
<ul>
<li>After saying the measured variables are partially to fully
invariant, sometimes people also calculate latent means and use
<em>t</em>-tests to determine if they are different by groups.
<ul>
<li>Instead of doing all the population heterogeneity steps.</li>
</ul>
</li>
<li>At the minimum, it is useful to know how to calculate a weighted
score for each participant.</li>
<li>We normally use EFA/CFA to show that each question has a nice
loading and the questions load together</li>
<li>And then we use subtotals or averages to create an overall score for
each latent
<ul>
<li>This procedure totally ignores the fact that loadings are often
different.</li>
<li>Why lose that information?</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="lets-get-started">Let’s get started!<a class="anchor" aria-label="anchor" href="#lets-get-started"></a>
</h2>
<ul>
<li>Equality constraints</li>
<li>We’ve talked before about setting paths equal to each other by
calling them the same parameter name
<ul>
<li><code>cheese =~ a\*feta + a\*swiss</code></li>
<li>So feta and swiss will be estimated at the same value.</li>
</ul>
</li>
<li>The entire purpose of a multigroup model is to build equality
constraints</li>
<li>A few packages used to do this … but have become more trouble than
they are worth, so let’s look at how to do these steps with just
<code>lavaan</code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="an-example">An Example<a class="anchor" aria-label="anchor" href="#an-example"></a>
</h2>
<ul>
<li>Using the RS-14 scale: a one-factor measure of resiliency</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gesistsa.github.io/rio/" class="external-link">rio</a></span><span class="op">)</span></span>
<span><span class="va">res.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"data/assignment_mgcfa.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Sex Ethnicity RS1 RS2 RS3 RS4 RS5 RS6 RS7 RS8 RS9 RS10 RS11 RS12 RS13 RS14</span></span>
<span><span class="co">#&gt; 1   2         0   4   4   4   4   4   4   4   4   4    4    4    4    4    4</span></span>
<span><span class="co">#&gt; 2   1         0   5   2   6   4   4   5   4   5   5    4    4    6    4    4</span></span>
<span><span class="co">#&gt; 3   2         0   7   7   7   7   2   7   7   4   3    7    7    5    7    5</span></span>
<span><span class="co">#&gt; 4   2         0   7   6   6   7   7   7   7   7   7    7    7    6    7    7</span></span>
<span><span class="co">#&gt; 5   1         0   2   2   2   2   2   2   2   2   2    2    2    2    2    2</span></span>
<span><span class="co">#&gt; 6   2         0   4   5   5   7   5   7   5   7   5    4    5    6    6    5</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="clean-up-the-data">Clean up the data<a class="anchor" aria-label="anchor" href="#clean-up-the-data"></a>
</h2>
<ul>
<li>By not including other labels, we are dropping those categories</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   1   2   3 </span></span>
<span><span class="co">#&gt; 244 266   1</span></span>
<span><span class="va">res.data</span><span class="op">$</span><span class="va">Sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">$</span><span class="va">Sex</span>, </span>
<span>                       levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="st">"Women"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">res.data</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Sex</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 510</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="start-with-overall-cfa">Start with Overall CFA<a class="anchor" aria-label="anchor" href="#start-with-overall-cfa"></a>
</h2>
<ul>
<li>NEW: <code>meanstructure = TRUE</code>
</li>
<li>Gives you the intercepts and means in the model.</li>
<li>You want to turn that one at the beginning, and you are first
examining models with means, so you can tell if you have bad parameters
at the start.</li>
</ul>
</div>
<div class="section level2">
<h2 id="start-with-overall-cfa-1">Start with Overall CFA<a class="anchor" aria-label="anchor" href="#start-with-overall-cfa-1"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">overall.model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">RS =~ RS1 + RS2 + RS3 + RS4 + RS5 + RS6 + RS7 + RS8 + RS9 + RS10 + RS11 + RS12 + RS13 + RS14</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="va">overall.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">res.data</span>, </span>
<span>                   meanstructure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">##this is important </span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examine-overall-fit">Examine Overall Fit<a class="anchor" aria-label="anchor" href="#examine-overall-fit"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">overall.fit</span>, </span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        fit.measure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 26 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        42</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           510</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               368.984</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                77</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              4064.761</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                91</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.927</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.913</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)             -13050.226</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)     -12865.734</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                               26184.452</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                             26362.297</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      26228.983</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.086</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.078</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.095</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.882</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.041</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.135    0.637</span></span>
<span><span class="co">#&gt;     RS2               1.230    0.091   13.529    0.000    1.397    0.685</span></span>
<span><span class="co">#&gt;     RS3               1.065    0.083   12.806    0.000    1.209    0.641</span></span>
<span><span class="co">#&gt;     RS4               1.231    0.094   13.150    0.000    1.398    0.662</span></span>
<span><span class="co">#&gt;     RS5               1.203    0.094   12.846    0.000    1.366    0.644</span></span>
<span><span class="co">#&gt;     RS6               1.218    0.085   14.258    0.000    1.383    0.732</span></span>
<span><span class="co">#&gt;     RS7               1.264    0.087   14.554    0.000    1.435    0.751</span></span>
<span><span class="co">#&gt;     RS8               1.207    0.087   13.836    0.000    1.371    0.705</span></span>
<span><span class="co">#&gt;     RS9               1.271    0.088   14.461    0.000    1.444    0.745</span></span>
<span><span class="co">#&gt;     RS10              1.193    0.086   13.946    0.000    1.355    0.712</span></span>
<span><span class="co">#&gt;     RS11              1.318    0.091   14.526    0.000    1.496    0.749</span></span>
<span><span class="co">#&gt;     RS12              1.156    0.086   13.494    0.000    1.312    0.683</span></span>
<span><span class="co">#&gt;     RS13              1.357    0.093   14.634    0.000    1.541    0.756</span></span>
<span><span class="co">#&gt;     RS14              1.335    0.086   15.587    0.000    1.515    0.821</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               4.849    0.079   61.416    0.000    4.849    2.720</span></span>
<span><span class="co">#&gt;    .RS2               4.218    0.090   46.752    0.000    4.218    2.070</span></span>
<span><span class="co">#&gt;    .RS3               4.163    0.084   49.853    0.000    4.163    2.208</span></span>
<span><span class="co">#&gt;    .RS4               4.451    0.094   47.600    0.000    4.451    2.108</span></span>
<span><span class="co">#&gt;    .RS5               3.808    0.094   40.536    0.000    3.808    1.795</span></span>
<span><span class="co">#&gt;    .RS6               5.037    0.084   60.180    0.000    5.037    2.665</span></span>
<span><span class="co">#&gt;    .RS7               4.937    0.085   58.353    0.000    4.937    2.584</span></span>
<span><span class="co">#&gt;    .RS8               4.351    0.086   50.508    0.000    4.351    2.237</span></span>
<span><span class="co">#&gt;    .RS9               4.233    0.086   49.333    0.000    4.233    2.185</span></span>
<span><span class="co">#&gt;    .RS10              4.622    0.084   54.829    0.000    4.622    2.428</span></span>
<span><span class="co">#&gt;    .RS11              4.486    0.088   50.739    0.000    4.486    2.247</span></span>
<span><span class="co">#&gt;    .RS12              5.006    0.085   58.865    0.000    5.006    2.607</span></span>
<span><span class="co">#&gt;    .RS13              4.894    0.090   54.257    0.000    4.894    2.403</span></span>
<span><span class="co">#&gt;    .RS14              4.749    0.082   58.132    0.000    4.749    2.574</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               1.890    0.124   15.242    0.000    1.890    0.594</span></span>
<span><span class="co">#&gt;    .RS2               2.200    0.146   15.025    0.000    2.200    0.530</span></span>
<span><span class="co">#&gt;    .RS3               2.094    0.138   15.225    0.000    2.094    0.589</span></span>
<span><span class="co">#&gt;    .RS4               2.504    0.165   15.137    0.000    2.504    0.562</span></span>
<span><span class="co">#&gt;    .RS5               2.636    0.173   15.215    0.000    2.636    0.586</span></span>
<span><span class="co">#&gt;    .RS6               1.660    0.113   14.740    0.000    1.660    0.465</span></span>
<span><span class="co">#&gt;    .RS7               1.591    0.109   14.588    0.000    1.591    0.436</span></span>
<span><span class="co">#&gt;    .RS8               1.905    0.128   14.917    0.000    1.905    0.503</span></span>
<span><span class="co">#&gt;    .RS9               1.671    0.114   14.639    0.000    1.671    0.445</span></span>
<span><span class="co">#&gt;    .RS10              1.788    0.120   14.875    0.000    1.788    0.493</span></span>
<span><span class="co">#&gt;    .RS11              1.749    0.120   14.604    0.000    1.749    0.439</span></span>
<span><span class="co">#&gt;    .RS12              1.966    0.131   15.036    0.000    1.966    0.533</span></span>
<span><span class="co">#&gt;    .RS13              1.776    0.122   14.543    0.000    1.776    0.428</span></span>
<span><span class="co">#&gt;    .RS14              1.107    0.081   13.753    0.000    1.107    0.325</span></span>
<span><span class="co">#&gt;     RS                1.289    0.164    7.847    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.406</span></span>
<span><span class="co">#&gt;     RS2               0.470</span></span>
<span><span class="co">#&gt;     RS3               0.411</span></span>
<span><span class="co">#&gt;     RS4               0.438</span></span>
<span><span class="co">#&gt;     RS5               0.414</span></span>
<span><span class="co">#&gt;     RS6               0.535</span></span>
<span><span class="co">#&gt;     RS7               0.564</span></span>
<span><span class="co">#&gt;     RS8               0.497</span></span>
<span><span class="co">#&gt;     RS9               0.555</span></span>
<span><span class="co">#&gt;     RS10              0.507</span></span>
<span><span class="co">#&gt;     RS11              0.561</span></span>
<span><span class="co">#&gt;     RS12              0.467</span></span>
<span><span class="co">#&gt;     RS13              0.572</span></span>
<span><span class="co">#&gt;     RS14              0.675</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="make-a-table-of-fit-indices">Make a table of fit indices<a class="anchor" aria-label="anchor" href="#make-a-table-of-fit-indices"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="va">table_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="fl">9</span>, ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">table_fit</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Model"</span>, <span class="st">"X2"</span>, <span class="st">"df"</span>, <span class="st">"CFI"</span>, <span class="st">"RMSEA"</span>, <span class="st">"SRMR"</span><span class="op">)</span></span>
<span><span class="va">table_fit</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Overall Model"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">overall.fit</span>, </span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"cfi"</span>,</span>
<span>                                                   <span class="st">"rmsea"</span>, <span class="st">"srmr"</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">table_fit</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Model</th>
<th align="left">X2</th>
<th align="left">df</th>
<th align="left">CFI</th>
<th align="left">RMSEA</th>
<th align="left">SRMR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Overall Model</td>
<td align="left">368.984</td>
<td align="left">77</td>
<td align="left">0.927</td>
<td align="left">0.086</td>
<td align="left">0.041</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="create-a-picture">Create a Picture<a class="anchor" aria-label="anchor" href="#create-a-picture"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SachaEpskamp/semPlot" class="external-link">semPlot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html" class="external-link">semPaths</a></span><span class="op">(</span><span class="va">overall.fit</span>, </span>
<span>         whatLabels <span class="op">=</span> <span class="st">"std"</span>, </span>
<span>         edge.label.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         layout <span class="op">=</span> <span class="st">"tree"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_mgcfa_files/figure-html/semplot-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="men-overall-summary">Men Overall Summary<a class="anchor" aria-label="anchor" href="#men-overall-summary"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">men.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>,</span>
<span>               data <span class="op">=</span> <span class="va">res.data</span><span class="op">[</span><span class="va">res.data</span><span class="op">$</span><span class="va">Sex</span> <span class="op">==</span> <span class="st">"Men"</span> , <span class="op">]</span>, </span>
<span>               meanstructure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">men.fit</span>,</span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        fit.measure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 25 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        42</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           244</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               271.457</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                77</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              2515.572</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                91</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.920</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.905</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)              -6043.672</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -5907.944</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                               12171.345</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                             12318.226</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      12185.091</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.102</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.089</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.115</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.997</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.041</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.293    0.701</span></span>
<span><span class="co">#&gt;     RS2               1.190    0.105   11.360    0.000    1.538    0.755</span></span>
<span><span class="co">#&gt;     RS3               1.015    0.097   10.467    0.000    1.313    0.694</span></span>
<span><span class="co">#&gt;     RS4               1.131    0.108   10.498    0.000    1.462    0.696</span></span>
<span><span class="co">#&gt;     RS5               1.098    0.108   10.168    0.000    1.420    0.674</span></span>
<span><span class="co">#&gt;     RS6               1.122    0.101   11.093    0.000    1.451    0.737</span></span>
<span><span class="co">#&gt;     RS7               1.125    0.100   11.204    0.000    1.455    0.745</span></span>
<span><span class="co">#&gt;     RS8               1.188    0.101   11.799    0.000    1.536    0.785</span></span>
<span><span class="co">#&gt;     RS9               1.200    0.098   12.228    0.000    1.552    0.815</span></span>
<span><span class="co">#&gt;     RS10              1.103    0.097   11.354    0.000    1.426    0.755</span></span>
<span><span class="co">#&gt;     RS11              1.185    0.101   11.757    0.000    1.533    0.782</span></span>
<span><span class="co">#&gt;     RS12              1.213    0.102   11.877    0.000    1.568    0.791</span></span>
<span><span class="co">#&gt;     RS13              1.331    0.107   12.497    0.000    1.722    0.833</span></span>
<span><span class="co">#&gt;     RS14              1.267    0.101   12.546    0.000    1.639    0.837</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               4.697    0.118   39.741    0.000    4.697    2.544</span></span>
<span><span class="co">#&gt;    .RS2               4.197    0.130   32.180    0.000    4.197    2.060</span></span>
<span><span class="co">#&gt;    .RS3               4.242    0.121   35.035    0.000    4.242    2.243</span></span>
<span><span class="co">#&gt;    .RS4               4.615    0.134   34.330    0.000    4.615    2.198</span></span>
<span><span class="co">#&gt;    .RS5               3.971    0.135   29.448    0.000    3.971    1.885</span></span>
<span><span class="co">#&gt;    .RS6               4.889    0.126   38.788    0.000    4.889    2.483</span></span>
<span><span class="co">#&gt;    .RS7               4.820    0.125   38.520    0.000    4.820    2.466</span></span>
<span><span class="co">#&gt;    .RS8               4.422    0.125   35.315    0.000    4.422    2.261</span></span>
<span><span class="co">#&gt;    .RS9               4.299    0.122   35.259    0.000    4.299    2.257</span></span>
<span><span class="co">#&gt;    .RS10              4.537    0.121   37.516    0.000    4.537    2.402</span></span>
<span><span class="co">#&gt;    .RS11              4.467    0.125   35.614    0.000    4.467    2.280</span></span>
<span><span class="co">#&gt;    .RS12              4.820    0.127   37.954    0.000    4.820    2.430</span></span>
<span><span class="co">#&gt;    .RS13              4.799    0.132   36.291    0.000    4.799    2.323</span></span>
<span><span class="co">#&gt;    .RS14              4.697    0.125   37.467    0.000    4.697    2.399</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               1.736    0.165   10.517    0.000    1.736    0.509</span></span>
<span><span class="co">#&gt;    .RS2               1.783    0.173   10.317    0.000    1.783    0.430</span></span>
<span><span class="co">#&gt;    .RS3               1.852    0.176   10.535    0.000    1.852    0.518</span></span>
<span><span class="co">#&gt;    .RS4               2.270    0.216   10.529    0.000    2.270    0.515</span></span>
<span><span class="co">#&gt;    .RS5               2.421    0.229   10.589    0.000    2.421    0.546</span></span>
<span><span class="co">#&gt;    .RS6               1.771    0.170   10.393    0.000    1.771    0.457</span></span>
<span><span class="co">#&gt;    .RS7               1.702    0.164   10.363    0.000    1.702    0.446</span></span>
<span><span class="co">#&gt;    .RS8               1.466    0.144   10.162    0.000    1.466    0.383</span></span>
<span><span class="co">#&gt;    .RS9               1.219    0.122    9.960    0.000    1.219    0.336</span></span>
<span><span class="co">#&gt;    .RS10              1.535    0.149   10.319    0.000    1.535    0.430</span></span>
<span><span class="co">#&gt;    .RS11              1.489    0.146   10.179    0.000    1.489    0.388</span></span>
<span><span class="co">#&gt;    .RS12              1.475    0.146   10.130    0.000    1.475    0.375</span></span>
<span><span class="co">#&gt;    .RS13              1.303    0.133    9.795    0.000    1.303    0.305</span></span>
<span><span class="co">#&gt;    .RS14              1.149    0.118    9.762    0.000    1.149    0.300</span></span>
<span><span class="co">#&gt;     RS                1.672    0.270    6.188    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.491</span></span>
<span><span class="co">#&gt;     RS2               0.570</span></span>
<span><span class="co">#&gt;     RS3               0.482</span></span>
<span><span class="co">#&gt;     RS4               0.485</span></span>
<span><span class="co">#&gt;     RS5               0.454</span></span>
<span><span class="co">#&gt;     RS6               0.543</span></span>
<span><span class="co">#&gt;     RS7               0.554</span></span>
<span><span class="co">#&gt;     RS8               0.617</span></span>
<span><span class="co">#&gt;     RS9               0.664</span></span>
<span><span class="co">#&gt;     RS10              0.570</span></span>
<span><span class="co">#&gt;     RS11              0.612</span></span>
<span><span class="co">#&gt;     RS12              0.625</span></span>
<span><span class="co">#&gt;     RS13              0.695</span></span>
<span><span class="co">#&gt;     RS14              0.700</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="women-overall-summary">Women Overall Summary<a class="anchor" aria-label="anchor" href="#women-overall-summary"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">women.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">res.data</span><span class="op">[</span><span class="va">res.data</span><span class="op">$</span><span class="va">Sex</span> <span class="op">==</span> <span class="st">"Women"</span> , <span class="op">]</span>, </span>
<span>                 meanstructure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">women.fit</span>,</span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        fit.measure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 29 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        42</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           266</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               258.610</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                77</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              1813.360</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                91</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.895</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.875</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)              -6938.738</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -6809.434</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                               13961.477</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                             14111.984</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      13978.820</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.094</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.082</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.107</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.968</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.052</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               0.958    0.560</span></span>
<span><span class="co">#&gt;     RS2               1.291    0.163    7.908    0.000    1.237    0.607</span></span>
<span><span class="co">#&gt;     RS3               1.140    0.149    7.675    0.000    1.093    0.582</span></span>
<span><span class="co">#&gt;     RS4               1.401    0.172    8.157    0.000    1.342    0.636</span></span>
<span><span class="co">#&gt;     RS5               1.381    0.172    8.046    0.000    1.323    0.623</span></span>
<span><span class="co">#&gt;     RS6               1.381    0.155    8.933    0.000    1.323    0.733</span></span>
<span><span class="co">#&gt;     RS7               1.485    0.162    9.150    0.000    1.423    0.764</span></span>
<span><span class="co">#&gt;     RS8               1.259    0.156    8.055    0.000    1.206    0.624</span></span>
<span><span class="co">#&gt;     RS9               1.400    0.164    8.543    0.000    1.341    0.682</span></span>
<span><span class="co">#&gt;     RS10              1.333    0.158    8.426    0.000    1.278    0.668</span></span>
<span><span class="co">#&gt;     RS11              1.503    0.172    8.754    0.000    1.440    0.709</span></span>
<span><span class="co">#&gt;     RS12              1.106    0.145    7.609    0.000    1.060    0.575</span></span>
<span><span class="co">#&gt;     RS13              1.421    0.167    8.513    0.000    1.362    0.679</span></span>
<span><span class="co">#&gt;     RS14              1.470    0.155    9.476    0.000    1.408    0.813</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               4.989    0.105   47.546    0.000    4.989    2.915</span></span>
<span><span class="co">#&gt;    .RS2               4.237    0.125   33.918    0.000    4.237    2.080</span></span>
<span><span class="co">#&gt;    .RS3               4.090    0.115   35.528    0.000    4.090    2.178</span></span>
<span><span class="co">#&gt;    .RS4               4.301    0.129   33.220    0.000    4.301    2.037</span></span>
<span><span class="co">#&gt;    .RS5               3.658    0.130   28.090    0.000    3.658    1.722</span></span>
<span><span class="co">#&gt;    .RS6               5.173    0.111   46.757    0.000    5.173    2.867</span></span>
<span><span class="co">#&gt;    .RS7               5.045    0.114   44.162    0.000    5.045    2.708</span></span>
<span><span class="co">#&gt;    .RS8               4.286    0.119   36.153    0.000    4.286    2.217</span></span>
<span><span class="co">#&gt;    .RS9               4.173    0.121   34.619    0.000    4.173    2.123</span></span>
<span><span class="co">#&gt;    .RS10              4.699    0.117   40.054    0.000    4.699    2.456</span></span>
<span><span class="co">#&gt;    .RS11              4.504    0.124   36.179    0.000    4.504    2.218</span></span>
<span><span class="co">#&gt;    .RS12              5.177    0.113   45.781    0.000    5.177    2.807</span></span>
<span><span class="co">#&gt;    .RS13              4.981    0.123   40.489    0.000    4.981    2.483</span></span>
<span><span class="co">#&gt;    .RS14              4.797    0.106   45.141    0.000    4.797    2.768</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               2.010    0.181   11.094    0.000    2.010    0.686</span></span>
<span><span class="co">#&gt;    .RS2               2.620    0.239   10.972    0.000    2.620    0.631</span></span>
<span><span class="co">#&gt;    .RS3               2.332    0.211   11.041    0.000    2.332    0.661</span></span>
<span><span class="co">#&gt;    .RS4               2.657    0.244   10.881    0.000    2.657    0.596</span></span>
<span><span class="co">#&gt;    .RS5               2.760    0.253   10.924    0.000    2.760    0.612</span></span>
<span><span class="co">#&gt;    .RS6               1.505    0.145   10.414    0.000    1.505    0.462</span></span>
<span><span class="co">#&gt;    .RS7               1.447    0.142   10.186    0.000    1.447    0.417</span></span>
<span><span class="co">#&gt;    .RS8               2.283    0.209   10.921    0.000    2.283    0.611</span></span>
<span><span class="co">#&gt;    .RS9               2.066    0.193   10.696    0.000    2.066    0.534</span></span>
<span><span class="co">#&gt;    .RS10              2.028    0.189   10.759    0.000    2.028    0.554</span></span>
<span><span class="co">#&gt;    .RS11              2.048    0.194   10.559    0.000    2.048    0.497</span></span>
<span><span class="co">#&gt;    .RS12              2.277    0.206   11.059    0.000    2.277    0.669</span></span>
<span><span class="co">#&gt;    .RS13              2.172    0.203   10.712    0.000    2.172    0.540</span></span>
<span><span class="co">#&gt;    .RS14              1.020    0.106    9.659    0.000    1.020    0.340</span></span>
<span><span class="co">#&gt;     RS                0.918    0.191    4.804    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.314</span></span>
<span><span class="co">#&gt;     RS2               0.369</span></span>
<span><span class="co">#&gt;     RS3               0.339</span></span>
<span><span class="co">#&gt;     RS4               0.404</span></span>
<span><span class="co">#&gt;     RS5               0.388</span></span>
<span><span class="co">#&gt;     RS6               0.538</span></span>
<span><span class="co">#&gt;     RS7               0.583</span></span>
<span><span class="co">#&gt;     RS8               0.389</span></span>
<span><span class="co">#&gt;     RS9               0.466</span></span>
<span><span class="co">#&gt;     RS10              0.446</span></span>
<span><span class="co">#&gt;     RS11              0.503</span></span>
<span><span class="co">#&gt;     RS12              0.331</span></span>
<span><span class="co">#&gt;     RS13              0.460</span></span>
<span><span class="co">#&gt;     RS14              0.660</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-the-fit-to-table">Add the fit to table<a class="anchor" aria-label="anchor" href="#add-the-fit-to-table"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_fit</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Men Model"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">men.fit</span>, </span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"cfi"</span>,</span>
<span>                                                   <span class="st">"rmsea"</span>, <span class="st">"srmr"</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table_fit</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Women Model"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">women.fit</span>, </span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"cfi"</span>,</span>
<span>                                                   <span class="st">"rmsea"</span>, <span class="st">"srmr"</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">table_fit</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Model</th>
<th align="left">X2</th>
<th align="left">df</th>
<th align="left">CFI</th>
<th align="left">RMSEA</th>
<th align="left">SRMR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Overall Model</td>
<td align="left">368.984</td>
<td align="left">77</td>
<td align="left">0.927</td>
<td align="left">0.086</td>
<td align="left">0.041</td>
</tr>
<tr class="even">
<td align="left">Men Model</td>
<td align="left">271.457</td>
<td align="left">77</td>
<td align="left">0.92</td>
<td align="left">0.102</td>
<td align="left">0.041</td>
</tr>
<tr class="odd">
<td align="left">Women Model</td>
<td align="left">258.61</td>
<td align="left">77</td>
<td align="left">0.895</td>
<td align="left">0.094</td>
<td align="left">0.052</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="configural-invariance">Configural Invariance<a class="anchor" aria-label="anchor" href="#configural-invariance"></a>
</h2>
<ul>
<li>Both groups “pancaked” together</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">configural.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">res.data</span>,</span>
<span>                      meanstructure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      group <span class="op">=</span> <span class="st">"Sex"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">configural.fit</span>,</span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        fit.measure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 49 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        84</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations per group:                   </span></span>
<span><span class="co">#&gt;     Women                                          266</span></span>
<span><span class="co">#&gt;     Men                                            244</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               530.067</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               154</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt;   Test statistic for each group:</span></span>
<span><span class="co">#&gt;     Women                                      258.610</span></span>
<span><span class="co">#&gt;     Men                                        271.457</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              4328.931</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               182</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.909</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.893</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)             -12982.411</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)     -12717.377</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                               26132.822</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                             26488.512</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      26221.885</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.098</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.089</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.107</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.999</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.047</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 1 [Women]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               0.958    0.560</span></span>
<span><span class="co">#&gt;     RS2               1.291    0.163    7.908    0.000    1.237    0.607</span></span>
<span><span class="co">#&gt;     RS3               1.140    0.149    7.675    0.000    1.093    0.582</span></span>
<span><span class="co">#&gt;     RS4               1.401    0.172    8.157    0.000    1.342    0.636</span></span>
<span><span class="co">#&gt;     RS5               1.381    0.172    8.046    0.000    1.323    0.623</span></span>
<span><span class="co">#&gt;     RS6               1.381    0.155    8.933    0.000    1.323    0.733</span></span>
<span><span class="co">#&gt;     RS7               1.485    0.162    9.150    0.000    1.423    0.764</span></span>
<span><span class="co">#&gt;     RS8               1.259    0.156    8.055    0.000    1.206    0.624</span></span>
<span><span class="co">#&gt;     RS9               1.400    0.164    8.543    0.000    1.341    0.682</span></span>
<span><span class="co">#&gt;     RS10              1.333    0.158    8.426    0.000    1.278    0.668</span></span>
<span><span class="co">#&gt;     RS11              1.503    0.172    8.754    0.000    1.440    0.709</span></span>
<span><span class="co">#&gt;     RS12              1.106    0.145    7.609    0.000    1.060    0.575</span></span>
<span><span class="co">#&gt;     RS13              1.421    0.167    8.513    0.000    1.362    0.679</span></span>
<span><span class="co">#&gt;     RS14              1.470    0.155    9.476    0.000    1.408    0.813</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               4.989    0.105   47.546    0.000    4.989    2.915</span></span>
<span><span class="co">#&gt;    .RS2               4.237    0.125   33.918    0.000    4.237    2.080</span></span>
<span><span class="co">#&gt;    .RS3               4.090    0.115   35.528    0.000    4.090    2.178</span></span>
<span><span class="co">#&gt;    .RS4               4.301    0.129   33.220    0.000    4.301    2.037</span></span>
<span><span class="co">#&gt;    .RS5               3.658    0.130   28.090    0.000    3.658    1.722</span></span>
<span><span class="co">#&gt;    .RS6               5.173    0.111   46.757    0.000    5.173    2.867</span></span>
<span><span class="co">#&gt;    .RS7               5.045    0.114   44.162    0.000    5.045    2.708</span></span>
<span><span class="co">#&gt;    .RS8               4.286    0.119   36.153    0.000    4.286    2.217</span></span>
<span><span class="co">#&gt;    .RS9               4.173    0.121   34.619    0.000    4.173    2.123</span></span>
<span><span class="co">#&gt;    .RS10              4.699    0.117   40.054    0.000    4.699    2.456</span></span>
<span><span class="co">#&gt;    .RS11              4.504    0.124   36.179    0.000    4.504    2.218</span></span>
<span><span class="co">#&gt;    .RS12              5.177    0.113   45.781    0.000    5.177    2.807</span></span>
<span><span class="co">#&gt;    .RS13              4.981    0.123   40.489    0.000    4.981    2.483</span></span>
<span><span class="co">#&gt;    .RS14              4.797    0.106   45.141    0.000    4.797    2.768</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               2.010    0.181   11.094    0.000    2.010    0.686</span></span>
<span><span class="co">#&gt;    .RS2               2.620    0.239   10.972    0.000    2.620    0.631</span></span>
<span><span class="co">#&gt;    .RS3               2.332    0.211   11.041    0.000    2.332    0.661</span></span>
<span><span class="co">#&gt;    .RS4               2.657    0.244   10.881    0.000    2.657    0.596</span></span>
<span><span class="co">#&gt;    .RS5               2.760    0.253   10.924    0.000    2.760    0.612</span></span>
<span><span class="co">#&gt;    .RS6               1.505    0.145   10.414    0.000    1.505    0.462</span></span>
<span><span class="co">#&gt;    .RS7               1.447    0.142   10.186    0.000    1.447    0.417</span></span>
<span><span class="co">#&gt;    .RS8               2.283    0.209   10.921    0.000    2.283    0.611</span></span>
<span><span class="co">#&gt;    .RS9               2.066    0.193   10.696    0.000    2.066    0.534</span></span>
<span><span class="co">#&gt;    .RS10              2.028    0.189   10.759    0.000    2.028    0.554</span></span>
<span><span class="co">#&gt;    .RS11              2.048    0.194   10.559    0.000    2.048    0.497</span></span>
<span><span class="co">#&gt;    .RS12              2.277    0.206   11.059    0.000    2.277    0.669</span></span>
<span><span class="co">#&gt;    .RS13              2.172    0.203   10.712    0.000    2.172    0.540</span></span>
<span><span class="co">#&gt;    .RS14              1.020    0.106    9.659    0.000    1.020    0.340</span></span>
<span><span class="co">#&gt;     RS                0.918    0.191    4.804    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.314</span></span>
<span><span class="co">#&gt;     RS2               0.369</span></span>
<span><span class="co">#&gt;     RS3               0.339</span></span>
<span><span class="co">#&gt;     RS4               0.404</span></span>
<span><span class="co">#&gt;     RS5               0.388</span></span>
<span><span class="co">#&gt;     RS6               0.538</span></span>
<span><span class="co">#&gt;     RS7               0.583</span></span>
<span><span class="co">#&gt;     RS8               0.389</span></span>
<span><span class="co">#&gt;     RS9               0.466</span></span>
<span><span class="co">#&gt;     RS10              0.446</span></span>
<span><span class="co">#&gt;     RS11              0.503</span></span>
<span><span class="co">#&gt;     RS12              0.331</span></span>
<span><span class="co">#&gt;     RS13              0.460</span></span>
<span><span class="co">#&gt;     RS14              0.660</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 2 [Men]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.293    0.701</span></span>
<span><span class="co">#&gt;     RS2               1.190    0.105   11.360    0.000    1.538    0.755</span></span>
<span><span class="co">#&gt;     RS3               1.015    0.097   10.467    0.000    1.313    0.694</span></span>
<span><span class="co">#&gt;     RS4               1.131    0.108   10.498    0.000    1.462    0.696</span></span>
<span><span class="co">#&gt;     RS5               1.098    0.108   10.168    0.000    1.420    0.674</span></span>
<span><span class="co">#&gt;     RS6               1.122    0.101   11.093    0.000    1.451    0.737</span></span>
<span><span class="co">#&gt;     RS7               1.125    0.100   11.204    0.000    1.455    0.745</span></span>
<span><span class="co">#&gt;     RS8               1.188    0.101   11.799    0.000    1.536    0.785</span></span>
<span><span class="co">#&gt;     RS9               1.200    0.098   12.228    0.000    1.552    0.815</span></span>
<span><span class="co">#&gt;     RS10              1.103    0.097   11.354    0.000    1.426    0.755</span></span>
<span><span class="co">#&gt;     RS11              1.185    0.101   11.757    0.000    1.533    0.782</span></span>
<span><span class="co">#&gt;     RS12              1.213    0.102   11.877    0.000    1.568    0.791</span></span>
<span><span class="co">#&gt;     RS13              1.331    0.107   12.497    0.000    1.722    0.833</span></span>
<span><span class="co">#&gt;     RS14              1.267    0.101   12.546    0.000    1.639    0.837</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               4.697    0.118   39.741    0.000    4.697    2.544</span></span>
<span><span class="co">#&gt;    .RS2               4.197    0.130   32.180    0.000    4.197    2.060</span></span>
<span><span class="co">#&gt;    .RS3               4.242    0.121   35.035    0.000    4.242    2.243</span></span>
<span><span class="co">#&gt;    .RS4               4.615    0.134   34.330    0.000    4.615    2.198</span></span>
<span><span class="co">#&gt;    .RS5               3.971    0.135   29.448    0.000    3.971    1.885</span></span>
<span><span class="co">#&gt;    .RS6               4.889    0.126   38.788    0.000    4.889    2.483</span></span>
<span><span class="co">#&gt;    .RS7               4.820    0.125   38.520    0.000    4.820    2.466</span></span>
<span><span class="co">#&gt;    .RS8               4.422    0.125   35.315    0.000    4.422    2.261</span></span>
<span><span class="co">#&gt;    .RS9               4.299    0.122   35.259    0.000    4.299    2.257</span></span>
<span><span class="co">#&gt;    .RS10              4.537    0.121   37.516    0.000    4.537    2.402</span></span>
<span><span class="co">#&gt;    .RS11              4.467    0.125   35.614    0.000    4.467    2.280</span></span>
<span><span class="co">#&gt;    .RS12              4.820    0.127   37.954    0.000    4.820    2.430</span></span>
<span><span class="co">#&gt;    .RS13              4.799    0.132   36.291    0.000    4.799    2.323</span></span>
<span><span class="co">#&gt;    .RS14              4.697    0.125   37.467    0.000    4.697    2.399</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               1.736    0.165   10.517    0.000    1.736    0.509</span></span>
<span><span class="co">#&gt;    .RS2               1.783    0.173   10.317    0.000    1.783    0.430</span></span>
<span><span class="co">#&gt;    .RS3               1.852    0.176   10.535    0.000    1.852    0.518</span></span>
<span><span class="co">#&gt;    .RS4               2.270    0.216   10.529    0.000    2.270    0.515</span></span>
<span><span class="co">#&gt;    .RS5               2.421    0.229   10.589    0.000    2.421    0.546</span></span>
<span><span class="co">#&gt;    .RS6               1.771    0.170   10.393    0.000    1.771    0.457</span></span>
<span><span class="co">#&gt;    .RS7               1.702    0.164   10.363    0.000    1.702    0.446</span></span>
<span><span class="co">#&gt;    .RS8               1.466    0.144   10.162    0.000    1.466    0.383</span></span>
<span><span class="co">#&gt;    .RS9               1.219    0.122    9.960    0.000    1.219    0.336</span></span>
<span><span class="co">#&gt;    .RS10              1.535    0.149   10.319    0.000    1.535    0.430</span></span>
<span><span class="co">#&gt;    .RS11              1.489    0.146   10.179    0.000    1.489    0.388</span></span>
<span><span class="co">#&gt;    .RS12              1.475    0.146   10.130    0.000    1.475    0.375</span></span>
<span><span class="co">#&gt;    .RS13              1.303    0.133    9.795    0.000    1.303    0.305</span></span>
<span><span class="co">#&gt;    .RS14              1.149    0.118    9.762    0.000    1.149    0.300</span></span>
<span><span class="co">#&gt;     RS                1.672    0.270    6.188    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.491</span></span>
<span><span class="co">#&gt;     RS2               0.570</span></span>
<span><span class="co">#&gt;     RS3               0.482</span></span>
<span><span class="co">#&gt;     RS4               0.485</span></span>
<span><span class="co">#&gt;     RS5               0.454</span></span>
<span><span class="co">#&gt;     RS6               0.543</span></span>
<span><span class="co">#&gt;     RS7               0.554</span></span>
<span><span class="co">#&gt;     RS8               0.617</span></span>
<span><span class="co">#&gt;     RS9               0.664</span></span>
<span><span class="co">#&gt;     RS10              0.570</span></span>
<span><span class="co">#&gt;     RS11              0.612</span></span>
<span><span class="co">#&gt;     RS12              0.625</span></span>
<span><span class="co">#&gt;     RS13              0.695</span></span>
<span><span class="co">#&gt;     RS14              0.700</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-the-fit-to-table-1">Add the fit to table<a class="anchor" aria-label="anchor" href="#add-the-fit-to-table-1"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_fit</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Configural Model"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">configural.fit</span>, </span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"cfi"</span>,</span>
<span>                                                   <span class="st">"rmsea"</span>, <span class="st">"srmr"</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">table_fit</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Model</th>
<th align="left">X2</th>
<th align="left">df</th>
<th align="left">CFI</th>
<th align="left">RMSEA</th>
<th align="left">SRMR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Overall Model</td>
<td align="left">368.984</td>
<td align="left">77</td>
<td align="left">0.927</td>
<td align="left">0.086</td>
<td align="left">0.041</td>
</tr>
<tr class="even">
<td align="left">Men Model</td>
<td align="left">271.457</td>
<td align="left">77</td>
<td align="left">0.92</td>
<td align="left">0.102</td>
<td align="left">0.041</td>
</tr>
<tr class="odd">
<td align="left">Women Model</td>
<td align="left">258.61</td>
<td align="left">77</td>
<td align="left">0.895</td>
<td align="left">0.094</td>
<td align="left">0.052</td>
</tr>
<tr class="even">
<td align="left">Configural Model</td>
<td align="left">530.067</td>
<td align="left">154</td>
<td align="left">0.909</td>
<td align="left">0.098</td>
<td align="left">0.047</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="metric-invariance-1">Metric Invariance<a class="anchor" aria-label="anchor" href="#metric-invariance-1"></a>
</h2>
<ul>
<li>Are the factor loadings the same?</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metric.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">res.data</span>,</span>
<span>                  meanstructure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  group <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>                  group.equal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loadings"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">metric.fit</span>,</span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        fit.measure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 36 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        84</span></span>
<span><span class="co">#&gt;   Number of equality constraints                    13</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations per group:                   </span></span>
<span><span class="co">#&gt;     Women                                          266</span></span>
<span><span class="co">#&gt;     Men                                            244</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               545.518</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               167</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt;   Test statistic for each group:</span></span>
<span><span class="co">#&gt;     Women                                      268.133</span></span>
<span><span class="co">#&gt;     Men                                        277.385</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              4328.931</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               182</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.909</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.901</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)             -12990.137</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)     -12717.377</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                               26122.273</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                             26422.916</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      26197.552</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.094</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.086</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.103</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.996</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.057</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 1 [Women]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.047    0.595</span></span>
<span><span class="co">#&gt;     RS2     (.p2.)    1.232    0.089   13.828    0.000    1.290    0.624</span></span>
<span><span class="co">#&gt;     RS3     (.p3.)    1.063    0.082   12.984    0.000    1.113    0.589</span></span>
<span><span class="co">#&gt;     RS4     (.p4.)    1.229    0.092   13.338    0.000    1.287    0.619</span></span>
<span><span class="co">#&gt;     RS5     (.p5.)    1.202    0.092   13.025    0.000    1.258    0.603</span></span>
<span><span class="co">#&gt;     RS6     (.p6.)    1.221    0.085   14.407    0.000    1.279    0.720</span></span>
<span><span class="co">#&gt;     RS7     (.p7.)    1.269    0.086   14.698    0.000    1.328    0.738</span></span>
<span><span class="co">#&gt;     RS8     (.p8.)    1.219    0.086   14.256    0.000    1.277    0.646</span></span>
<span><span class="co">#&gt;     RS9     (.p9.)    1.270    0.085   14.871    0.000    1.330    0.679</span></span>
<span><span class="co">#&gt;     RS10    (.10.)    1.184    0.084   14.133    0.000    1.240    0.656</span></span>
<span><span class="co">#&gt;     RS11    (.11.)    1.296    0.088   14.662    0.000    1.357    0.686</span></span>
<span><span class="co">#&gt;     RS12    (.12.)    1.187    0.084   14.058    0.000    1.243    0.636</span></span>
<span><span class="co">#&gt;     RS13    (.13.)    1.370    0.091   15.075    0.000    1.434    0.698</span></span>
<span><span class="co">#&gt;     RS14    (.14.)    1.340    0.085   15.774    0.000    1.403    0.811</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               4.989    0.108   46.212    0.000    4.989    2.833</span></span>
<span><span class="co">#&gt;    .RS2               4.237    0.127   33.447    0.000    4.237    2.051</span></span>
<span><span class="co">#&gt;    .RS3               4.090    0.116   35.332    0.000    4.090    2.166</span></span>
<span><span class="co">#&gt;    .RS4               4.301    0.128   33.724    0.000    4.301    2.068</span></span>
<span><span class="co">#&gt;    .RS5               3.658    0.128   28.593    0.000    3.658    1.753</span></span>
<span><span class="co">#&gt;    .RS6               5.173    0.109   47.491    0.000    5.173    2.912</span></span>
<span><span class="co">#&gt;    .RS7               5.045    0.110   45.709    0.000    5.045    2.803</span></span>
<span><span class="co">#&gt;    .RS8               4.286    0.121   35.351    0.000    4.286    2.167</span></span>
<span><span class="co">#&gt;    .RS9               4.173    0.120   34.740    0.000    4.173    2.130</span></span>
<span><span class="co">#&gt;    .RS10              4.699    0.116   40.534    0.000    4.699    2.485</span></span>
<span><span class="co">#&gt;    .RS11              4.504    0.121   37.122    0.000    4.504    2.276</span></span>
<span><span class="co">#&gt;    .RS12              5.177    0.120   43.174    0.000    5.177    2.647</span></span>
<span><span class="co">#&gt;    .RS13              4.981    0.126   39.540    0.000    4.981    2.424</span></span>
<span><span class="co">#&gt;    .RS14              4.797    0.106   45.258    0.000    4.797    2.775</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               2.004    0.182   11.028    0.000    2.004    0.646</span></span>
<span><span class="co">#&gt;    .RS2               2.605    0.238   10.946    0.000    2.605    0.610</span></span>
<span><span class="co">#&gt;    .RS3               2.327    0.211   11.043    0.000    2.327    0.653</span></span>
<span><span class="co">#&gt;    .RS4               2.670    0.244   10.961    0.000    2.670    0.617</span></span>
<span><span class="co">#&gt;    .RS5               2.771    0.252   11.006    0.000    2.771    0.636</span></span>
<span><span class="co">#&gt;    .RS6               1.520    0.144   10.533    0.000    1.520    0.482</span></span>
<span><span class="co">#&gt;    .RS7               1.476    0.142   10.422    0.000    1.476    0.455</span></span>
<span><span class="co">#&gt;    .RS8               2.279    0.210   10.876    0.000    2.279    0.583</span></span>
<span><span class="co">#&gt;    .RS9               2.070    0.193   10.749    0.000    2.070    0.539</span></span>
<span><span class="co">#&gt;    .RS10              2.037    0.188   10.838    0.000    2.037    0.570</span></span>
<span><span class="co">#&gt;    .RS11              2.073    0.194   10.715    0.000    2.073    0.530</span></span>
<span><span class="co">#&gt;    .RS12              2.279    0.209   10.910    0.000    2.279    0.596</span></span>
<span><span class="co">#&gt;    .RS13              2.165    0.203   10.660    0.000    2.165    0.513</span></span>
<span><span class="co">#&gt;    .RS14              1.021    0.105    9.740    0.000    1.021    0.342</span></span>
<span><span class="co">#&gt;     RS                1.096    0.156    7.018    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.354</span></span>
<span><span class="co">#&gt;     RS2               0.390</span></span>
<span><span class="co">#&gt;     RS3               0.347</span></span>
<span><span class="co">#&gt;     RS4               0.383</span></span>
<span><span class="co">#&gt;     RS5               0.364</span></span>
<span><span class="co">#&gt;     RS6               0.518</span></span>
<span><span class="co">#&gt;     RS7               0.545</span></span>
<span><span class="co">#&gt;     RS8               0.417</span></span>
<span><span class="co">#&gt;     RS9               0.461</span></span>
<span><span class="co">#&gt;     RS10              0.430</span></span>
<span><span class="co">#&gt;     RS11              0.470</span></span>
<span><span class="co">#&gt;     RS12              0.404</span></span>
<span><span class="co">#&gt;     RS13              0.487</span></span>
<span><span class="co">#&gt;     RS14              0.658</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 2 [Men]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.225    0.680</span></span>
<span><span class="co">#&gt;     RS2     (.p2.)    1.232    0.089   13.828    0.000    1.510    0.749</span></span>
<span><span class="co">#&gt;     RS3     (.p3.)    1.063    0.082   12.984    0.000    1.302    0.692</span></span>
<span><span class="co">#&gt;     RS4     (.p4.)    1.229    0.092   13.338    0.000    1.506    0.707</span></span>
<span><span class="co">#&gt;     RS5     (.p5.)    1.202    0.092   13.025    0.000    1.472    0.687</span></span>
<span><span class="co">#&gt;     RS6     (.p6.)    1.221    0.085   14.407    0.000    1.497    0.748</span></span>
<span><span class="co">#&gt;     RS7     (.p7.)    1.269    0.086   14.698    0.000    1.555    0.767</span></span>
<span><span class="co">#&gt;     RS8     (.p8.)    1.219    0.086   14.256    0.000    1.494    0.776</span></span>
<span><span class="co">#&gt;     RS9     (.p9.)    1.270    0.085   14.871    0.000    1.556    0.815</span></span>
<span><span class="co">#&gt;     RS10    (.10.)    1.184    0.084   14.133    0.000    1.451    0.761</span></span>
<span><span class="co">#&gt;     RS11    (.11.)    1.296    0.088   14.662    0.000    1.588    0.794</span></span>
<span><span class="co">#&gt;     RS12    (.12.)    1.187    0.084   14.058    0.000    1.455    0.764</span></span>
<span><span class="co">#&gt;     RS13    (.13.)    1.370    0.091   15.075    0.000    1.678    0.825</span></span>
<span><span class="co">#&gt;     RS14    (.14.)    1.340    0.085   15.774    0.000    1.642    0.836</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               4.697    0.115   40.725    0.000    4.697    2.607</span></span>
<span><span class="co">#&gt;    .RS2               4.197    0.129   32.526    0.000    4.197    2.082</span></span>
<span><span class="co">#&gt;    .RS3               4.242    0.121   35.202    0.000    4.242    2.254</span></span>
<span><span class="co">#&gt;    .RS4               4.615    0.136   33.863    0.000    4.615    2.168</span></span>
<span><span class="co">#&gt;    .RS5               3.971    0.137   28.963    0.000    3.971    1.854</span></span>
<span><span class="co">#&gt;    .RS6               4.889    0.128   38.172    0.000    4.889    2.444</span></span>
<span><span class="co">#&gt;    .RS7               4.820    0.130   37.142    0.000    4.820    2.378</span></span>
<span><span class="co">#&gt;    .RS8               4.422    0.123   35.886    0.000    4.422    2.297</span></span>
<span><span class="co">#&gt;    .RS9               4.299    0.122   35.175    0.000    4.299    2.252</span></span>
<span><span class="co">#&gt;    .RS10              4.537    0.122   37.150    0.000    4.537    2.378</span></span>
<span><span class="co">#&gt;    .RS11              4.467    0.128   34.892    0.000    4.467    2.234</span></span>
<span><span class="co">#&gt;    .RS12              4.820    0.122   39.522    0.000    4.820    2.530</span></span>
<span><span class="co">#&gt;    .RS13              4.799    0.130   36.857    0.000    4.799    2.360</span></span>
<span><span class="co">#&gt;    .RS14              4.697    0.126   37.373    0.000    4.697    2.393</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               1.744    0.165   10.580    0.000    1.744    0.537</span></span>
<span><span class="co">#&gt;    .RS2               1.783    0.172   10.353    0.000    1.783    0.439</span></span>
<span><span class="co">#&gt;    .RS3               1.847    0.175   10.549    0.000    1.847    0.521</span></span>
<span><span class="co">#&gt;    .RS4               2.263    0.215   10.504    0.000    2.263    0.499</span></span>
<span><span class="co">#&gt;    .RS5               2.420    0.229   10.561    0.000    2.420    0.527</span></span>
<span><span class="co">#&gt;    .RS6               1.763    0.170   10.360    0.000    1.763    0.440</span></span>
<span><span class="co">#&gt;    .RS7               1.691    0.165   10.275    0.000    1.691    0.412</span></span>
<span><span class="co">#&gt;    .RS8               1.472    0.144   10.222    0.000    1.472    0.397</span></span>
<span><span class="co">#&gt;    .RS9               1.223    0.123    9.969    0.000    1.223    0.336</span></span>
<span><span class="co">#&gt;    .RS10              1.532    0.149   10.301    0.000    1.532    0.421</span></span>
<span><span class="co">#&gt;    .RS11              1.476    0.146   10.119    0.000    1.476    0.369</span></span>
<span><span class="co">#&gt;    .RS12              1.512    0.147   10.286    0.000    1.512    0.417</span></span>
<span><span class="co">#&gt;    .RS13              1.320    0.134    9.886    0.000    1.320    0.319</span></span>
<span><span class="co">#&gt;    .RS14              1.158    0.118    9.788    0.000    1.158    0.301</span></span>
<span><span class="co">#&gt;     RS                1.502    0.215    6.973    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.463</span></span>
<span><span class="co">#&gt;     RS2               0.561</span></span>
<span><span class="co">#&gt;     RS3               0.479</span></span>
<span><span class="co">#&gt;     RS4               0.501</span></span>
<span><span class="co">#&gt;     RS5               0.473</span></span>
<span><span class="co">#&gt;     RS6               0.560</span></span>
<span><span class="co">#&gt;     RS7               0.588</span></span>
<span><span class="co">#&gt;     RS8               0.603</span></span>
<span><span class="co">#&gt;     RS9               0.664</span></span>
<span><span class="co">#&gt;     RS10              0.579</span></span>
<span><span class="co">#&gt;     RS11              0.631</span></span>
<span><span class="co">#&gt;     RS12              0.583</span></span>
<span><span class="co">#&gt;     RS13              0.681</span></span>
<span><span class="co">#&gt;     RS14              0.699</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-the-fit-to-table-2">Add the fit to table<a class="anchor" aria-label="anchor" href="#add-the-fit-to-table-2"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_fit</span><span class="op">[</span><span class="fl">5</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metric Model"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">metric.fit</span>, </span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"cfi"</span>,</span>
<span>                                                   <span class="st">"rmsea"</span>, <span class="st">"srmr"</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">table_fit</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Model</th>
<th align="left">X2</th>
<th align="left">df</th>
<th align="left">CFI</th>
<th align="left">RMSEA</th>
<th align="left">SRMR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Overall Model</td>
<td align="left">368.984</td>
<td align="left">77</td>
<td align="left">0.927</td>
<td align="left">0.086</td>
<td align="left">0.041</td>
</tr>
<tr class="even">
<td align="left">Men Model</td>
<td align="left">271.457</td>
<td align="left">77</td>
<td align="left">0.92</td>
<td align="left">0.102</td>
<td align="left">0.041</td>
</tr>
<tr class="odd">
<td align="left">Women Model</td>
<td align="left">258.61</td>
<td align="left">77</td>
<td align="left">0.895</td>
<td align="left">0.094</td>
<td align="left">0.052</td>
</tr>
<tr class="even">
<td align="left">Configural Model</td>
<td align="left">530.067</td>
<td align="left">154</td>
<td align="left">0.909</td>
<td align="left">0.098</td>
<td align="left">0.047</td>
</tr>
<tr class="odd">
<td align="left">Metric Model</td>
<td align="left">545.518</td>
<td align="left">167</td>
<td align="left">0.909</td>
<td align="left">0.094</td>
<td align="left">0.057</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="scalar-invariance-1">Scalar Invariance<a class="anchor" aria-label="anchor" href="#scalar-invariance-1"></a>
</h2>
<ul>
<li>Are the item intercepts the same?</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scalar.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">res.data</span>,</span>
<span>                  meanstructure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  group <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>                  group.equal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loadings"</span>, <span class="st">"intercepts"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">scalar.fit</span>,</span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        fit.measure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 47 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        85</span></span>
<span><span class="co">#&gt;   Number of equality constraints                    27</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations per group:                   </span></span>
<span><span class="co">#&gt;     Women                                          266</span></span>
<span><span class="co">#&gt;     Men                                            244</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               585.327</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               180</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt;   Test statistic for each group:</span></span>
<span><span class="co">#&gt;     Women                                      289.405</span></span>
<span><span class="co">#&gt;     Men                                        295.921</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              4328.931</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               182</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.902</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.901</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)             -13010.041</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)     -12717.377</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                               26136.082</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                             26381.678</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      26197.577</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.094</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.086</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.103</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.997</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.060</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 1 [Women]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.049    0.594</span></span>
<span><span class="co">#&gt;     RS2     (.p2.)    1.229    0.089   13.815    0.000    1.289    0.624</span></span>
<span><span class="co">#&gt;     RS3     (.p3.)    1.057    0.082   12.939    0.000    1.110    0.587</span></span>
<span><span class="co">#&gt;     RS4     (.p4.)    1.221    0.092   13.252    0.000    1.281    0.614</span></span>
<span><span class="co">#&gt;     RS5     (.p5.)    1.193    0.092   12.939    0.000    1.252    0.598</span></span>
<span><span class="co">#&gt;     RS6     (.p6.)    1.221    0.085   14.382    0.000    1.281    0.719</span></span>
<span><span class="co">#&gt;     RS7     (.p7.)    1.268    0.086   14.682    0.000    1.330    0.738</span></span>
<span><span class="co">#&gt;     RS8     (.p8.)    1.214    0.085   14.216    0.000    1.274    0.644</span></span>
<span><span class="co">#&gt;     RS9     (.p9.)    1.265    0.085   14.833    0.000    1.327    0.677</span></span>
<span><span class="co">#&gt;     RS10    (.10.)    1.183    0.084   14.124    0.000    1.241    0.656</span></span>
<span><span class="co">#&gt;     RS11    (.11.)    1.293    0.088   14.648    0.000    1.357    0.686</span></span>
<span><span class="co">#&gt;     RS12    (.12.)    1.187    0.085   14.028    0.000    1.246    0.634</span></span>
<span><span class="co">#&gt;     RS13    (.13.)    1.368    0.091   15.062    0.000    1.435    0.698</span></span>
<span><span class="co">#&gt;     RS14    (.14.)    1.338    0.085   15.761    0.000    1.403    0.812</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.30.)    4.866    0.090   54.364    0.000    4.866    2.755</span></span>
<span><span class="co">#&gt;    .RS2     (.31.)    4.252    0.104   40.972    0.000    4.252    2.058</span></span>
<span><span class="co">#&gt;    .RS3     (.32.)    4.202    0.094   44.469    0.000    4.202    2.223</span></span>
<span><span class="co">#&gt;    .RS4     (.33.)    4.498    0.107   42.235    0.000    4.498    2.155</span></span>
<span><span class="co">#&gt;    .RS5     (.34.)    3.851    0.106   36.218    0.000    3.851    1.840</span></span>
<span><span class="co">#&gt;    .RS6     (.35.)    5.077    0.098   51.873    0.000    5.077    2.851</span></span>
<span><span class="co">#&gt;    .RS7     (.36.)    4.975    0.100   49.859    0.000    4.975    2.760</span></span>
<span><span class="co">#&gt;    .RS8     (.37.)    4.404    0.100   44.026    0.000    4.404    2.225</span></span>
<span><span class="co">#&gt;    .RS9     (.38.)    4.291    0.100   42.723    0.000    4.291    2.188</span></span>
<span><span class="co">#&gt;    .RS10    (.39.)    4.645    0.098   47.580    0.000    4.645    2.455</span></span>
<span><span class="co">#&gt;    .RS11    (.40.)    4.522    0.103   43.754    0.000    4.522    2.286</span></span>
<span><span class="co">#&gt;    .RS12    (.41.)    5.006    0.099   50.590    0.000    5.006    2.547</span></span>
<span><span class="co">#&gt;    .RS13    (.42.)    4.916    0.107   45.940    0.000    4.916    2.391</span></span>
<span><span class="co">#&gt;    .RS14    (.43.)    4.784    0.099   48.420    0.000    4.784    2.767</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               2.019    0.183   11.027    0.000    2.019    0.647</span></span>
<span><span class="co">#&gt;    .RS2               2.606    0.238   10.944    0.000    2.606    0.611</span></span>
<span><span class="co">#&gt;    .RS3               2.342    0.212   11.046    0.000    2.342    0.655</span></span>
<span><span class="co">#&gt;    .RS4               2.714    0.247   10.972    0.000    2.714    0.623</span></span>
<span><span class="co">#&gt;    .RS5               2.814    0.255   11.016    0.000    2.814    0.642</span></span>
<span><span class="co">#&gt;    .RS6               1.530    0.145   10.531    0.000    1.530    0.482</span></span>
<span><span class="co">#&gt;    .RS7               1.480    0.142   10.416    0.000    1.480    0.455</span></span>
<span><span class="co">#&gt;    .RS8               2.295    0.211   10.880    0.000    2.295    0.586</span></span>
<span><span class="co">#&gt;    .RS9               2.085    0.194   10.754    0.000    2.085    0.542</span></span>
<span><span class="co">#&gt;    .RS10              2.040    0.188   10.834    0.000    2.040    0.570</span></span>
<span><span class="co">#&gt;    .RS11              2.074    0.194   10.712    0.000    2.074    0.530</span></span>
<span><span class="co">#&gt;    .RS12              2.310    0.212   10.913    0.000    2.310    0.598</span></span>
<span><span class="co">#&gt;    .RS13              2.169    0.204   10.656    0.000    2.169    0.513</span></span>
<span><span class="co">#&gt;    .RS14              1.019    0.105    9.727    0.000    1.019    0.341</span></span>
<span><span class="co">#&gt;     RS                1.101    0.157    7.011    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.353</span></span>
<span><span class="co">#&gt;     RS2               0.389</span></span>
<span><span class="co">#&gt;     RS3               0.345</span></span>
<span><span class="co">#&gt;     RS4               0.377</span></span>
<span><span class="co">#&gt;     RS5               0.358</span></span>
<span><span class="co">#&gt;     RS6               0.518</span></span>
<span><span class="co">#&gt;     RS7               0.545</span></span>
<span><span class="co">#&gt;     RS8               0.414</span></span>
<span><span class="co">#&gt;     RS9               0.458</span></span>
<span><span class="co">#&gt;     RS10              0.430</span></span>
<span><span class="co">#&gt;     RS11              0.470</span></span>
<span><span class="co">#&gt;     RS12              0.402</span></span>
<span><span class="co">#&gt;     RS13              0.487</span></span>
<span><span class="co">#&gt;     RS14              0.659</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 2 [Men]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.228    0.680</span></span>
<span><span class="co">#&gt;     RS2     (.p2.)    1.229    0.089   13.815    0.000    1.509    0.749</span></span>
<span><span class="co">#&gt;     RS3     (.p3.)    1.057    0.082   12.939    0.000    1.299    0.690</span></span>
<span><span class="co">#&gt;     RS4     (.p4.)    1.221    0.092   13.252    0.000    1.500    0.703</span></span>
<span><span class="co">#&gt;     RS5     (.p5.)    1.193    0.092   12.939    0.000    1.466    0.683</span></span>
<span><span class="co">#&gt;     RS6     (.p6.)    1.221    0.085   14.382    0.000    1.500    0.747</span></span>
<span><span class="co">#&gt;     RS7     (.p7.)    1.268    0.086   14.682    0.000    1.557    0.767</span></span>
<span><span class="co">#&gt;     RS8     (.p8.)    1.214    0.085   14.216    0.000    1.491    0.775</span></span>
<span><span class="co">#&gt;     RS9     (.p9.)    1.265    0.085   14.833    0.000    1.554    0.814</span></span>
<span><span class="co">#&gt;     RS10    (.10.)    1.183    0.084   14.124    0.000    1.453    0.761</span></span>
<span><span class="co">#&gt;     RS11    (.11.)    1.293    0.088   14.648    0.000    1.588    0.794</span></span>
<span><span class="co">#&gt;     RS12    (.12.)    1.187    0.085   14.028    0.000    1.458    0.763</span></span>
<span><span class="co">#&gt;     RS13    (.13.)    1.368    0.091   15.062    0.000    1.680    0.825</span></span>
<span><span class="co">#&gt;     RS14    (.14.)    1.338    0.085   15.761    0.000    1.643    0.837</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.30.)    4.866    0.090   54.364    0.000    4.866    2.693</span></span>
<span><span class="co">#&gt;    .RS2     (.31.)    4.252    0.104   40.972    0.000    4.252    2.110</span></span>
<span><span class="co">#&gt;    .RS3     (.32.)    4.202    0.094   44.469    0.000    4.202    2.232</span></span>
<span><span class="co">#&gt;    .RS4     (.33.)    4.498    0.107   42.235    0.000    4.498    2.109</span></span>
<span><span class="co">#&gt;    .RS5     (.34.)    3.851    0.106   36.218    0.000    3.851    1.794</span></span>
<span><span class="co">#&gt;    .RS6     (.35.)    5.077    0.098   51.873    0.000    5.077    2.530</span></span>
<span><span class="co">#&gt;    .RS7     (.36.)    4.975    0.100   49.859    0.000    4.975    2.450</span></span>
<span><span class="co">#&gt;    .RS8     (.37.)    4.404    0.100   44.026    0.000    4.404    2.288</span></span>
<span><span class="co">#&gt;    .RS9     (.38.)    4.291    0.100   42.723    0.000    4.291    2.248</span></span>
<span><span class="co">#&gt;    .RS10    (.39.)    4.645    0.098   47.580    0.000    4.645    2.433</span></span>
<span><span class="co">#&gt;    .RS11    (.40.)    4.522    0.103   43.754    0.000    4.522    2.262</span></span>
<span><span class="co">#&gt;    .RS12    (.41.)    5.006    0.099   50.590    0.000    5.006    2.619</span></span>
<span><span class="co">#&gt;    .RS13    (.42.)    4.916    0.107   45.940    0.000    4.916    2.415</span></span>
<span><span class="co">#&gt;    .RS14    (.43.)    4.784    0.099   48.420    0.000    4.784    2.437</span></span>
<span><span class="co">#&gt;     RS               -0.054    0.105   -0.512    0.609   -0.044   -0.044</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1               1.757    0.166   10.579    0.000    1.757    0.538</span></span>
<span><span class="co">#&gt;    .RS2               1.784    0.172   10.350    0.000    1.784    0.439</span></span>
<span><span class="co">#&gt;    .RS3               1.858    0.176   10.552    0.000    1.858    0.524</span></span>
<span><span class="co">#&gt;    .RS4               2.300    0.219   10.514    0.000    2.300    0.506</span></span>
<span><span class="co">#&gt;    .RS5               2.457    0.232   10.571    0.000    2.457    0.533</span></span>
<span><span class="co">#&gt;    .RS6               1.779    0.172   10.361    0.000    1.779    0.442</span></span>
<span><span class="co">#&gt;    .RS7               1.700    0.165   10.273    0.000    1.700    0.412</span></span>
<span><span class="co">#&gt;    .RS8               1.481    0.145   10.226    0.000    1.481    0.400</span></span>
<span><span class="co">#&gt;    .RS9               1.230    0.123    9.973    0.000    1.230    0.338</span></span>
<span><span class="co">#&gt;    .RS10              1.533    0.149   10.296    0.000    1.533    0.421</span></span>
<span><span class="co">#&gt;    .RS11              1.476    0.146   10.114    0.000    1.476    0.369</span></span>
<span><span class="co">#&gt;    .RS12              1.527    0.148   10.286    0.000    1.527    0.418</span></span>
<span><span class="co">#&gt;    .RS13              1.321    0.134    9.878    0.000    1.321    0.319</span></span>
<span><span class="co">#&gt;    .RS14              1.156    0.118    9.778    0.000    1.156    0.300</span></span>
<span><span class="co">#&gt;     RS                1.509    0.217    6.966    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.462</span></span>
<span><span class="co">#&gt;     RS2               0.561</span></span>
<span><span class="co">#&gt;     RS3               0.476</span></span>
<span><span class="co">#&gt;     RS4               0.494</span></span>
<span><span class="co">#&gt;     RS5               0.467</span></span>
<span><span class="co">#&gt;     RS6               0.558</span></span>
<span><span class="co">#&gt;     RS7               0.588</span></span>
<span><span class="co">#&gt;     RS8               0.600</span></span>
<span><span class="co">#&gt;     RS9               0.662</span></span>
<span><span class="co">#&gt;     RS10              0.579</span></span>
<span><span class="co">#&gt;     RS11              0.631</span></span>
<span><span class="co">#&gt;     RS12              0.582</span></span>
<span><span class="co">#&gt;     RS13              0.681</span></span>
<span><span class="co">#&gt;     RS14              0.700</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-the-fit-to-table-3">Add the fit to table<a class="anchor" aria-label="anchor" href="#add-the-fit-to-table-3"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_fit</span><span class="op">[</span><span class="fl">6</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Scalar Model"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">scalar.fit</span>, </span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"cfi"</span>,</span>
<span>                                                   <span class="st">"rmsea"</span>, <span class="st">"srmr"</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">table_fit</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Model</th>
<th align="left">X2</th>
<th align="left">df</th>
<th align="left">CFI</th>
<th align="left">RMSEA</th>
<th align="left">SRMR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Overall Model</td>
<td align="left">368.984</td>
<td align="left">77</td>
<td align="left">0.927</td>
<td align="left">0.086</td>
<td align="left">0.041</td>
</tr>
<tr class="even">
<td align="left">Men Model</td>
<td align="left">271.457</td>
<td align="left">77</td>
<td align="left">0.92</td>
<td align="left">0.102</td>
<td align="left">0.041</td>
</tr>
<tr class="odd">
<td align="left">Women Model</td>
<td align="left">258.61</td>
<td align="left">77</td>
<td align="left">0.895</td>
<td align="left">0.094</td>
<td align="left">0.052</td>
</tr>
<tr class="even">
<td align="left">Configural Model</td>
<td align="left">530.067</td>
<td align="left">154</td>
<td align="left">0.909</td>
<td align="left">0.098</td>
<td align="left">0.047</td>
</tr>
<tr class="odd">
<td align="left">Metric Model</td>
<td align="left">545.518</td>
<td align="left">167</td>
<td align="left">0.909</td>
<td align="left">0.094</td>
<td align="left">0.057</td>
</tr>
<tr class="even">
<td align="left">Scalar Model</td>
<td align="left">585.327</td>
<td align="left">180</td>
<td align="left">0.902</td>
<td align="left">0.094</td>
<td align="left">0.06</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="strict-error-invariance">Strict (Error) Invariance<a class="anchor" aria-label="anchor" href="#strict-error-invariance"></a>
</h2>
<ul>
<li>Are the item residuals the same?</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strict.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">res.data</span>,</span>
<span>                  meanstructure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  group <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>                  group.equal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loadings"</span>, <span class="st">"intercepts"</span>, <span class="st">"residuals"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">strict.fit</span>,</span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        fit.measure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 46 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        85</span></span>
<span><span class="co">#&gt;   Number of equality constraints                    41</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations per group:                   </span></span>
<span><span class="co">#&gt;     Women                                          266</span></span>
<span><span class="co">#&gt;     Men                                            244</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               660.398</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               194</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt;   Test statistic for each group:</span></span>
<span><span class="co">#&gt;     Women                                      314.816</span></span>
<span><span class="co">#&gt;     Men                                        345.582</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              4328.931</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               182</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.888</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.894</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)             -13047.576</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)     -12717.377</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                               26183.153</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                             26369.467</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      26229.805</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.097</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.089</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.105</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 1 [Women]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.052    0.608</span></span>
<span><span class="co">#&gt;     RS2     (.p2.)    1.229    0.091   13.545    0.000    1.292    0.657</span></span>
<span><span class="co">#&gt;     RS3     (.p3.)    1.064    0.083   12.817    0.000    1.119    0.612</span></span>
<span><span class="co">#&gt;     RS4     (.p4.)    1.229    0.093   13.156    0.000    1.293    0.632</span></span>
<span><span class="co">#&gt;     RS5     (.p5.)    1.201    0.093   12.851    0.000    1.262    0.614</span></span>
<span><span class="co">#&gt;     RS6     (.p6.)    1.217    0.085   14.274    0.000    1.280    0.705</span></span>
<span><span class="co">#&gt;     RS7     (.p7.)    1.262    0.087   14.567    0.000    1.327    0.725</span></span>
<span><span class="co">#&gt;     RS8     (.p8.)    1.206    0.087   13.852    0.000    1.269    0.677</span></span>
<span><span class="co">#&gt;     RS9     (.p9.)    1.270    0.088   14.473    0.000    1.335    0.718</span></span>
<span><span class="co">#&gt;     RS10    (.10.)    1.192    0.085   13.957    0.000    1.253    0.684</span></span>
<span><span class="co">#&gt;     RS11    (.11.)    1.315    0.090   14.535    0.000    1.383    0.722</span></span>
<span><span class="co">#&gt;     RS12    (.12.)    1.156    0.085   13.524    0.000    1.216    0.656</span></span>
<span><span class="co">#&gt;     RS13    (.13.)    1.356    0.093   14.656    0.000    1.426    0.731</span></span>
<span><span class="co">#&gt;     RS14    (.14.)    1.334    0.085   15.610    0.000    1.402    0.800</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.30.)    4.874    0.090   54.448    0.000    4.874    2.817</span></span>
<span><span class="co">#&gt;    .RS2     (.31.)    4.249    0.104   40.833    0.000    4.249    2.160</span></span>
<span><span class="co">#&gt;    .RS3     (.32.)    4.190    0.095   44.193    0.000    4.190    2.291</span></span>
<span><span class="co">#&gt;    .RS4     (.33.)    4.482    0.107   41.915    0.000    4.482    2.193</span></span>
<span><span class="co">#&gt;    .RS5     (.34.)    3.838    0.107   35.963    0.000    3.838    1.866</span></span>
<span><span class="co">#&gt;    .RS6     (.35.)    5.068    0.098   51.613    0.000    5.068    2.791</span></span>
<span><span class="co">#&gt;    .RS7     (.36.)    4.969    0.100   49.707    0.000    4.969    2.713</span></span>
<span><span class="co">#&gt;    .RS8     (.37.)    4.381    0.100   43.790    0.000    4.381    2.337</span></span>
<span><span class="co">#&gt;    .RS9     (.38.)    4.265    0.101   42.167    0.000    4.265    2.295</span></span>
<span><span class="co">#&gt;    .RS10    (.39.)    4.652    0.098   47.397    0.000    4.652    2.538</span></span>
<span><span class="co">#&gt;    .RS11    (.40.)    4.519    0.104   43.296    0.000    4.519    2.361</span></span>
<span><span class="co">#&gt;    .RS12    (.41.)    5.035    0.098   51.359    0.000    5.035    2.715</span></span>
<span><span class="co">#&gt;    .RS13    (.42.)    4.928    0.107   46.139    0.000    4.928    2.526</span></span>
<span><span class="co">#&gt;    .RS14    (.43.)    4.783    0.099   48.219    0.000    4.783    2.728</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.15.)    1.887    0.124   15.241    0.000    1.887    0.631</span></span>
<span><span class="co">#&gt;    .RS2     (.16.)    2.200    0.146   15.025    0.000    2.200    0.568</span></span>
<span><span class="co">#&gt;    .RS3     (.17.)    2.094    0.138   15.226    0.000    2.094    0.626</span></span>
<span><span class="co">#&gt;    .RS4     (.18.)    2.507    0.166   15.141    0.000    2.507    0.600</span></span>
<span><span class="co">#&gt;    .RS5     (.19.)    2.638    0.173   15.218    0.000    2.638    0.623</span></span>
<span><span class="co">#&gt;    .RS6     (.20.)    1.660    0.113   14.742    0.000    1.660    0.503</span></span>
<span><span class="co">#&gt;    .RS7     (.21.)    1.593    0.109   14.593    0.000    1.593    0.475</span></span>
<span><span class="co">#&gt;    .RS8     (.22.)    1.905    0.128   14.918    0.000    1.905    0.542</span></span>
<span><span class="co">#&gt;    .RS9     (.23.)    1.673    0.114   14.643    0.000    1.673    0.484</span></span>
<span><span class="co">#&gt;    .RS10    (.24.)    1.789    0.120   14.878    0.000    1.789    0.533</span></span>
<span><span class="co">#&gt;    .RS11    (.25.)    1.752    0.120   14.610    0.000    1.752    0.478</span></span>
<span><span class="co">#&gt;    .RS12    (.26.)    1.961    0.130   15.032    0.000    1.961    0.570</span></span>
<span><span class="co">#&gt;    .RS13    (.27.)    1.773    0.122   14.542    0.000    1.773    0.466</span></span>
<span><span class="co">#&gt;    .RS14    (.28.)    1.106    0.080   13.754    0.000    1.106    0.360</span></span>
<span><span class="co">#&gt;     RS                1.106    0.158    6.990    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.369</span></span>
<span><span class="co">#&gt;     RS2               0.432</span></span>
<span><span class="co">#&gt;     RS3               0.374</span></span>
<span><span class="co">#&gt;     RS4               0.400</span></span>
<span><span class="co">#&gt;     RS5               0.377</span></span>
<span><span class="co">#&gt;     RS6               0.497</span></span>
<span><span class="co">#&gt;     RS7               0.525</span></span>
<span><span class="co">#&gt;     RS8               0.458</span></span>
<span><span class="co">#&gt;     RS9               0.516</span></span>
<span><span class="co">#&gt;     RS10              0.467</span></span>
<span><span class="co">#&gt;     RS11              0.522</span></span>
<span><span class="co">#&gt;     RS12              0.430</span></span>
<span><span class="co">#&gt;     RS13              0.534</span></span>
<span><span class="co">#&gt;     RS14              0.640</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 2 [Men]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.222    0.665</span></span>
<span><span class="co">#&gt;     RS2     (.p2.)    1.229    0.091   13.545    0.000    1.502    0.711</span></span>
<span><span class="co">#&gt;     RS3     (.p3.)    1.064    0.083   12.817    0.000    1.300    0.668</span></span>
<span><span class="co">#&gt;     RS4     (.p4.)    1.229    0.093   13.156    0.000    1.502    0.688</span></span>
<span><span class="co">#&gt;     RS5     (.p5.)    1.201    0.093   12.851    0.000    1.467    0.670</span></span>
<span><span class="co">#&gt;     RS6     (.p6.)    1.217    0.085   14.274    0.000    1.487    0.756</span></span>
<span><span class="co">#&gt;     RS7     (.p7.)    1.262    0.087   14.567    0.000    1.542    0.774</span></span>
<span><span class="co">#&gt;     RS8     (.p8.)    1.206    0.087   13.852    0.000    1.474    0.730</span></span>
<span><span class="co">#&gt;     RS9     (.p9.)    1.270    0.088   14.473    0.000    1.552    0.768</span></span>
<span><span class="co">#&gt;     RS10    (.10.)    1.192    0.085   13.957    0.000    1.456    0.736</span></span>
<span><span class="co">#&gt;     RS11    (.11.)    1.315    0.090   14.535    0.000    1.607    0.772</span></span>
<span><span class="co">#&gt;     RS12    (.12.)    1.156    0.085   13.524    0.000    1.413    0.710</span></span>
<span><span class="co">#&gt;     RS13    (.13.)    1.356    0.093   14.656    0.000    1.657    0.780</span></span>
<span><span class="co">#&gt;     RS14    (.14.)    1.334    0.085   15.610    0.000    1.630    0.840</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.30.)    4.874    0.090   54.448    0.000    4.874    2.651</span></span>
<span><span class="co">#&gt;    .RS2     (.31.)    4.249    0.104   40.833    0.000    4.249    2.013</span></span>
<span><span class="co">#&gt;    .RS3     (.32.)    4.190    0.095   44.193    0.000    4.190    2.154</span></span>
<span><span class="co">#&gt;    .RS4     (.33.)    4.482    0.107   41.915    0.000    4.482    2.054</span></span>
<span><span class="co">#&gt;    .RS5     (.34.)    3.838    0.107   35.963    0.000    3.838    1.754</span></span>
<span><span class="co">#&gt;    .RS6     (.35.)    5.068    0.098   51.613    0.000    5.068    2.576</span></span>
<span><span class="co">#&gt;    .RS7     (.36.)    4.969    0.100   49.707    0.000    4.969    2.493</span></span>
<span><span class="co">#&gt;    .RS8     (.37.)    4.381    0.100   43.790    0.000    4.381    2.170</span></span>
<span><span class="co">#&gt;    .RS9     (.38.)    4.265    0.101   42.167    0.000    4.265    2.112</span></span>
<span><span class="co">#&gt;    .RS10    (.39.)    4.652    0.098   47.397    0.000    4.652    2.353</span></span>
<span><span class="co">#&gt;    .RS11    (.40.)    4.519    0.104   43.296    0.000    4.519    2.171</span></span>
<span><span class="co">#&gt;    .RS12    (.41.)    5.035    0.098   51.359    0.000    5.035    2.531</span></span>
<span><span class="co">#&gt;    .RS13    (.42.)    4.928    0.107   46.139    0.000    4.928    2.318</span></span>
<span><span class="co">#&gt;    .RS14    (.43.)    4.783    0.099   48.219    0.000    4.783    2.466</span></span>
<span><span class="co">#&gt;     RS               -0.053    0.105   -0.504    0.614   -0.043   -0.043</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.15.)    1.887    0.124   15.241    0.000    1.887    0.558</span></span>
<span><span class="co">#&gt;    .RS2     (.16.)    2.200    0.146   15.025    0.000    2.200    0.494</span></span>
<span><span class="co">#&gt;    .RS3     (.17.)    2.094    0.138   15.226    0.000    2.094    0.553</span></span>
<span><span class="co">#&gt;    .RS4     (.18.)    2.507    0.166   15.141    0.000    2.507    0.526</span></span>
<span><span class="co">#&gt;    .RS5     (.19.)    2.638    0.173   15.218    0.000    2.638    0.551</span></span>
<span><span class="co">#&gt;    .RS6     (.20.)    1.660    0.113   14.742    0.000    1.660    0.429</span></span>
<span><span class="co">#&gt;    .RS7     (.21.)    1.593    0.109   14.593    0.000    1.593    0.401</span></span>
<span><span class="co">#&gt;    .RS8     (.22.)    1.905    0.128   14.918    0.000    1.905    0.467</span></span>
<span><span class="co">#&gt;    .RS9     (.23.)    1.673    0.114   14.643    0.000    1.673    0.410</span></span>
<span><span class="co">#&gt;    .RS10    (.24.)    1.789    0.120   14.878    0.000    1.789    0.458</span></span>
<span><span class="co">#&gt;    .RS11    (.25.)    1.752    0.120   14.610    0.000    1.752    0.404</span></span>
<span><span class="co">#&gt;    .RS12    (.26.)    1.961    0.130   15.032    0.000    1.961    0.496</span></span>
<span><span class="co">#&gt;    .RS13    (.27.)    1.773    0.122   14.542    0.000    1.773    0.392</span></span>
<span><span class="co">#&gt;    .RS14    (.28.)    1.106    0.080   13.754    0.000    1.106    0.294</span></span>
<span><span class="co">#&gt;     RS                1.493    0.216    6.917    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.442</span></span>
<span><span class="co">#&gt;     RS2               0.506</span></span>
<span><span class="co">#&gt;     RS3               0.447</span></span>
<span><span class="co">#&gt;     RS4               0.474</span></span>
<span><span class="co">#&gt;     RS5               0.449</span></span>
<span><span class="co">#&gt;     RS6               0.571</span></span>
<span><span class="co">#&gt;     RS7               0.599</span></span>
<span><span class="co">#&gt;     RS8               0.533</span></span>
<span><span class="co">#&gt;     RS9               0.590</span></span>
<span><span class="co">#&gt;     RS10              0.542</span></span>
<span><span class="co">#&gt;     RS11              0.596</span></span>
<span><span class="co">#&gt;     RS12              0.504</span></span>
<span><span class="co">#&gt;     RS13              0.608</span></span>
<span><span class="co">#&gt;     RS14              0.706</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-the-fit-to-table-4">Add the fit to table<a class="anchor" aria-label="anchor" href="#add-the-fit-to-table-4"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_fit</span><span class="op">[</span><span class="fl">7</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strict Model"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">strict.fit</span>, </span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"cfi"</span>,</span>
<span>                                                   <span class="st">"rmsea"</span>, <span class="st">"srmr"</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">table_fit</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Model</th>
<th align="left">X2</th>
<th align="left">df</th>
<th align="left">CFI</th>
<th align="left">RMSEA</th>
<th align="left">SRMR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Overall Model</td>
<td align="left">368.984</td>
<td align="left">77</td>
<td align="left">0.927</td>
<td align="left">0.086</td>
<td align="left">0.041</td>
</tr>
<tr class="even">
<td align="left">Men Model</td>
<td align="left">271.457</td>
<td align="left">77</td>
<td align="left">0.92</td>
<td align="left">0.102</td>
<td align="left">0.041</td>
</tr>
<tr class="odd">
<td align="left">Women Model</td>
<td align="left">258.61</td>
<td align="left">77</td>
<td align="left">0.895</td>
<td align="left">0.094</td>
<td align="left">0.052</td>
</tr>
<tr class="even">
<td align="left">Configural Model</td>
<td align="left">530.067</td>
<td align="left">154</td>
<td align="left">0.909</td>
<td align="left">0.098</td>
<td align="left">0.047</td>
</tr>
<tr class="odd">
<td align="left">Metric Model</td>
<td align="left">545.518</td>
<td align="left">167</td>
<td align="left">0.909</td>
<td align="left">0.094</td>
<td align="left">0.057</td>
</tr>
<tr class="even">
<td align="left">Scalar Model</td>
<td align="left">585.327</td>
<td align="left">180</td>
<td align="left">0.902</td>
<td align="left">0.094</td>
<td align="left">0.06</td>
</tr>
<tr class="odd">
<td align="left">Strict Model</td>
<td align="left">660.398</td>
<td align="left">194</td>
<td align="left">0.888</td>
<td align="left">0.097</td>
<td align="left">0.062</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="partial-invariance-1">Partial Invariance<a class="anchor" aria-label="anchor" href="#partial-invariance-1"></a>
</h2>
<ul>
<li>We can see in this last step that we have a difference in models
based on change in CFI.</li>
<li>Now, we have to figure out where the problem is and update our model
to fix that problem.</li>
<li>You would only look for problems <em>in the step you are
in</em>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="partial-invariance-2">Partial Invariance<a class="anchor" aria-label="anchor" href="#partial-invariance-2"></a>
</h2>
<ul>
<li>Figure out which level you need:
<ul>
<li>metric <code>=~</code> for loadings</li>
<li>scalar <code>~1</code> for intercepts</li>
<li>strict <code>~~</code> for variances</li>
</ul>
</li>
<li>Change each item one at a time and note the changes</li>
</ul>
</div>
<div class="section level2">
<h2 id="partial-invariance-3">Partial Invariance<a class="anchor" aria-label="anchor" href="#partial-invariance-3"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##write out partial codes</span></span>
<span><span class="va">partial_syntax</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>, <span class="co">#all the columns</span></span>
<span>                        <span class="st">"~~"</span>, <span class="co">#residuals</span></span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span><span class="op">)</span> <span class="co">#all columns again </span></span>
<span><span class="va">partial_syntax</span></span>
<span><span class="co">#&gt;  [1] "RS1 ~~ RS1"   "RS2 ~~ RS2"   "RS3 ~~ RS3"   "RS4 ~~ RS4"   "RS5 ~~ RS5"  </span></span>
<span><span class="co">#&gt;  [6] "RS6 ~~ RS6"   "RS7 ~~ RS7"   "RS8 ~~ RS8"   "RS9 ~~ RS9"   "RS10 ~~ RS10"</span></span>
<span><span class="co">#&gt; [11] "RS11 ~~ RS11" "RS12 ~~ RS12" "RS13 ~~ RS13" "RS14 ~~ RS14"</span></span>
<span></span>
<span><span class="va">CFI_list</span>  <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">partial_syntax</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">CFI_list</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">partial_syntax</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">partial_syntax</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>, </span>
<span>              data <span class="op">=</span> <span class="va">res.data</span>,</span>
<span>              meanstructure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              group <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>              group.equal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loadings"</span>, <span class="st">"intercepts"</span>, <span class="st">"residuals"</span><span class="op">)</span>,</span>
<span>              group.partial <span class="op">=</span> <span class="va">partial_syntax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">CFI_list</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">temp</span>, <span class="st">"cfi"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">CFI_list</span></span>
<span><span class="co">#&gt;   RS1 ~~ RS1   RS2 ~~ RS2   RS3 ~~ RS3   RS4 ~~ RS4   RS5 ~~ RS5   RS6 ~~ RS6 </span></span>
<span><span class="co">#&gt;    0.8877040    0.8892794    0.8881315    0.8876596    0.8875493    0.8874662 </span></span>
<span><span class="co">#&gt;   RS7 ~~ RS7   RS8 ~~ RS8   RS9 ~~ RS9 RS10 ~~ RS10 RS11 ~~ RS11 RS12 ~~ RS12 </span></span>
<span><span class="co">#&gt;    0.8873667    0.8897416    0.8906278    0.8882753    0.8888421    0.8896339 </span></span>
<span><span class="co">#&gt; RS13 ~~ RS13 RS14 ~~ RS14 </span></span>
<span><span class="co">#&gt;    0.8905766    0.8873834</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">CFI_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; RS9 ~~ RS9 </span></span>
<span><span class="co">#&gt;          9</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="free-up-those-paramers">Free up those paramers!<a class="anchor" aria-label="anchor" href="#free-up-those-paramers"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strict.fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">res.data</span>,</span>
<span>                  meanstructure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  group <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>                  group.equal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loadings"</span>, <span class="st">"intercepts"</span>, <span class="st">"residuals"</span><span class="op">)</span>, </span>
<span>                  group.partial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RS9 ~~ RS9"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">strict.fit2</span>,</span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        fit.measure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 48 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        85</span></span>
<span><span class="co">#&gt;   Number of equality constraints                    40</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations per group:                   </span></span>
<span><span class="co">#&gt;     Women                                          266</span></span>
<span><span class="co">#&gt;     Men                                            244</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               646.559</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               193</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt;   Test statistic for each group:</span></span>
<span><span class="co">#&gt;     Women                                      310.363</span></span>
<span><span class="co">#&gt;     Men                                        336.196</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              4328.931</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               182</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.891</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.897</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)             -13040.657</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)     -12717.377</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                               26171.314</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                             26361.863</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      26219.026</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.096</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.088</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.104</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.999</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 1 [Women]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.050    0.607</span></span>
<span><span class="co">#&gt;     RS2     (.p2.)    1.229    0.091   13.526    0.000    1.290    0.656</span></span>
<span><span class="co">#&gt;     RS3     (.p3.)    1.064    0.083   12.806    0.000    1.117    0.611</span></span>
<span><span class="co">#&gt;     RS4     (.p4.)    1.232    0.094   13.161    0.000    1.293    0.633</span></span>
<span><span class="co">#&gt;     RS5     (.p5.)    1.200    0.094   12.829    0.000    1.260    0.612</span></span>
<span><span class="co">#&gt;     RS6     (.p6.)    1.218    0.085   14.264    0.000    1.279    0.704</span></span>
<span><span class="co">#&gt;     RS7     (.p7.)    1.263    0.087   14.550    0.000    1.325    0.724</span></span>
<span><span class="co">#&gt;     RS8     (.p8.)    1.207    0.087   13.840    0.000    1.267    0.676</span></span>
<span><span class="co">#&gt;     RS9     (.p9.)    1.269    0.086   14.706    0.000    1.332    0.679</span></span>
<span><span class="co">#&gt;     RS10    (.10.)    1.194    0.086   13.965    0.000    1.254    0.684</span></span>
<span><span class="co">#&gt;     RS11    (.11.)    1.313    0.091   14.497    0.000    1.379    0.720</span></span>
<span><span class="co">#&gt;     RS12    (.12.)    1.160    0.086   13.546    0.000    1.218    0.657</span></span>
<span><span class="co">#&gt;     RS13    (.13.)    1.359    0.093   14.659    0.000    1.427    0.732</span></span>
<span><span class="co">#&gt;     RS14    (.14.)    1.334    0.086   15.592    0.000    1.401    0.799</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.30.)    4.874    0.089   54.484    0.000    4.874    2.818</span></span>
<span><span class="co">#&gt;    .RS2     (.31.)    4.249    0.104   40.863    0.000    4.249    2.160</span></span>
<span><span class="co">#&gt;    .RS3     (.32.)    4.190    0.095   44.218    0.000    4.190    2.291</span></span>
<span><span class="co">#&gt;    .RS4     (.33.)    4.482    0.107   41.924    0.000    4.482    2.194</span></span>
<span><span class="co">#&gt;    .RS5     (.34.)    3.838    0.107   35.990    0.000    3.838    1.866</span></span>
<span><span class="co">#&gt;    .RS6     (.35.)    5.068    0.098   51.642    0.000    5.068    2.792</span></span>
<span><span class="co">#&gt;    .RS7     (.36.)    4.969    0.100   49.744    0.000    4.969    2.714</span></span>
<span><span class="co">#&gt;    .RS8     (.37.)    4.381    0.100   43.816    0.000    4.381    2.338</span></span>
<span><span class="co">#&gt;    .RS9     (.38.)    4.290    0.101   42.586    0.000    4.290    2.187</span></span>
<span><span class="co">#&gt;    .RS10    (.39.)    4.652    0.098   47.405    0.000    4.652    2.539</span></span>
<span><span class="co">#&gt;    .RS11    (.40.)    4.519    0.104   43.349    0.000    4.519    2.361</span></span>
<span><span class="co">#&gt;    .RS12    (.41.)    5.035    0.098   51.351    0.000    5.035    2.717</span></span>
<span><span class="co">#&gt;    .RS13    (.42.)    4.928    0.107   46.152    0.000    4.928    2.527</span></span>
<span><span class="co">#&gt;    .RS14    (.43.)    4.783    0.099   48.258    0.000    4.783    2.730</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.15.)    1.889    0.124   15.247    0.000    1.889    0.632</span></span>
<span><span class="co">#&gt;    .RS2     (.16.)    2.203    0.147   15.033    0.000    2.203    0.570</span></span>
<span><span class="co">#&gt;    .RS3     (.17.)    2.095    0.138   15.231    0.000    2.095    0.627</span></span>
<span><span class="co">#&gt;    .RS4     (.18.)    2.502    0.165   15.141    0.000    2.502    0.599</span></span>
<span><span class="co">#&gt;    .RS5     (.19.)    2.643    0.174   15.226    0.000    2.643    0.625</span></span>
<span><span class="co">#&gt;    .RS6     (.20.)    1.660    0.113   14.748    0.000    1.660    0.504</span></span>
<span><span class="co">#&gt;    .RS7     (.21.)    1.595    0.109   14.603    0.000    1.595    0.476</span></span>
<span><span class="co">#&gt;    .RS8     (.22.)    1.905    0.128   14.924    0.000    1.905    0.543</span></span>
<span><span class="co">#&gt;    .RS9               2.072    0.192   10.787    0.000    2.072    0.539</span></span>
<span><span class="co">#&gt;    .RS10    (.24.)    1.783    0.120   14.876    0.000    1.783    0.531</span></span>
<span><span class="co">#&gt;    .RS11    (.25.)    1.762    0.120   14.631    0.000    1.762    0.481</span></span>
<span><span class="co">#&gt;    .RS12    (.26.)    1.951    0.130   15.027    0.000    1.951    0.568</span></span>
<span><span class="co">#&gt;    .RS13    (.27.)    1.768    0.122   14.541    0.000    1.768    0.465</span></span>
<span><span class="co">#&gt;    .RS14    (.28.)    1.108    0.080   13.770    0.000    1.108    0.361</span></span>
<span><span class="co">#&gt;     RS                1.102    0.158    6.983    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.368</span></span>
<span><span class="co">#&gt;     RS2               0.430</span></span>
<span><span class="co">#&gt;     RS3               0.373</span></span>
<span><span class="co">#&gt;     RS4               0.401</span></span>
<span><span class="co">#&gt;     RS5               0.375</span></span>
<span><span class="co">#&gt;     RS6               0.496</span></span>
<span><span class="co">#&gt;     RS7               0.524</span></span>
<span><span class="co">#&gt;     RS8               0.457</span></span>
<span><span class="co">#&gt;     RS9               0.461</span></span>
<span><span class="co">#&gt;     RS10              0.469</span></span>
<span><span class="co">#&gt;     RS11              0.519</span></span>
<span><span class="co">#&gt;     RS12              0.432</span></span>
<span><span class="co">#&gt;     RS13              0.535</span></span>
<span><span class="co">#&gt;     RS14              0.639</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 2 [Men]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.222    0.664</span></span>
<span><span class="co">#&gt;     RS2     (.p2.)    1.229    0.091   13.526    0.000    1.501    0.711</span></span>
<span><span class="co">#&gt;     RS3     (.p3.)    1.064    0.083   12.806    0.000    1.300    0.668</span></span>
<span><span class="co">#&gt;     RS4     (.p4.)    1.232    0.094   13.161    0.000    1.505    0.689</span></span>
<span><span class="co">#&gt;     RS5     (.p5.)    1.200    0.094   12.829    0.000    1.466    0.670</span></span>
<span><span class="co">#&gt;     RS6     (.p6.)    1.218    0.085   14.264    0.000    1.488    0.756</span></span>
<span><span class="co">#&gt;     RS7     (.p7.)    1.263    0.087   14.550    0.000    1.543    0.774</span></span>
<span><span class="co">#&gt;     RS8     (.p8.)    1.207    0.087   13.840    0.000    1.475    0.730</span></span>
<span><span class="co">#&gt;     RS9     (.p9.)    1.269    0.086   14.706    0.000    1.551    0.813</span></span>
<span><span class="co">#&gt;     RS10    (.10.)    1.194    0.086   13.965    0.000    1.459    0.738</span></span>
<span><span class="co">#&gt;     RS11    (.11.)    1.313    0.091   14.497    0.000    1.605    0.771</span></span>
<span><span class="co">#&gt;     RS12    (.12.)    1.160    0.086   13.546    0.000    1.418    0.712</span></span>
<span><span class="co">#&gt;     RS13    (.13.)    1.359    0.093   14.659    0.000    1.661    0.781</span></span>
<span><span class="co">#&gt;     RS14    (.14.)    1.334    0.086   15.592    0.000    1.630    0.840</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.30.)    4.874    0.089   54.484    0.000    4.874    2.650</span></span>
<span><span class="co">#&gt;    .RS2     (.31.)    4.249    0.104   40.863    0.000    4.249    2.012</span></span>
<span><span class="co">#&gt;    .RS3     (.32.)    4.190    0.095   44.218    0.000    4.190    2.153</span></span>
<span><span class="co">#&gt;    .RS4     (.33.)    4.482    0.107   41.924    0.000    4.482    2.053</span></span>
<span><span class="co">#&gt;    .RS5     (.34.)    3.838    0.107   35.990    0.000    3.838    1.753</span></span>
<span><span class="co">#&gt;    .RS6     (.35.)    5.068    0.098   51.642    0.000    5.068    2.575</span></span>
<span><span class="co">#&gt;    .RS7     (.36.)    4.969    0.100   49.744    0.000    4.969    2.492</span></span>
<span><span class="co">#&gt;    .RS8     (.37.)    4.381    0.100   43.816    0.000    4.381    2.169</span></span>
<span><span class="co">#&gt;    .RS9     (.38.)    4.290    0.101   42.586    0.000    4.290    2.247</span></span>
<span><span class="co">#&gt;    .RS10    (.39.)    4.652    0.098   47.405    0.000    4.652    2.351</span></span>
<span><span class="co">#&gt;    .RS11    (.40.)    4.519    0.104   43.349    0.000    4.519    2.170</span></span>
<span><span class="co">#&gt;    .RS12    (.41.)    5.035    0.098   51.351    0.000    5.035    2.530</span></span>
<span><span class="co">#&gt;    .RS13    (.42.)    4.928    0.107   46.152    0.000    4.928    2.317</span></span>
<span><span class="co">#&gt;    .RS14    (.43.)    4.783    0.099   48.258    0.000    4.783    2.465</span></span>
<span><span class="co">#&gt;     RS               -0.053    0.105   -0.503    0.615   -0.043   -0.043</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.15.)    1.889    0.124   15.247    0.000    1.889    0.559</span></span>
<span><span class="co">#&gt;    .RS2     (.16.)    2.203    0.147   15.033    0.000    2.203    0.494</span></span>
<span><span class="co">#&gt;    .RS3     (.17.)    2.095    0.138   15.231    0.000    2.095    0.553</span></span>
<span><span class="co">#&gt;    .RS4     (.18.)    2.502    0.165   15.141    0.000    2.502    0.525</span></span>
<span><span class="co">#&gt;    .RS5     (.19.)    2.643    0.174   15.226    0.000    2.643    0.551</span></span>
<span><span class="co">#&gt;    .RS6     (.20.)    1.660    0.113   14.748    0.000    1.660    0.428</span></span>
<span><span class="co">#&gt;    .RS7     (.21.)    1.595    0.109   14.603    0.000    1.595    0.401</span></span>
<span><span class="co">#&gt;    .RS8     (.22.)    1.905    0.128   14.924    0.000    1.905    0.467</span></span>
<span><span class="co">#&gt;    .RS9               1.238    0.125    9.864    0.000    1.238    0.340</span></span>
<span><span class="co">#&gt;    .RS10    (.24.)    1.783    0.120   14.876    0.000    1.783    0.456</span></span>
<span><span class="co">#&gt;    .RS11    (.25.)    1.762    0.120   14.631    0.000    1.762    0.406</span></span>
<span><span class="co">#&gt;    .RS12    (.26.)    1.951    0.130   15.027    0.000    1.951    0.493</span></span>
<span><span class="co">#&gt;    .RS13    (.27.)    1.768    0.122   14.541    0.000    1.768    0.391</span></span>
<span><span class="co">#&gt;    .RS14    (.28.)    1.108    0.080   13.770    0.000    1.108    0.294</span></span>
<span><span class="co">#&gt;     RS                1.493    0.216    6.911    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.441</span></span>
<span><span class="co">#&gt;     RS2               0.506</span></span>
<span><span class="co">#&gt;     RS3               0.447</span></span>
<span><span class="co">#&gt;     RS4               0.475</span></span>
<span><span class="co">#&gt;     RS5               0.449</span></span>
<span><span class="co">#&gt;     RS6               0.572</span></span>
<span><span class="co">#&gt;     RS7               0.599</span></span>
<span><span class="co">#&gt;     RS8               0.533</span></span>
<span><span class="co">#&gt;     RS9               0.660</span></span>
<span><span class="co">#&gt;     RS10              0.544</span></span>
<span><span class="co">#&gt;     RS11              0.594</span></span>
<span><span class="co">#&gt;     RS12              0.507</span></span>
<span><span class="co">#&gt;     RS13              0.609</span></span>
<span><span class="co">#&gt;     RS14              0.706</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-the-fit-to-table-5">Add the fit to table<a class="anchor" aria-label="anchor" href="#add-the-fit-to-table-5"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_fit</span><span class="op">[</span><span class="fl">8</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strict Model RS9"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">strict.fit2</span>, </span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"cfi"</span>,</span>
<span>                                                   <span class="st">"rmsea"</span>, <span class="st">"srmr"</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">table_fit</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Model</th>
<th align="left">X2</th>
<th align="left">df</th>
<th align="left">CFI</th>
<th align="left">RMSEA</th>
<th align="left">SRMR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Overall Model</td>
<td align="left">368.984</td>
<td align="left">77</td>
<td align="left">0.927</td>
<td align="left">0.086</td>
<td align="left">0.041</td>
</tr>
<tr class="even">
<td align="left">Men Model</td>
<td align="left">271.457</td>
<td align="left">77</td>
<td align="left">0.92</td>
<td align="left">0.102</td>
<td align="left">0.041</td>
</tr>
<tr class="odd">
<td align="left">Women Model</td>
<td align="left">258.61</td>
<td align="left">77</td>
<td align="left">0.895</td>
<td align="left">0.094</td>
<td align="left">0.052</td>
</tr>
<tr class="even">
<td align="left">Configural Model</td>
<td align="left">530.067</td>
<td align="left">154</td>
<td align="left">0.909</td>
<td align="left">0.098</td>
<td align="left">0.047</td>
</tr>
<tr class="odd">
<td align="left">Metric Model</td>
<td align="left">545.518</td>
<td align="left">167</td>
<td align="left">0.909</td>
<td align="left">0.094</td>
<td align="left">0.057</td>
</tr>
<tr class="even">
<td align="left">Scalar Model</td>
<td align="left">585.327</td>
<td align="left">180</td>
<td align="left">0.902</td>
<td align="left">0.094</td>
<td align="left">0.06</td>
</tr>
<tr class="odd">
<td align="left">Strict Model</td>
<td align="left">660.398</td>
<td align="left">194</td>
<td align="left">0.888</td>
<td align="left">0.097</td>
<td align="left">0.062</td>
</tr>
<tr class="even">
<td align="left">Strict Model RS9</td>
<td align="left">646.559</td>
<td align="left">193</td>
<td align="left">0.891</td>
<td align="left">0.096</td>
<td align="left">0.062</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="find-one-more-free-parameter">Find one more free parameter<a class="anchor" aria-label="anchor" href="#find-one-more-free-parameter"></a>
</h2>
<ul>
<li>We want to see if we can get up to .902 - .01 = .892 for our
CFI.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">partial_syntax</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>, </span>
<span>              data <span class="op">=</span> <span class="va">res.data</span>,</span>
<span>              meanstructure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              group <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>              group.equal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loadings"</span>, <span class="st">"intercepts"</span>, <span class="st">"residuals"</span><span class="op">)</span>,</span>
<span>              group.partial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RS9 ~~ RS9"</span>, <span class="va">partial_syntax</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">CFI_list</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">temp</span>, <span class="st">"cfi"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">CFI_list</span></span>
<span><span class="co">#&gt;   RS1 ~~ RS1   RS2 ~~ RS2   RS3 ~~ RS3   RS4 ~~ RS4   RS5 ~~ RS5   RS6 ~~ RS6 </span></span>
<span><span class="co">#&gt;    0.8907350    0.8923563    0.8911657    0.8907125    0.8906552    0.8905857 </span></span>
<span><span class="co">#&gt;   RS7 ~~ RS7   RS8 ~~ RS8   RS9 ~~ RS9 RS10 ~~ RS10 RS11 ~~ RS11 RS12 ~~ RS12 </span></span>
<span><span class="co">#&gt;    0.8904937    0.8930016    0.8906278    0.8914713    0.8919005    0.8927904 </span></span>
<span><span class="co">#&gt; RS13 ~~ RS13 RS14 ~~ RS14 </span></span>
<span><span class="co">#&gt;    0.8936296    0.8904971</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">CFI_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; RS13 ~~ RS13 </span></span>
<span><span class="co">#&gt;           13</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="add-one-more-free-parameter">Add one more free parameter<a class="anchor" aria-label="anchor" href="#add-one-more-free-parameter"></a>
</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">strict.fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">overall.model</span>,</span>
<span>                  data <span class="op">=</span> <span class="va">res.data</span>,</span>
<span>                  meanstructure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  group <span class="op">=</span> <span class="st">"Sex"</span>,</span>
<span>                  group.equal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loadings"</span>, <span class="st">"intercepts"</span>, <span class="st">"residuals"</span><span class="op">)</span>, </span>
<span>                  group.partial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RS9 ~~ RS9"</span>, <span class="st">"RS13 ~~ RS13"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">strict.fit3</span>,</span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        fit.measure <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 44 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        85</span></span>
<span><span class="co">#&gt;   Number of equality constraints                    39</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations per group:                   </span></span>
<span><span class="co">#&gt;     Women                                          266</span></span>
<span><span class="co">#&gt;     Men                                            244</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               633.111</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               192</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt;   Test statistic for each group:</span></span>
<span><span class="co">#&gt;     Women                                      305.696</span></span>
<span><span class="co">#&gt;     Men                                        327.415</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              4328.931</span></span>
<span><span class="co">#&gt;   Degrees of freedom                               182</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.894</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.899</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)             -13033.933</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)     -12717.377</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                               26159.866</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                             26354.649</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)      26208.638</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.095</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.087</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.103</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.999</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 1 [Women]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.050    0.607</span></span>
<span><span class="co">#&gt;     RS2     (.p2.)    1.230    0.091   13.554    0.000    1.291    0.657</span></span>
<span><span class="co">#&gt;     RS3     (.p3.)    1.061    0.083   12.794    0.000    1.114    0.609</span></span>
<span><span class="co">#&gt;     RS4     (.p4.)    1.227    0.093   13.133    0.000    1.287    0.630</span></span>
<span><span class="co">#&gt;     RS5     (.p5.)    1.201    0.093   12.853    0.000    1.260    0.613</span></span>
<span><span class="co">#&gt;     RS6     (.p6.)    1.217    0.085   14.280    0.000    1.278    0.704</span></span>
<span><span class="co">#&gt;     RS7     (.p7.)    1.262    0.087   14.571    0.000    1.325    0.724</span></span>
<span><span class="co">#&gt;     RS8     (.p8.)    1.208    0.087   13.872    0.000    1.268    0.677</span></span>
<span><span class="co">#&gt;     RS9     (.p9.)    1.269    0.086   14.727    0.000    1.332    0.680</span></span>
<span><span class="co">#&gt;     RS10    (.10.)    1.192    0.085   13.961    0.000    1.251    0.683</span></span>
<span><span class="co">#&gt;     RS11    (.11.)    1.310    0.090   14.490    0.000    1.375    0.719</span></span>
<span><span class="co">#&gt;     RS12    (.12.)    1.162    0.086   13.583    0.000    1.220    0.658</span></span>
<span><span class="co">#&gt;     RS13    (.13.)    1.372    0.092   14.962    0.000    1.440    0.698</span></span>
<span><span class="co">#&gt;     RS14    (.14.)    1.334    0.085   15.613    0.000    1.400    0.799</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.30.)    4.874    0.089   54.505    0.000    4.874    2.819</span></span>
<span><span class="co">#&gt;    .RS2     (.31.)    4.249    0.104   40.874    0.000    4.249    2.162</span></span>
<span><span class="co">#&gt;    .RS3     (.32.)    4.190    0.095   44.263    0.000    4.190    2.292</span></span>
<span><span class="co">#&gt;    .RS4     (.33.)    4.482    0.107   41.983    0.000    4.482    2.194</span></span>
<span><span class="co">#&gt;    .RS5     (.34.)    3.838    0.107   36.001    0.000    3.838    1.867</span></span>
<span><span class="co">#&gt;    .RS6     (.35.)    5.068    0.098   51.674    0.000    5.068    2.793</span></span>
<span><span class="co">#&gt;    .RS7     (.36.)    4.969    0.100   49.770    0.000    4.969    2.716</span></span>
<span><span class="co">#&gt;    .RS8     (.37.)    4.382    0.100   43.826    0.000    4.382    2.340</span></span>
<span><span class="co">#&gt;    .RS9     (.38.)    4.290    0.101   42.614    0.000    4.290    2.189</span></span>
<span><span class="co">#&gt;    .RS10    (.39.)    4.652    0.098   47.454    0.000    4.652    2.540</span></span>
<span><span class="co">#&gt;    .RS11    (.40.)    4.520    0.104   43.401    0.000    4.520    2.362</span></span>
<span><span class="co">#&gt;    .RS12    (.41.)    5.035    0.098   51.354    0.000    5.035    2.718</span></span>
<span><span class="co">#&gt;    .RS13    (.42.)    4.915    0.107   45.827    0.000    4.915    2.382</span></span>
<span><span class="co">#&gt;    .RS14    (.43.)    4.783    0.099   48.290    0.000    4.783    2.732</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.15.)    1.888    0.124   15.250    0.000    1.888    0.632</span></span>
<span><span class="co">#&gt;    .RS2     (.16.)    2.198    0.146   15.035    0.000    2.198    0.569</span></span>
<span><span class="co">#&gt;    .RS3     (.17.)    2.101    0.138   15.242    0.000    2.101    0.629</span></span>
<span><span class="co">#&gt;    .RS4     (.18.)    2.516    0.166   15.158    0.000    2.516    0.603</span></span>
<span><span class="co">#&gt;    .RS5     (.19.)    2.639    0.173   15.228    0.000    2.639    0.624</span></span>
<span><span class="co">#&gt;    .RS6     (.20.)    1.659    0.112   14.755    0.000    1.659    0.504</span></span>
<span><span class="co">#&gt;    .RS7     (.21.)    1.593    0.109   14.609    0.000    1.593    0.476</span></span>
<span><span class="co">#&gt;    .RS8     (.22.)    1.899    0.127   14.925    0.000    1.899    0.541</span></span>
<span><span class="co">#&gt;    .RS9               2.066    0.192   10.773    0.000    2.066    0.538</span></span>
<span><span class="co">#&gt;    .RS10    (.24.)    1.789    0.120   14.891    0.000    1.789    0.534</span></span>
<span><span class="co">#&gt;    .RS11    (.25.)    1.771    0.121   14.652    0.000    1.771    0.484</span></span>
<span><span class="co">#&gt;    .RS12    (.26.)    1.944    0.129   15.025    0.000    1.944    0.566</span></span>
<span><span class="co">#&gt;    .RS13              2.184    0.204   10.693    0.000    2.184    0.513</span></span>
<span><span class="co">#&gt;    .RS14    (.28.)    1.106    0.080   13.781    0.000    1.106    0.361</span></span>
<span><span class="co">#&gt;     RS                1.101    0.158    6.989    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.368</span></span>
<span><span class="co">#&gt;     RS2               0.431</span></span>
<span><span class="co">#&gt;     RS3               0.371</span></span>
<span><span class="co">#&gt;     RS4               0.397</span></span>
<span><span class="co">#&gt;     RS5               0.376</span></span>
<span><span class="co">#&gt;     RS6               0.496</span></span>
<span><span class="co">#&gt;     RS7               0.524</span></span>
<span><span class="co">#&gt;     RS8               0.459</span></span>
<span><span class="co">#&gt;     RS9               0.462</span></span>
<span><span class="co">#&gt;     RS10              0.466</span></span>
<span><span class="co">#&gt;     RS11              0.516</span></span>
<span><span class="co">#&gt;     RS12              0.434</span></span>
<span><span class="co">#&gt;     RS13              0.487</span></span>
<span><span class="co">#&gt;     RS14              0.639</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group 2 [Men]:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   RS =~                                                                 </span></span>
<span><span class="co">#&gt;     RS1               1.000                               1.224    0.665</span></span>
<span><span class="co">#&gt;     RS2     (.p2.)    1.230    0.091   13.554    0.000    1.505    0.712</span></span>
<span><span class="co">#&gt;     RS3     (.p3.)    1.061    0.083   12.794    0.000    1.299    0.667</span></span>
<span><span class="co">#&gt;     RS4     (.p4.)    1.227    0.093   13.133    0.000    1.501    0.687</span></span>
<span><span class="co">#&gt;     RS5     (.p5.)    1.201    0.093   12.853    0.000    1.469    0.671</span></span>
<span><span class="co">#&gt;     RS6     (.p6.)    1.217    0.085   14.280    0.000    1.490    0.756</span></span>
<span><span class="co">#&gt;     RS7     (.p7.)    1.262    0.087   14.571    0.000    1.545    0.774</span></span>
<span><span class="co">#&gt;     RS8     (.p8.)    1.208    0.087   13.872    0.000    1.478    0.731</span></span>
<span><span class="co">#&gt;     RS9     (.p9.)    1.269    0.086   14.727    0.000    1.553    0.813</span></span>
<span><span class="co">#&gt;     RS10    (.10.)    1.192    0.085   13.961    0.000    1.458    0.737</span></span>
<span><span class="co">#&gt;     RS11    (.11.)    1.310    0.090   14.490    0.000    1.603    0.769</span></span>
<span><span class="co">#&gt;     RS12    (.12.)    1.162    0.086   13.583    0.000    1.422    0.714</span></span>
<span><span class="co">#&gt;     RS13    (.13.)    1.372    0.092   14.962    0.000    1.679    0.826</span></span>
<span><span class="co">#&gt;     RS14    (.14.)    1.334    0.085   15.613    0.000    1.632    0.841</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Intercepts:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.30.)    4.874    0.089   54.505    0.000    4.874    2.649</span></span>
<span><span class="co">#&gt;    .RS2     (.31.)    4.249    0.104   40.874    0.000    4.249    2.012</span></span>
<span><span class="co">#&gt;    .RS3     (.32.)    4.190    0.095   44.263    0.000    4.190    2.153</span></span>
<span><span class="co">#&gt;    .RS4     (.33.)    4.482    0.107   41.983    0.000    4.482    2.052</span></span>
<span><span class="co">#&gt;    .RS5     (.34.)    3.838    0.107   36.001    0.000    3.838    1.753</span></span>
<span><span class="co">#&gt;    .RS6     (.35.)    5.068    0.098   51.674    0.000    5.068    2.574</span></span>
<span><span class="co">#&gt;    .RS7     (.36.)    4.969    0.100   49.770    0.000    4.969    2.491</span></span>
<span><span class="co">#&gt;    .RS8     (.37.)    4.382    0.100   43.826    0.000    4.382    2.168</span></span>
<span><span class="co">#&gt;    .RS9     (.38.)    4.290    0.101   42.614    0.000    4.290    2.246</span></span>
<span><span class="co">#&gt;    .RS10    (.39.)    4.652    0.098   47.454    0.000    4.652    2.351</span></span>
<span><span class="co">#&gt;    .RS11    (.40.)    4.520    0.104   43.401    0.000    4.520    2.169</span></span>
<span><span class="co">#&gt;    .RS12    (.41.)    5.035    0.098   51.354    0.000    5.035    2.528</span></span>
<span><span class="co">#&gt;    .RS13    (.42.)    4.915    0.107   45.827    0.000    4.915    2.419</span></span>
<span><span class="co">#&gt;    .RS14    (.43.)    4.783    0.099   48.290    0.000    4.783    2.463</span></span>
<span><span class="co">#&gt;     RS               -0.053    0.105   -0.507    0.612   -0.043   -0.043</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .RS1     (.15.)    1.888    0.124   15.250    0.000    1.888    0.558</span></span>
<span><span class="co">#&gt;    .RS2     (.16.)    2.198    0.146   15.035    0.000    2.198    0.493</span></span>
<span><span class="co">#&gt;    .RS3     (.17.)    2.101    0.138   15.242    0.000    2.101    0.555</span></span>
<span><span class="co">#&gt;    .RS4     (.18.)    2.516    0.166   15.158    0.000    2.516    0.528</span></span>
<span><span class="co">#&gt;    .RS5     (.19.)    2.639    0.173   15.228    0.000    2.639    0.550</span></span>
<span><span class="co">#&gt;    .RS6     (.20.)    1.659    0.112   14.755    0.000    1.659    0.428</span></span>
<span><span class="co">#&gt;    .RS7     (.21.)    1.593    0.109   14.609    0.000    1.593    0.400</span></span>
<span><span class="co">#&gt;    .RS8     (.22.)    1.899    0.127   14.925    0.000    1.899    0.465</span></span>
<span><span class="co">#&gt;    .RS9               1.239    0.125    9.900    0.000    1.239    0.339</span></span>
<span><span class="co">#&gt;    .RS10    (.24.)    1.789    0.120   14.891    0.000    1.789    0.457</span></span>
<span><span class="co">#&gt;    .RS11    (.25.)    1.771    0.121   14.652    0.000    1.771    0.408</span></span>
<span><span class="co">#&gt;    .RS12    (.26.)    1.944    0.129   15.025    0.000    1.944    0.490</span></span>
<span><span class="co">#&gt;    .RS13              1.310    0.134    9.779    0.000    1.310    0.317</span></span>
<span><span class="co">#&gt;    .RS14    (.28.)    1.106    0.080   13.781    0.000    1.106    0.294</span></span>
<span><span class="co">#&gt;     RS                1.497    0.216    6.917    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     RS1               0.442</span></span>
<span><span class="co">#&gt;     RS2               0.507</span></span>
<span><span class="co">#&gt;     RS3               0.445</span></span>
<span><span class="co">#&gt;     RS4               0.472</span></span>
<span><span class="co">#&gt;     RS5               0.450</span></span>
<span><span class="co">#&gt;     RS6               0.572</span></span>
<span><span class="co">#&gt;     RS7               0.600</span></span>
<span><span class="co">#&gt;     RS8               0.535</span></span>
<span><span class="co">#&gt;     RS9               0.661</span></span>
<span><span class="co">#&gt;     RS10              0.543</span></span>
<span><span class="co">#&gt;     RS11              0.592</span></span>
<span><span class="co">#&gt;     RS12              0.510</span></span>
<span><span class="co">#&gt;     RS13              0.683</span></span>
<span><span class="co">#&gt;     RS14              0.706</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="partial-invariance-met">Partial Invariance Met!<a class="anchor" aria-label="anchor" href="#partial-invariance-met"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table_fit</span><span class="op">[</span><span class="fl">9</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strict Model RS9 + 13"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">strict.fit3</span>, </span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"cfi"</span>,</span>
<span>                                                   <span class="st">"rmsea"</span>, <span class="st">"srmr"</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">table_fit</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Model</th>
<th align="left">X2</th>
<th align="left">df</th>
<th align="left">CFI</th>
<th align="left">RMSEA</th>
<th align="left">SRMR</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Overall Model</td>
<td align="left">368.984</td>
<td align="left">77</td>
<td align="left">0.927</td>
<td align="left">0.086</td>
<td align="left">0.041</td>
</tr>
<tr class="even">
<td align="left">Men Model</td>
<td align="left">271.457</td>
<td align="left">77</td>
<td align="left">0.92</td>
<td align="left">0.102</td>
<td align="left">0.041</td>
</tr>
<tr class="odd">
<td align="left">Women Model</td>
<td align="left">258.61</td>
<td align="left">77</td>
<td align="left">0.895</td>
<td align="left">0.094</td>
<td align="left">0.052</td>
</tr>
<tr class="even">
<td align="left">Configural Model</td>
<td align="left">530.067</td>
<td align="left">154</td>
<td align="left">0.909</td>
<td align="left">0.098</td>
<td align="left">0.047</td>
</tr>
<tr class="odd">
<td align="left">Metric Model</td>
<td align="left">545.518</td>
<td align="left">167</td>
<td align="left">0.909</td>
<td align="left">0.094</td>
<td align="left">0.057</td>
</tr>
<tr class="even">
<td align="left">Scalar Model</td>
<td align="left">585.327</td>
<td align="left">180</td>
<td align="left">0.902</td>
<td align="left">0.094</td>
<td align="left">0.06</td>
</tr>
<tr class="odd">
<td align="left">Strict Model</td>
<td align="left">660.398</td>
<td align="left">194</td>
<td align="left">0.888</td>
<td align="left">0.097</td>
<td align="left">0.062</td>
</tr>
<tr class="even">
<td align="left">Strict Model RS9</td>
<td align="left">646.559</td>
<td align="left">193</td>
<td align="left">0.891</td>
<td align="left">0.096</td>
<td align="left">0.062</td>
</tr>
<tr class="odd">
<td align="left">Strict Model RS9 + 13</td>
<td align="left">633.111</td>
<td align="left">192</td>
<td align="left">0.894</td>
<td align="left">0.095</td>
<td align="left">0.062</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h2>
<ul>
<li>The RS is mostly invariant – the structure, loadings, intercepts,
and most of the error variances are the same across men and women.</li>
<li>However, two items show larger variances:
<ul>
<li>RS9</li>
<li>RS13</li>
<li>Where, women show much larger variances on both of those questions.
<ul>
<li>I keep interested in things.</li>
<li>My life has meaning.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="lavpredict-on-the-items">lavPredict on the items<a class="anchor" aria-label="anchor" href="#lavpredict-on-the-items"></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predicted_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavPredict.html" class="external-link">lavPredict</a></span><span class="op">(</span><span class="va">strict.fit3</span>, type <span class="op">=</span> <span class="st">"ov"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Men Women </span></span>
<span><span class="co">#&gt;   244   266</span></span>
<span></span>
<span><span class="va">predicted_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">predicted_scores</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">predicted_scores</span><span class="op">$</span><span class="va">Sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Women"</span>, <span class="fl">266</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="fl">244</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predicted_scores</span><span class="op">$</span><span class="va">sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">predicted_scores</span><span class="op">[</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">14</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predicted_scores</span><span class="op">)</span></span>
<span><span class="co">#&gt;        RS1      RS2      RS3      RS4      RS5      RS6      RS7      RS8</span></span>
<span><span class="co">#&gt; 1 4.398945 3.664178 3.685068 3.898936 3.267464 4.489343 4.369067 3.807156</span></span>
<span><span class="co">#&gt; 2 5.812096 5.401971 5.184889 5.632255 4.964156 6.209687 6.153074 5.514666</span></span>
<span><span class="co">#&gt; 3 6.517211 6.269071 5.933248 6.497123 5.810748 7.068081 7.043233 6.366655</span></span>
<span><span class="co">#&gt; 4 5.458156 4.966720 4.809240 5.198124 4.539199 5.778806 5.706248 5.086999</span></span>
<span><span class="co">#&gt; 5 4.051653 3.237102 3.316476 3.472960 2.850489 4.066555 3.930633 3.387523</span></span>
<span><span class="co">#&gt; 6 4.625009 3.942175 3.924997 4.176218 3.538887 4.764549 4.654457 4.080309</span></span>
<span><span class="co">#&gt;        RS9     RS10     RS11     RS12     RS13     RS14   Sex      sum</span></span>
<span><span class="co">#&gt; 1 3.686699 4.085209 3.896680 4.482787 4.262883 4.148736 Women 56.14315</span></span>
<span><span class="co">#&gt; 2 5.479791 5.769280 5.747900 6.125213 6.201545 6.033519 Women 80.23004</span></span>
<span><span class="co">#&gt; 3 6.374483 6.609575 6.671596 6.944727 7.168871 6.973961 Women 92.24858</span></span>
<span><span class="co">#&gt; 4 5.030689 5.347484 5.284240 5.713847 5.715984 5.561452 Women 74.19719</span></span>
<span><span class="co">#&gt; 5 3.246033 3.671336 3.441728 4.079148 3.786442 3.685536 Women 50.22361</span></span>
<span><span class="co">#&gt; 6 3.973543 4.354613 4.192822 4.745528 4.573014 4.450247 Women 59.99637</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">predicted_scores</span><span class="op">$</span><span class="va">sum</span>, <span class="va">predicted_scores</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Men    Women </span></span>
<span><span class="co">#&gt; 63.34281 64.24733</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="lavpredict-on-the-factor-scores">lavPredict on the factor scores<a class="anchor" aria-label="anchor" href="#lavpredict-on-the-factor-scores"></a>
</h2>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.data</span><span class="op">$</span><span class="va">sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">[</span> , <span class="fl">3</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span>, <span class="fl">1</span>, <span class="va">sum</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">$</span><span class="va">sum</span>, <span class="va">res.data</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Men    Women </span></span>
<span><span class="co">#&gt; 63.47131 64.10902</span></span>
<span></span>
<span><span class="va">latent_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavPredict.html" class="external-link">lavPredict</a></span><span class="op">(</span><span class="va">strict.fit3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">latent_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">latent_means</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">latent_means</span><span class="op">$</span><span class="va">Sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Women"</span>, <span class="fl">266</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Men"</span>, <span class="fl">244</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">latent_means</span><span class="op">$</span><span class="va">RS</span>, <span class="va">latent_means</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">mean</span><span class="op">)</span> </span>
<span><span class="co">#&gt;              Men            Women </span></span>
<span><span class="co">#&gt; -0.0530675184545 -0.0000004953854</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">latent_means</span><span class="op">$</span><span class="va">RS</span>, <span class="va">latent_means</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">mean</span><span class="op">)</span> <span class="op">*</span> <span class="co">#latent mean</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">$</span><span class="va">sum</span>, <span class="va">res.data</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">sd</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">+</span> <span class="co">#real sum</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">res.data</span><span class="op">$</span><span class="va">sum</span>, <span class="va">res.data</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co">#real sd</span></span>
<span><span class="co">#&gt;      Men    Women </span></span>
<span><span class="co">#&gt; 62.32949 64.10901</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculate-your-favorite-stat">Calculate your favorite stat<a class="anchor" aria-label="anchor" href="#calculate-your-favorite-stat"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MOTE</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">predicted_scores</span><span class="op">$</span><span class="va">sum</span>, <span class="va">predicted_scores</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">mean</span><span class="op">)</span></span>
<span><span class="va">SD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">predicted_scores</span><span class="op">$</span><span class="va">sum</span>, <span class="va">predicted_scores</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">sd</span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">predicted_scores</span><span class="op">$</span><span class="va">sum</span>, <span class="va">predicted_scores</span><span class="op">$</span><span class="va">Sex</span>, <span class="va">length</span><span class="op">)</span></span>
<span></span>
<span><span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MOTE/man/d.ind.t.html" class="external-link">d.ind.t</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">M</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">SD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">SD</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">N</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, a <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span>
<span><span class="va">effect_size</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="co">#&gt; [1] "$d_s$ = -0.05, 95\\% CI [-0.22, 0.13]"</span></span>
<span><span class="va">effect_size</span><span class="op">$</span><span class="va">statistic</span></span>
<span><span class="co">#&gt; [1] "$t$(508) = -0.54, $p$ = .587"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<ul>
<li>
<p>In this lecture you’ve learned:</p>
<ul>
<li>The concepts and terminology for a multigroup model</li>
<li>How to implement a multigroup model</li>
<li>How to assess for partial invariance</li>
<li>How to assess latent means and their potential differences</li>
</ul>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Erin M. Buchanan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
