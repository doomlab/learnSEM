<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Path Analysis • learnSEM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Path Analysis">
<meta name="description" content="This vignette includes the lecture slides for path analysis for SEM (part 5).
">
<meta property="og:description" content="This vignette includes the lecture slides for path analysis for SEM (part 5).
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">learnSEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lecture_cfa.html">CFA: Basics</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_data_screen.html">Data Screening</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_efa.html">Exploratory Factor Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_introR.html">Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_irt.html">Item Response Theory</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_lgm.html">Latent Growth Models</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_mgcfa.html">Multi-Group Confirmatory Factor Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_mtmm.html">Multi-Trait Multi-Method</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_path.html">Path Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_secondcfa.html">Confirmatory Factor Analysis: Second Order</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_sem.html">Full SEM</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_terms.html">Terms and Concepts</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Path Analysis</h1>
            
      

      <div class="d-none name"><code>lecture_path.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="estimation">Estimation<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h2>
<ul>
<li>Estimation is the math that goes on behind the scenes to give you
parameter numbers</li>
<li>Common types:
<ul>
<li>Maximum Likelihood (ML)</li>
<li>Asymptotically Distribution Free (ADF)</li>
<li>Unweighted Least Squares (ULS)</li>
<li>Two stage least squares (TSLS)</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="maximum-likelihood">Maximum Likelihood<a class="anchor" aria-label="anchor" href="#maximum-likelihood"></a>
</h2>
<ul>
<li>Estimates are the ones that maximize the likelihood that the data
were drawn from the population</li>
<li>Normal theory method - multivariate normality is assumed to use ML
<ul>
<li>Check your normality assumption!</li>
<li>Other types of estimations may work better for non-normal endogenous
variables</li>
</ul>
</li>
<li>Full information method - estimates are calculated all at the same
time
<ul>
<li>Partial information methods calculate part of the estimates, then
use those to calculate the rest</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="maximum-likelihood-1">Maximum Likelihood<a class="anchor" aria-label="anchor" href="#maximum-likelihood-1"></a>
</h2>
<ul>
<li>Fit function - the relationship between the sample covariances and
estimated covariances</li>
<li>We want our fit function to be:
<ul>
<li>High if we are measuring how much they match (goodness of fit)</li>
<li>Low if we are measuring how much they mismatch (residuals)</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="maximum-likelihood-2">Maximum Likelihood<a class="anchor" aria-label="anchor" href="#maximum-likelihood-2"></a>
</h2>
<ul>
<li>ML is an iterative process</li>
<li>The computer calculates a possible start solution</li>
<li>Then runs several times to create the largest ML match</li>
<li>Start values:
<ul>
<li>Usually generated by the computer</li>
<li>You can enter values if you are having problems converging to a
solution</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="maximum-likelihood-3">Maximum Likelihood<a class="anchor" aria-label="anchor" href="#maximum-likelihood-3"></a>
</h2>
<ul>
<li>Scale free/invariant
<ul>
<li>Means that if you change the scale with a linear transform, the
model is still the same</li>
</ul>
</li>
<li>Assumes unstandardized start variables
<ul>
<li>Otherwise you would be standardizing standardized estimates</li>
</ul>
</li>
<li>Interpretation of Estimates
<ul>
<li>Loadings/path coefficients - just like regression coefficients</li>
<li>Covariance/correlation - how much two items vary together</li>
<li>Error variances tell you how much variance is not accounted for by
the model (so you want to be small)</li>
<li>SMCs are the amount of variance accounted for in a endogenous
variable</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="other-methods">Other Methods<a class="anchor" aria-label="anchor" href="#other-methods"></a>
</h2>
<ul>
<li>For continuous variables with normal distributions:
<ul>
<li>Generalized Least Squares (GLS)</li>
<li>Unweighted Least Squares (ULS)</li>
<li>Fully Weighted Least Squares (WLS)</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="generalized-least-squares">Generalized Least Squares<a class="anchor" aria-label="anchor" href="#generalized-least-squares"></a>
</h2>
<ul>
<li>Pros:
<ul>
<li>Scale free</li>
<li>Faster computation time</li>
</ul>
</li>
<li>Cons:
<ul>
<li>Not commonly used? If this runs usually so does ML</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="unweighted-least-squares">Unweighted Least Squares<a class="anchor" aria-label="anchor" href="#unweighted-least-squares"></a>
</h2>
<ul>
<li>Pros:
<ul>
<li>Does not require positive definite matrices</li>
<li>Robust initial estimates</li>
</ul>
</li>
<li>Cons:
<ul>
<li>Not scale free</li>
<li>Not as efficient</li>
<li>All variables in the same scale</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="other-methods-1">Other Methods<a class="anchor" aria-label="anchor" href="#other-methods-1"></a>
</h2>
<ul>
<li>Nonnormal data
<ul>
<li>In ML, estimates might be accurate but standard errors may be
large</li>
<li>Model fit tends to be overestimated</li>
</ul>
</li>
<li>Corrected normal method - uses ML but then adjusts the SEs to be
normal (robust SE).
<ul>
<li>Satorra-Bentler statistic: Adjusts the chi square value from
standard ML by the degree of kurtosis/skew</li>
<li>Corrected model test statistic</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="asymptotically-distribution-free">Asymptotically Distribution Free<a class="anchor" aria-label="anchor" href="#asymptotically-distribution-free"></a>
</h2>
<ul>
<li>Some books call this arbitrary distribution free</li>
<li>Estimates the skew/kurtosis in the data to generate a model</li>
<li>May not converge because of number of parameters to estimate</li>
</ul>
</div>
<div class="section level2">
<h2 id="errors">Errors<a class="anchor" aria-label="anchor" href="#errors"></a>
</h2>
<ul>
<li>Inadmissible solutions - you get numbers in your output but clearly
parameters are</li>
<li>Heywood cases
<ul>
<li>Parameter estimates are illogical (huge)</li>
<li>Negative variance estimates
<ul>
<li>Just variances, covariances can be negative</li>
</ul>
</li>
<li>Correlation estimates over 1 (SMCs)</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="why-errors-happen">Why Errors Happen<a class="anchor" aria-label="anchor" href="#why-errors-happen"></a>
</h2>
<ul>
<li>Specification error</li>
<li>Nonidentification</li>
<li>Outliers</li>
<li>Small samples</li>
<li>Two indicators per latent (more is always better)</li>
<li>Bad start values (especially for errors)</li>
<li>Very low or high correlations (empirical under identification)</li>
</ul>
</div>
<div class="section level2">
<h2 id="path-models">Path Models<a class="anchor" aria-label="anchor" href="#path-models"></a>
</h2>
<ul>
<li>Reminder:
<ul>
<li>Circles are latent (unobserved) variables</li>
<li>Squares are manifest (observed) variables</li>
<li>Triangles can be used to represent intercepts (specific models use
these)</li>
</ul>
</li>
<li>So what is a path model?
<ul>
<li>A model with only manifest variables (measured/squares)</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="path-models-1">Path Models<a class="anchor" aria-label="anchor" href="#path-models-1"></a>
</h2>
<ul>
<li>Straight arrows are “causal” or directional
<ul>
<li>Non-standardized solution -&gt; these are your b or slope
values</li>
<li>Standardized solution -&gt; these are your beta values</li>
</ul>
</li>
<li>Curved arrows are non-directional
<ul>
<li>Non-standardized -&gt; covariance</li>
<li>Standardized -&gt; correlation</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="path-models-2">Path Models<a class="anchor" aria-label="anchor" href="#path-models-2"></a>
</h2>
<ul>
<li>All endogenous variables have an error term</li>
<li>All exogenous variables will have a variance</li>
<li><strong>All exogenous only variables are automatically correlated by
lavaan</strong></li>
</ul>
</div>
<div class="section level2">
<h2 id="solutions">Solutions<a class="anchor" aria-label="anchor" href="#solutions"></a>
</h2>
<ul>
<li>Why standardized?
<ul>
<li>Allows you to compare path coefficients for strength of
relationship</li>
<li>Makes the non-directional relationships correlation (more
interpretable)</li>
<li>Matches the values you are used to thinking about (EFA)</li>
</ul>
</li>
<li>Why unstandardized?
<ul>
<li>Allows you to estimate future scores and interpret path
coefficients, in the original scale of the data</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="lets-do-it">Let’s do it!<a class="anchor" aria-label="anchor" href="#lets-do-it"></a>
</h2>
<ul>
<li>Install <code>lavaan</code>: latent variable analysis</li>
<li>Install <code>semPlot</code>: helps us make pictures</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"lavaan"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"semPlot"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="syntax">Syntax<a class="anchor" aria-label="anchor" href="#syntax"></a>
</h2>
<ul>
<li>Note: there’s a cheat sheet guide on Canvas</li>
<li>First, we will define a “model”
<ul>
<li>Best practice: name the saved variable something like
<code>name.model</code> where <code>name</code> is a descriptive name of
the model you are building</li>
</ul>
</li>
<li>Model syntax
<ul>
<li>
<code>~</code> indicates a regression</li>
<li>
<code>~~</code> indicates a covariance/correlation</li>
<li>
<code>=~</code> indicates a latent variable</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="syntax-1">Syntax<a class="anchor" aria-label="anchor" href="#syntax-1"></a>
</h2>
<ul>
<li>Automatically adds an error term to each endogenous variable</li>
<li>Automatically constrains the path to 1 for you for the marker
variable</li>
<li>Automatically adds a covariance term between all exogenous variables
<ul>
<li>Very useful for analyses we will get to later</li>
<li>Not always required in path models, but you could constrain it to
zero</li>
<li>Important to note because it’s often unexpected</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="a-path-example">A Path Example<a class="anchor" aria-label="anchor" href="#a-path-example"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gesistsa.github.io/rio/" class="external-link">rio</a></span><span class="op">)</span></span>
<span><span class="va">eval.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html" class="external-link">import</a></span><span class="op">(</span><span class="st">"data/lecture_evals.csv"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-path-example-1">A Path Example<a class="anchor" aria-label="anchor" href="#a-path-example-1"></a>
</h2>
<p><img src="pictures%2Flecture_evals.png" width="25%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="estimate-df">Estimate df<a class="anchor" aria-label="anchor" href="#estimate-df"></a>
</h2>
<ul>
<li>Possible =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>4</mn><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>4</mn><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mn>2</mn></mfrac><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">\frac{4 \times (4+1)}{2} =  10</annotation></semantics></math>
</li>
<li>Estimated:
<ul>
<li>4 regressions</li>
<li>2 error variances</li>
<li>2 variances</li>
<li>1 covariance</li>
</ul>
</li>
<li>DF = 10 - 9 = 1</li>
</ul>
</div>
<div class="section level2">
<h2 id="build-the-model">Build the model<a class="anchor" aria-label="anchor" href="#build-the-model"></a>
</h2>
<p><img src="pictures%2Flecture_evals.png" width="25%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is lavaan 0.6-19</span></span>
<span><span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span></span>
<span><span class="va">eval.model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">q4 ~ q12 + q2</span></span>
<span><span class="st">q1 ~ q4 + q12</span></span>
<span><span class="st">'</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="important-notes">Important Notes<a class="anchor" aria-label="anchor" href="#important-notes"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval.model</span></span>
<span><span class="co">#&gt; [1] "\nq4 ~ q12 + q2\nq1 ~ q4 + q12\n"</span></span></code></pre></div>
<ul>
<li>Note that <code>\n</code> is code for new lines
<ul>
<li>These are important</li>
<li>Spacing is not important</li>
<li>You can use # in the code, it will ignore that line just like R</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="run-the-model">Run the Model<a class="anchor" aria-label="anchor" href="#run-the-model"></a>
</h2>
<ul>
<li>We can use the <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem()</a></code> function to apply the model to the
data</li>
<li>Save the analysis, use good naming like
<code>eval.output</code>
</li>
<li>The default estimator is normal theory maximum likelihood</li>
<li>Use <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">?sem</a></code> to learn more about the options</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eval.output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">eval.model</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">eval.data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="view-the-output">View the Output<a class="anchor" aria-label="anchor" href="#view-the-output"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">eval.output</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                          3585</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                              2152.922</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 1</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;   q4 ~                                                </span></span>
<span><span class="co">#&gt;     q12               0.096    0.008   12.479    0.000</span></span>
<span><span class="co">#&gt;     q2                0.435    0.010   45.655    0.000</span></span>
<span><span class="co">#&gt;   q1 ~                                                </span></span>
<span><span class="co">#&gt;     q4                0.840    0.017   49.923    0.000</span></span>
<span><span class="co">#&gt;     q12               0.263    0.010   26.551    0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)</span></span>
<span><span class="co">#&gt;    .q4                0.094    0.002   42.338    0.000</span></span>
<span><span class="co">#&gt;    .q1                0.151    0.004   42.338    0.000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<ul>
<li>Default output includes:
<ul>
<li>Sample size</li>
<li>Estimator</li>
<li>Minimum function test statistic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>,
<em>df</em>, <em>p</em>
</li>
<li>Unstandardized parameter estimates, standard error, <em>Z</em>,
<em>p</em>
</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="improved-output">Improved Output<a class="anchor" aria-label="anchor" href="#improved-output"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">eval.output</span>, </span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># for the standardized solution</span></span>
<span>        fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># for model fit</span></span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># for SMCs</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                          3585</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                              2152.922</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 1</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              7293.347</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 5</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.705</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                      -0.476</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)              -2539.494</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -1463.033</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                5090.988</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                              5128.095</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)       5109.030</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.775</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.747</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.802</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.105</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   q4 ~                                                                  </span></span>
<span><span class="co">#&gt;     q12               0.096    0.008   12.479    0.000    0.096    0.164</span></span>
<span><span class="co">#&gt;     q2                0.435    0.010   45.655    0.000    0.435    0.598</span></span>
<span><span class="co">#&gt;   q1 ~                                                                  </span></span>
<span><span class="co">#&gt;     q4                0.840    0.017   49.923    0.000    0.840    0.585</span></span>
<span><span class="co">#&gt;     q12               0.263    0.010   26.551    0.000    0.263    0.311</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .q4                0.094    0.002   42.338    0.000    0.094    0.553</span></span>
<span><span class="co">#&gt;    .q1                0.151    0.004   42.338    0.000    0.151    0.431</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     q4                0.447</span></span>
<span><span class="co">#&gt;     q1                0.569</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-a-picture">Create a Picture<a class="anchor" aria-label="anchor" href="#create-a-picture"></a>
</h2>
<ul>
<li>Sometimes it’s hard to know if you have modeled what you intended to
diagram</li>
<li>Let’s create a plot to make sure it’s what we meant to do</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SachaEpskamp/semPlot" class="external-link">semPlot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html" class="external-link">semPaths</a></span><span class="op">(</span><span class="va">eval.output</span>, <span class="co"># the analyzed model </span></span>
<span>         whatLabels <span class="op">=</span> <span class="st">"par"</span>, <span class="co"># what to add as the numbers, std for standardized</span></span>
<span>         edge.label.cex <span class="op">=</span> <span class="fl">1</span>, <span class="co"># make the font bigger</span></span>
<span>         layout <span class="op">=</span> <span class="st">"spring"</span><span class="op">)</span> <span class="co"># change the layout tree, circle, spring, tree2, circle2</span></span></code></pre></div>
<p><img src="lecture_path_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="another-example">Another Example<a class="anchor" aria-label="anchor" href="#another-example"></a>
</h2>
<ul>
<li>You don’t actually have to have the data to run an analysis</li>
<li>If you have the correlation matrix, you can still run the
analysis</li>
<li>It’s always better to use the raw data if you have it!</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regression.cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lav_matrix.html" class="external-link">lav_matrix_lower2full</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.00</span>,</span>
<span>                                         <span class="fl">0.20</span>,<span class="fl">1.00</span>,</span>
<span>                                         <span class="fl">0.24</span>,<span class="fl">0.30</span>,<span class="fl">1.00</span>,</span>
<span>                                         <span class="fl">0.70</span>,<span class="fl">0.80</span>,<span class="fl">0.30</span>,<span class="fl">1.00</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># name the variables in the matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">regression.cor</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">regression.cor</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"X3"</span>, <span class="st">"Y"</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="build-the-model-1">Build the Model<a class="anchor" aria-label="anchor" href="#build-the-model-1"></a>
</h2>
<ul>
<li>Let’s look at how we can label the paths</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regression.model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st"># structural model for Y</span></span>
<span><span class="st">Y ~ a*X1 + b*X2 + c*X3 </span></span>
<span><span class="st"># label the residual variance of Y</span></span>
<span><span class="st">Y ~~ z*Y </span></span>
<span><span class="st">'</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyze-the-model">Analyze the Model<a class="anchor" aria-label="anchor" href="#analyze-the-model"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regression.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">regression.model</span>,</span>
<span>                      sample.cov <span class="op">=</span> <span class="va">regression.cor</span>, <span class="co"># instead of data</span></span>
<span>                      sample.nobs <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="co"># number of data points</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="view-the-summary">View the Summary<a class="anchor" aria-label="anchor" href="#view-the-summary"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">regression.fit</span>, </span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        fit.measures <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                          1000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                              2913.081</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 3</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    1.000</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)                 38.102</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)         38.102</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                 -68.205</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                               -48.574</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)        -61.278</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.000</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.000</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                       NA</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                       NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   Y ~                                                                   </span></span>
<span><span class="co">#&gt;     X1         (a)    0.571    0.008   74.539    0.000    0.571    0.571</span></span>
<span><span class="co">#&gt;     X2         (b)    0.700    0.008   89.724    0.000    0.700    0.700</span></span>
<span><span class="co">#&gt;     X3         (c)   -0.047    0.008   -5.980    0.000   -0.047   -0.047</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .Y          (z)    0.054    0.002   22.361    0.000    0.054    0.054</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     Y                 0.946</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-a-picture-1">Create a Picture<a class="anchor" aria-label="anchor" href="#create-a-picture-1"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html" class="external-link">semPaths</a></span><span class="op">(</span><span class="va">regression.fit</span>, </span>
<span>         whatLabels<span class="op">=</span><span class="st">"par"</span>, </span>
<span>         edge.label.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         layout<span class="op">=</span><span class="st">"tree"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_path_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="mediation-models">Mediation Models<a class="anchor" aria-label="anchor" href="#mediation-models"></a>
</h2>
<ul>
<li>Mediation models are regression models that imply that two variables
are related (X and Y) <em>until</em> you add the mediator variable (M),
which diminishes the relationship between X and Y</li>
<li>You can model these with regression or a structural layout</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beaujean.cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lav_matrix.html" class="external-link">lav_matrix_lower2full</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">648.07</span>, </span>
<span>                                        <span class="fl">30.05</span>, <span class="fl">8.64</span>, </span>
<span>                                        <span class="fl">140.18</span>, <span class="fl">25.57</span>, <span class="fl">233.21</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">beaujean.cov</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">beaujean.cov</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"salary"</span>, <span class="st">"school"</span>, <span class="st">"iq"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="build-the-model-2">Build the Model<a class="anchor" aria-label="anchor" href="#build-the-model-2"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beaujean.model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">salary ~ a*school + c*iq</span></span>
<span><span class="st">iq ~ b*school # this is reversed in first printing of the book </span></span>
<span><span class="st">ind:= b*c # this is the mediation part </span></span>
<span><span class="st">'</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyze-the-model-1">Analyze the Model<a class="anchor" aria-label="anchor" href="#analyze-the-model-1"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beaujean.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">beaujean.model</span>, </span>
<span>                    sample.cov <span class="op">=</span> <span class="va">beaujean.cov</span>, </span>
<span>                    sample.nobs <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="view-the-summary-1">View the Summary<a class="anchor" aria-label="anchor" href="#view-the-summary-1"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">beaujean.fit</span>, </span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        fit.measures <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           300</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                               179.791</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 3</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    1.000</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)              -2549.357</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -2549.357</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                5108.713</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                              5127.232</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)       5111.375</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.000</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.000</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                       NA</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                       NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   salary ~                                                              </span></span>
<span><span class="co">#&gt;     school     (a)    2.515    0.549    4.585    0.000    2.515    0.290</span></span>
<span><span class="co">#&gt;     iq         (c)    0.325    0.106    3.081    0.002    0.325    0.195</span></span>
<span><span class="co">#&gt;   iq ~                                                                  </span></span>
<span><span class="co">#&gt;     school     (b)    2.959    0.247   12.005    0.000    2.959    0.570</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .salary          525.128   42.877   12.247    0.000  525.128    0.813</span></span>
<span><span class="co">#&gt;    .iq              157.011   12.820   12.247    0.000  157.011    0.676</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     salary            0.187</span></span>
<span><span class="co">#&gt;     iq                0.324</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Defined Parameters:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;     ind               0.963    0.323    2.984    0.003    0.963    0.111</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-a-picture-2">Create a Picture<a class="anchor" aria-label="anchor" href="#create-a-picture-2"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html" class="external-link">semPaths</a></span><span class="op">(</span><span class="va">beaujean.fit</span>, </span>
<span>         whatLabels<span class="op">=</span><span class="st">"par"</span>, </span>
<span>         edge.label.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         layout<span class="op">=</span><span class="st">"tree"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_path_files/figure-html/unnamed-chunk-22-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="fit-indices">Fit Indices<a class="anchor" aria-label="anchor" href="#fit-indices"></a>
</h2>
<ul>
<li>Now that we’ve done a few examples, how can we know if our model is
representative of the data?</li>
<li>We can use fit indices!</li>
<li>There are a lot of them</li>
<li>They do not imply that you are perfectly right</li>
<li>They have guidelines but they are not perfect either</li>
<li>People misuse them.</li>
</ul>
</div>
<div class="section level2">
<h2 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<ul>
<li>Fit statistics indicate an overall/average model fit</li>
<li>That means there can be bad sections, but the overall fit is
good</li>
<li>No one magical number/summary</li>
<li>They do not tell you where a misspecification occurs</li>
<li>Do not tell you the predictive value of a model</li>
<li>Do not tell you if it’s theoretically meaningful</li>
</ul>
</div>
<div class="section level2">
<h2 id="rules">“Rules”<a class="anchor" aria-label="anchor" href="#rules"></a>
</h2>
<ul>
<li>Everyone cites Hu and Bentler (1999) for the golden standards.</li>
<li>Practically, these rules represent the same problems as rules about
<em>p</em> values and effect sizes</li>
<li>Generally the rules fall into two categories:
<ul>
<li>Goodness of fit statistics: want values close to 1
<ul>
<li>Excellent &gt; .95, Good &gt; .90</li>
</ul>
</li>
<li>Badness of fit statistics: want values close to 0
<ul>
<li>Excellent &lt; .06, Good &lt; .08, Acceptable &lt; .10</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-test-statistic">Model Test Statistic<a class="anchor" aria-label="anchor" href="#model-test-statistic"></a>
</h2>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math></li>
<li>Examines if the reproduced correlation matrix matches the sample
correlation matrix</li>
<li>Sometimes called “badness of fit”</li>
<li>You want this value to be small as it measures the “mismatch” or
error</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-test-statistic-1">Model Test Statistic<a class="anchor" aria-label="anchor" href="#model-test-statistic-1"></a>
</h2>
<ul>
<li>Traditional null hypothesis testing reject-support context
<ul>
<li>Generally, we <em>reject</em> the null to show that it’s unlikely,
and therefore, the research hypothesis is likely</li>
<li>However, here we want to support that the model represents the data,
which is predicting the null</li>
<li>So, it’s an odd use of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
to “support” the null</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-test-statistic-2">Model Test Statistic<a class="anchor" aria-label="anchor" href="#model-test-statistic-2"></a>
</h2>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mi>F</mi><mi>M</mi><mi>L</mi></mrow><annotation encoding="application/x-tex">\chi^2 = (N-1) \times FML</annotation></semantics></math><ul>
<li>FML is the minimum fit function in maximum likelihood
estimation</li>
<li>
<em>p</em> values are based on the df for your model and the
chi-square distribution</li>
<li>You want this value to be non-significant (minus the issues of
predicting the null)</li>
<li>However, this non-significance is problematic!</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-test-statistic-3">Model Test Statistic<a class="anchor" aria-label="anchor" href="#model-test-statistic-3"></a>
</h2>
<ul>
<li>Chi-square is biased by:
<ul>
<li>Multivariate non-normality</li>
<li>Correlation size - large correlations can be hard to estimate</li>
<li>Unique variance</li>
<li>Sample size <strong>this is the big one</strong>
</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-test-statistic-4">Model Test Statistic<a class="anchor" aria-label="anchor" href="#model-test-statistic-4"></a>
</h2>
<ul>
<li>Everyone reports chi-square, but people tend to ignore significant
values
<ul>
<li>One suggestion was normed chi-square
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><msup><mi>χ</mi><mn>2</mn></msup><mrow><mi>d</mi><mi>f</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{\chi^2}{df}</annotation></semantics></math>
- however, it is known to be just as problematic</li>
</ul>
</li>
<li>Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
is biased, you could use a robust estimator to correct for bias
<ul>
<li>Satorra-Bentler</li>
<li>Yuan-Bentler</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="alternative-fit-indices">Alternative Fit Indices<a class="anchor" aria-label="anchor" href="#alternative-fit-indices"></a>
</h2>
<ul>
<li>There are three types of models:
<ul>
<li>Your Model</li>
<li>Independence - a model assuming no relationships between the
variables (i.e., parameters are not significant)</li>
<li>Saturated - a model assuming all parameters exist (i.e., df =
0).<br>
</li>
</ul>
</li>
<li>We can use a ratio of your model compared to these other possible
models as a way to determine fit.</li>
<li>These are less black and white, until we apply the “rules”</li>
<li>It’s easy to “cherry-pick” the best indices to support your
model</li>
</ul>
</div>
<div class="section level2">
<h2 id="alternative-fit-indices-1">Alternative Fit Indices<a class="anchor" aria-label="anchor" href="#alternative-fit-indices-1"></a>
</h2>
<ul>
<li>Absolute Fit Indices</li>
<li>Incremental Fit Indices</li>
<li>Parsimony-adjusted Indices</li>
<li>Predictive Fit Indices</li>
</ul>
</div>
<div class="section level2">
<h2 id="absolute-fit-indices">Absolute fit indices<a class="anchor" aria-label="anchor" href="#absolute-fit-indices"></a>
</h2>
<ul>
<li>Proportion of the covariance matrix explained by the model</li>
<li>You can think about these as sort of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
</li>
<li>Want these values be high</li>
<li>Goodness of Fit Index (GFI), Adjusted Goodness of Fit Index (AGFI),
Parsimonious Goodness of Fit Index (PGFI)
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mfrac><msub><mi>V</mi><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>i</mi><mi>d</mi><mi>u</mi><mi>a</mi><mi>l</mi></mrow></msub><msub><mi>V</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub></mfrac></mrow><annotation encoding="application/x-tex">1 - \frac{V_{residual}}{V_{total}}</annotation></semantics></math></li>
<li>Where residual is the variance not explained by the model, total is
the total amount of variance</li>
</ul>
</li>
<li>Research indicates these are positively biased, and they are not
recommended for use</li>
</ul>
</div>
<div class="section level2">
<h2 id="absolute-fit-indices-1">Absolute Fit Indices<a class="anchor" aria-label="anchor" href="#absolute-fit-indices-1"></a>
</h2>
<ul>
<li>Standardized root mean residual (SRMR)</li>
<li>Want small values, as it’s a badness of fit index</li>
</ul>
<p><img src="pictures%2Fsrmr_formula.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="incremental-fit-indices">Incremental Fit Indices<a class="anchor" aria-label="anchor" href="#incremental-fit-indices"></a>
</h2>
<ul>
<li>Also known as comparative fit indices
<ul>
<li>Values are to 0 to 1, want high values</li>
</ul>
</li>
<li>Your model compared to the improvement over the independence model
(no relationships)</li>
<li>Comparative Fit Index (CFI)
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><msubsup><mi>χ</mi><mi>M</mi><mn>2</mn></msubsup><mo>−</mo><mi>d</mi><msub><mi>f</mi><mi>M</mi></msub></mrow><mrow><msubsup><mi>χ</mi><mi>B</mi><mn>2</mn></msubsup><mo>−</mo><mi>d</mi><msub><mi>f</mi><mi>B</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">1 - \frac{\chi^2_{M} - df_{M}}{\chi^2_{B} - df_{B}}</annotation></semantics></math></li>
</ul>
</li>
<li>Normed Fit Index (NFI)
<ul>
<li>A variation of the CFI, as it was said to underestimate for small
samples</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mfrac><msubsup><mi>χ</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup><msubsup><mi>χ</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow><mn>2</mn></msubsup></mfrac></mrow><annotation encoding="application/x-tex">1 - \frac{\chi^2_{model}}{\chi^2_{baseline}}</annotation></semantics></math></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="incremental-fit-indices-1">Incremental Fit Indices<a class="anchor" aria-label="anchor" href="#incremental-fit-indices-1"></a>
</h2>
<ul>
<li>Incremental Fit Index (IFI)
<ul>
<li>Also known as Bollen’s Non-normed fit index</li>
<li>Modified NFI that decreases emphasis on sample size</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><msubsup><mi>χ</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow><mn>2</mn></msubsup><mo>−</mo><msubsup><mi>χ</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup></mrow><mrow><msubsup><mi>χ</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow><mn>2</mn></msubsup><mo>−</mo><mi>d</mi><msub><mi>f</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></mfrac><annotation encoding="application/x-tex">\frac{\chi^2_{baseline} - \chi^2_{model}}{\chi^2_{baseline} - df_{model}}</annotation></semantics></math></li>
</ul>
</li>
<li>Relative Fit Index (RFI)
<ul>
<li>Also known as Bollen’s Normed Fit Index</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mfrac><msubsup><mi>χ</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup><mrow><mi>d</mi><msub><mi>f</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></mfrac><mfrac><msubsup><mi>χ</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow><mn>2</mn></msubsup><mrow><mi>d</mi><msub><mi>f</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow></msub></mrow></mfrac></mfrac><annotation encoding="application/x-tex">\frac{\frac{\chi^2_{model}}{df_{model}}}{\frac{\chi^2_{baseline}}{df_{baseline}}}</annotation></semantics></math></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="incremental-fit-indices-2">Incremental Fit Indices<a class="anchor" aria-label="anchor" href="#incremental-fit-indices-2"></a>
</h2>
<ul>
<li>Tucker Lewis Index (TLI)
<ul>
<li>Also known as the Bentler-Bonet Non-Normed Fit Index</li>
<li>A popular fit index</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mfrac><msubsup><mi>χ</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow><mn>2</mn></msubsup><mrow><mi>d</mi><msub><mi>f</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow></msub></mrow></mfrac><mo>−</mo><mfrac><msubsup><mi>χ</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow><mn>2</mn></msubsup><mrow><mi>d</mi><msub><mi>f</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></mfrac></mrow><mrow><mfrac><msubsup><mi>χ</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow><mn>2</mn></msubsup><mrow><mi>d</mi><msub><mi>f</mi><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi></mrow></msub></mrow></mfrac><mo>−</mo><mn>1</mn></mrow></mfrac><annotation encoding="application/x-tex">\frac{\frac{\chi^2_{baseline}}{df_{baseline}} - \frac{\chi^2_{model}}{df_{model}}}{\frac{\chi^2_{baseline}}{df_{baseline}} - 1}</annotation></semantics></math></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="parsimony-adjusted-indices">Parsimony Adjusted Indices<a class="anchor" aria-label="anchor" href="#parsimony-adjusted-indices"></a>
</h2>
<ul>
<li>These include penalties for model complexity because added paths
often result in better fit (overfitting)</li>
<li>These will have smaller values for simpler models</li>
<li>Root mean squared error of approximation (RMSEA)
<ul>
<li>The <strong>most</strong> popular index</li>
<li>Report the confidence interval</li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><msqrt><mrow><msup><mi>χ</mi><mn>2</mn></msup><mo>−</mo><mi>d</mi><msub><mi>f</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub></mrow></msqrt><msqrt><mrow><mi>d</mi><msub><mi>f</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msqrt></mfrac><annotation encoding="application/x-tex">\frac{\sqrt{\chi^2 - df_{model}}}{\sqrt{df_{model}\times(N - 1)}}</annotation></semantics></math></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="predictive-fit-indices">Predictive Fit Indices<a class="anchor" aria-label="anchor" href="#predictive-fit-indices"></a>
</h2>
<ul>
<li>Estimate model fit in a hypothetical replication of the study with
the same sample size randomly drawn from the population</li>
<li>Most often used for model comparisons, rather than “fit”</li>
<li>Often also considered parsimony adjusted indices</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-comparisons">Model Comparisons<a class="anchor" aria-label="anchor" href="#model-comparisons"></a>
</h2>
<ul>
<li>Let’s say you want to adjust your model
<ul>
<li>You can compare the adjusted model to the original model to
determine if the adjustment is better</li>
</ul>
</li>
<li>Let’s say you want to compare two different models
<ul>
<li>You can compare their fits to see which is better</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-comparisons-1">Model Comparisons<a class="anchor" aria-label="anchor" href="#model-comparisons-1"></a>
</h2>
<ul>
<li>Nested models
<ul>
<li>If you can create one model from another by the addition or
subtraction of parameters, then it is nested</li>
<li>Model A is said to be nested within Model B, if Model B is a more
complicated version of Model A</li>
<li>For example, a one-factor model is nested within a two-factor as a
one-factor model can be viewed as a two-factor model in which the
correlation between factors is perfect</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-comparisons-nested-models">Model Comparisons Nested Models<a class="anchor" aria-label="anchor" href="#model-comparisons-nested-models"></a>
</h2>
<ul>
<li>Chi-square difference test - is this difference in models
significant?</li>
<li>If yes, you say the model with the lower chi-square is better</li>
<li>If no, you say they are the same and go with the simpler model</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chi_difference</span> <span class="op">&lt;-</span> <span class="fl">12.6</span> <span class="op">-</span> <span class="fl">4.3</span></span>
<span><span class="va">df_difference</span> <span class="op">&lt;-</span> <span class="fl">14</span> <span class="op">-</span> <span class="fl">12</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">chi_difference</span>, <span class="va">df_difference</span>, lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.01576442</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-comparisons-nested-models-1">Model Comparisons Nested Models<a class="anchor" aria-label="anchor" href="#model-comparisons-nested-models-1"></a>
</h2>
<ul>
<li>CFI difference test</li>
<li>Subtract CFI model 1 - CFI model 2</li>
<li>If the change is more than .01, then the models are considered
different</li>
<li>This version is not biased by sample size issues with
chi-square</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-comparisons-nested-models-2">Model Comparisons Nested Models<a class="anchor" aria-label="anchor" href="#model-comparisons-nested-models-2"></a>
</h2>
<ul>
<li>So how can I tell what to change?</li>
<li>Just change one thing at a time!</li>
<li>Modification indices
<ul>
<li>Tell you what the chi-square change would be if you added the path
suggested</li>
<li>Based on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\chi^2(1)</annotation></semantics></math>
(Lagrange Multiplier)</li>
<li>Anything with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>χ</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\chi^2(1)</annotation></semantics></math>
&gt; 3.84 is <em>p</em> &lt; .05</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-comparisons-nested-models-3">Model Comparisons Nested Models<a class="anchor" aria-label="anchor" href="#model-comparisons-nested-models-3"></a>
</h2>
<ul>
<li>Instead of doing the math, you can use the <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova()</a></code>
function</li>
<li><code>anova(model1.fit, model2.fit)</code></li>
</ul>
</div>
<div class="section level2">
<h2 id="model-comparisons-non-nested-models">Model Comparisons Non-Nested Models<a class="anchor" aria-label="anchor" href="#model-comparisons-non-nested-models"></a>
</h2>
<ul>
<li>Akaike Information Criterion (AIC)</li>
<li>Bayesian Information Criterion (BIC)</li>
<li>Sample size Adjusted Information Criterion (SABIC)
<ul>
<li>All of these penalize you for having more complex models.</li>
<li>If all other things are equal, it is biased to the simpler
model.</li>
</ul>
</li>
<li>To compare, pick the model with the lower value (always lower, even
when negative)</li>
</ul>
</div>
<div class="section level2">
<h2 id="model-comparisons-non-nested-models-1">Model Comparisons Non-Nested Models<a class="anchor" aria-label="anchor" href="#model-comparisons-non-nested-models-1"></a>
</h2>
<ul>
<li>Expected Cross Validation Index (ECVI)
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mi>M</mi><mi>L</mi><mo>+</mo><mfrac><mrow><mn>2</mn><mo>×</mo><mi>t</mi></mrow><mrow><mi>N</mi><mo>−</mo><mi>p</mi><mo>−</mo><mn>2</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">FML + \frac{2\times t}{N - p - 2}</annotation></semantics></math></li>
<li>t is the number of parameters estimated</li>
<li>p is the number of squares (measured variables)</li>
</ul>
</li>
<li>Same rules, pick the smallest value</li>
</ul>
</div>
<div class="section level2">
<h2 id="so-what-to-report">So what to report?<a class="anchor" aria-label="anchor" href="#so-what-to-report"></a>
</h2>
<ul>
<li>We will use RMSEA, SRMR, CFI</li>
<li>Generally, people also report chi-square and df</li>
<li>Determine the type of model change to use the right model comparison
statistic</li>
</ul>
</div>
<div class="section level2">
<h2 id="path-comparison-example">Path Comparison Example<a class="anchor" aria-label="anchor" href="#path-comparison-example"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lav_matrix.html" class="external-link">lav_matrix_lower2full</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.00</span>,</span>
<span>                                        <span class="fl">.53</span>,    <span class="fl">1.00</span>,   </span>
<span>                                        <span class="fl">.15</span>,    <span class="fl">.18</span>,    <span class="fl">1.00</span>,       </span>
<span>                                        <span class="fl">.52</span>,    <span class="fl">.29</span>,    <span class="op">-</span><span class="fl">.05</span>,   <span class="fl">1.00</span>,   </span>
<span>                                        <span class="fl">.30</span>,    <span class="fl">.34</span>,    <span class="fl">.23</span>,    <span class="fl">.09</span>,    <span class="fl">1.00</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">compare.data</span><span class="op">)</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">compare.data</span><span class="op">)</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"morale"</span>, <span class="st">"illness"</span>, <span class="st">"neuro"</span>, <span class="st">"relationship"</span>, <span class="st">"SES"</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="build-a-model">Build a Model<a class="anchor" aria-label="anchor" href="#build-a-model"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#model 1</span></span>
<span><span class="va">compare.model1</span> <span class="op">=</span> <span class="st">'</span></span>
<span><span class="st">illness ~ morale</span></span>
<span><span class="st">relationship ~ morale</span></span>
<span><span class="st">morale ~ SES + neuro</span></span>
<span><span class="st">'</span></span>
<span></span>
<span><span class="co">#model 2</span></span>
<span><span class="va">compare.model2</span> <span class="op">=</span> <span class="st">'</span></span>
<span><span class="st">SES ~ illness + neuro</span></span>
<span><span class="st">morale ~ SES + illness</span></span>
<span><span class="st">relationship ~ morale + neuro</span></span>
<span><span class="st">'</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyze-the-model-2">Analyze the Model<a class="anchor" aria-label="anchor" href="#analyze-the-model-2"></a>
</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare.model1.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">compare.model1</span>, </span>
<span>                          sample.cov <span class="op">=</span> <span class="va">compare.data</span>, </span>
<span>                          sample.nobs <span class="op">=</span> <span class="fl">469</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">compare.model1.fit</span>, </span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        fit.measures <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 5 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           469</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                40.303</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 4</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                               390.816</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 9</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.905</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.786</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)              -1819.689</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -1799.537</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                3655.377</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                              3688.582</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)       3663.192</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.139</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.102</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.180</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.995</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.065</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   illness ~                                                             </span></span>
<span><span class="co">#&gt;     morale            0.530    0.039   13.535    0.000    0.530    0.530</span></span>
<span><span class="co">#&gt;   relationship ~                                                        </span></span>
<span><span class="co">#&gt;     morale            0.520    0.039   13.184    0.000    0.520    0.520</span></span>
<span><span class="co">#&gt;   morale ~                                                              </span></span>
<span><span class="co">#&gt;     SES               0.280    0.045    6.217    0.000    0.280    0.280</span></span>
<span><span class="co">#&gt;     neuro             0.086    0.045    1.897    0.058    0.086    0.086</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;  .illness ~~                                                            </span></span>
<span><span class="co">#&gt;    .relationship      0.014    0.033    0.430    0.667    0.014    0.020</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .illness           0.718    0.047   15.313    0.000    0.718    0.719</span></span>
<span><span class="co">#&gt;    .relationship      0.728    0.048   15.313    0.000    0.728    0.730</span></span>
<span><span class="co">#&gt;    .morale            0.901    0.059   15.313    0.000    0.901    0.903</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     illness           0.281</span></span>
<span><span class="co">#&gt;     relationship      0.270</span></span>
<span><span class="co">#&gt;     morale            0.097</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analyze-the-model-3">Analyze the Model<a class="anchor" aria-label="anchor" href="#analyze-the-model-3"></a>
</h2>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compare.model2.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">compare.model2</span>, </span>
<span>                          sample.cov <span class="op">=</span> <span class="va">compare.data</span>, </span>
<span>                          sample.nobs <span class="op">=</span> <span class="fl">469</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">compare.model2.fit</span>, </span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        fit.measures <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           469</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 3.245</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 3</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.355</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                               400.859</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 9</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.999</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.998</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)              -1796.138</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -1794.516</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                3610.276</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                              3647.632</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)       3619.068</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.013</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.000</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.080</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.742</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    0.050</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.016</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   SES ~                                                                 </span></span>
<span><span class="co">#&gt;     illness           0.309    0.043    7.110    0.000    0.309    0.309</span></span>
<span><span class="co">#&gt;     neuro             0.174    0.043    4.019    0.000    0.174    0.174</span></span>
<span><span class="co">#&gt;   morale ~                                                              </span></span>
<span><span class="co">#&gt;     SES               0.135    0.041    3.291    0.001    0.135    0.135</span></span>
<span><span class="co">#&gt;     illness           0.484    0.041   11.756    0.000    0.484    0.484</span></span>
<span><span class="co">#&gt;   relationship ~                                                        </span></span>
<span><span class="co">#&gt;     morale            0.540    0.039   13.745    0.000    0.540    0.538</span></span>
<span><span class="co">#&gt;     neuro            -0.131    0.039   -3.335    0.001   -0.131   -0.131</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .SES               0.853    0.056   15.313    0.000    0.853    0.855</span></span>
<span><span class="co">#&gt;    .morale            0.701    0.046   15.313    0.000    0.701    0.703</span></span>
<span><span class="co">#&gt;    .relationship      0.711    0.046   15.313    0.000    0.711    0.710</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     SES               0.145</span></span>
<span><span class="co">#&gt;     morale            0.297</span></span>
<span><span class="co">#&gt;     relationship      0.290</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="view-the-model">View the Model<a class="anchor" aria-label="anchor" href="#view-the-model"></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html" class="external-link">semPaths</a></span><span class="op">(</span><span class="va">compare.model1.fit</span>, </span>
<span>         whatLabels<span class="op">=</span><span class="st">"par"</span>, </span>
<span>         edge.label.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         layout<span class="op">=</span><span class="st">"spring"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_path_files/figure-html/unnamed-chunk-29-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html" class="external-link">semPaths</a></span><span class="op">(</span><span class="va">compare.model2.fit</span>, </span>
<span>         whatLabels<span class="op">=</span><span class="st">"par"</span>, </span>
<span>         edge.label.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>         layout<span class="op">=</span><span class="st">"spring"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_path_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="compare-the-models">Compare the Models<a class="anchor" aria-label="anchor" href="#compare-the-models"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">compare.model1.fit</span>, <span class="va">compare.model2.fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chi-Squared Difference Test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    Df    AIC    BIC   Chisq Chisq diff   RMSEA Df diff</span></span>
<span><span class="co">#&gt; compare.model2.fit  3 3610.3 3647.6  3.2454                           </span></span>
<span><span class="co">#&gt; compare.model1.fit  4 3655.4 3688.6 40.3031     37.058 0.27728       1</span></span>
<span><span class="co">#&gt;                    Pr(&gt;Chisq)    </span></span>
<span><span class="co">#&gt; compare.model2.fit               </span></span>
<span><span class="co">#&gt; compare.model1.fit  1.147e-09 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">compare.model1.fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aic"</span>, <span class="st">"ecvi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      aic     ecvi </span></span>
<span><span class="co">#&gt; 3655.377    0.120</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">fitmeasures</a></span><span class="op">(</span><span class="va">compare.model2.fit</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aic"</span>, <span class="st">"ecvi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      aic     ecvi </span></span>
<span><span class="co">#&gt; 3610.276    0.045</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<ul>
<li>
<p>In this lecture you’ve learned:</p>
<ul>
<li>How to write basic lavaan model syntax</li>
<li>How to analyze a path model</li>
<li>How to summarize a path model</li>
<li>How to create sem pictures</li>
<li>Estimation and fit indices</li>
</ul>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Erin M. Buchanan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
