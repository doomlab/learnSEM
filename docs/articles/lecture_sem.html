<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Full SEM • learnSEM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Full SEM">
<meta name="description" content="This vignette includes the lecture slides for a fully latent analysis for SEM (part 8).
">
<meta property="og:description" content="This vignette includes the lecture slides for a fully latent analysis for SEM (part 8).
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">learnSEM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lecture_cfa.html">CFA: Basics</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_data_screen.html">Data Screening</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_efa.html">Exploratory Factor Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_introR.html">Introduction to R</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_irt.html">Item Response Theory</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_lgm.html">Latent Growth Models</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_mgcfa.html">Multi-Group Confirmatory Factor Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_mtmm.html">Multi-Trait Multi-Method</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_path.html">Path Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_secondcfa.html">Confirmatory Factor Analysis: Second Order</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_sem.html">Full SEM</a></li>
    <li><a class="dropdown-item" href="../articles/lecture_terms.html">Terms and Concepts</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Full SEM</h1>
            
      

      <div class="d-none name"><code>lecture_sem.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="full-structural-models">Full Structural Models<a class="anchor" aria-label="anchor" href="#full-structural-models"></a>
</h2>
<ul>
<li>
<p>A fully latent or full structural model has two parts:</p>
<ul>
<li>Measurement model: the latent variable with it’s measured variables
(CFA)</li>
<li>Structural model: the relationship between other variables and the
measurement model</li>
</ul>
</li>
<li><p>The structural model may be a second order latent, like we did
last week</p></li>
<li><p>The structural model could include other predictors</p></li>
<li><p>Or you could simply convert from correlations to a specific
prediction direction as part of your structural model</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="example-model">Example Model<a class="anchor" aria-label="anchor" href="#example-model"></a>
</h2>
<p><img src="pictures%2Ffull_sem2.png" width="75%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="full-structural-models-1">Full Structural Models<a class="anchor" aria-label="anchor" href="#full-structural-models-1"></a>
</h2>
<ul>
<li>
<p>A reminder from earlier this semester:</p>
<ul>
<li>Reflective indicators: we assume the latent variables are the cause,
so they are exogenous</li>
<li>Formative indicators: we assume the latent variables are the
criterion, so they are endogenous</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="full-structural-models-2">Full Structural Models<a class="anchor" aria-label="anchor" href="#full-structural-models-2"></a>
</h2>
<ul>
<li>
<p>Example of formative indicator</p>
<ul>
<li>Income, education level, and occupation all predict your SES</li>
<li>Stress caused by outside factors</li>
</ul>
</li>
<li>
<p>Other names people use for these:</p>
<ul>
<li>Composite causes</li>
<li>MIMIC – multiple indicators, multiple causes models</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="example-model-1">Example Model<a class="anchor" aria-label="anchor" href="#example-model-1"></a>
</h2>
<p><img src="pictures%2Findicators.png" width="75%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="identification">Identification<a class="anchor" aria-label="anchor" href="#identification"></a>
</h2>
<ul>
<li>
<p>Identification rules of thumb:</p>
<ul>
<li>Latent variables should have four indicators</li>
<li>Latent variables have three indicators AND Error variances do not
covary</li>
<li>Latent variables have two indicators AND Error variances do not
covary and Loadings are set to equal each other.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="structural-model-identification">Structural Model Identification<a class="anchor" aria-label="anchor" href="#structural-model-identification"></a>
</h2>
<ul>
<li><p>Scaling is also required to identify the structural part</p></li>
<li>
<p>2+ emitted paths rule</p>
<ul>
<li>Composite variable must have direct effects on two other endogenous
variables</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="things-to-consider">Things to Consider<a class="anchor" aria-label="anchor" href="#things-to-consider"></a>
</h2>
<ul>
<li>
<p>Parceling</p>
<ul>
<li>When you have large structural models, they can be very complex to
fit to a Full SEM if each latent variable has lots of indicators
(items).</li>
<li>Parceling occurs when you create subsets of items to be able to get
the model to run and to balance out the number of indicators on each
latent.</li>
<li>At the moment, this topic is still pretty controversial.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="how-to-model">How to Model<a class="anchor" aria-label="anchor" href="#how-to-model"></a>
</h2>
<ul>
<li>
<p>Test each CFA piece separately to make sure they run.</p>
<ul>
<li>CFAs that are bad, do not suddenly make good models when the
structural component is added!</li>
</ul>
</li>
<li>
<p>Slowly add structural paths to see if you can get the full model
to work.</p>
<ul>
<li>If not, try parceling.</li>
<li>Drop non-significant paths.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="how-to-model-1">How to Model<a class="anchor" aria-label="anchor" href="#how-to-model-1"></a>
</h2>
<ul>
<li>
<p>As you add the structural components, you should not see a big
change in the loadings to the indicators</p>
<ul>
<li>If you do, it means the model is not invariant</li>
<li>Causes interpretation difficulties</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="when-to-stop">When to Stop?<a class="anchor" aria-label="anchor" href="#when-to-stop"></a>
</h2>
<ul>
<li><p>We have discussed using <code><a href="https://rdrr.io/pkg/lavaan/man/modificationIndices.html" class="external-link">modificationindices()</a></code> and
other tricks to improve model fit</p></li>
<li><p>In theory, we could add all paths until the model is
“perfect”</p></li>
<li>
<p>What should the stopping rule be?</p>
<ul>
<li>Based on theory</li>
<li>Fit indices do not greatly improve</li>
<li>Parsimony</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="example-model-2">Example Model<a class="anchor" aria-label="anchor" href="#example-model-2"></a>
</h2>
<p><img src="pictures%2Fkline_model.png" width="75%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="example-model-setup">Example Model: Setup<a class="anchor" aria-label="anchor" href="#example-model-setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SachaEpskamp/semPlot" class="external-link">semPlot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">family.cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lav_matrix.html" class="external-link">lav_matrix_lower2full</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.00</span>, </span>
<span>                                      <span class="fl">.74</span>,  <span class="fl">1.00</span>,   </span>
<span>                                      <span class="fl">.27</span>,  <span class="fl">.42</span>,    <span class="fl">1.00</span>,   </span>
<span>                                      <span class="fl">.31</span>,  <span class="fl">.40</span>,    <span class="fl">.79</span>,    <span class="fl">1.00</span>,   </span>
<span>                                      <span class="fl">.32</span>,  <span class="fl">.35</span>,    <span class="fl">.66</span>,    <span class="fl">.59</span>,    <span class="fl">1.00</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">family.sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">32.94</span>,   <span class="fl">22.75</span>, <span class="fl">13.39</span>,   <span class="fl">13.68</span>,  <span class="fl">14.38</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">family.cor</span><span class="op">)</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">family.cor</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">family.sd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"father"</span>, <span class="st">"mother"</span>, <span class="st">"famo"</span>, <span class="st">"problems"</span>, <span class="st">"intimacy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">family.cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/getCov.html" class="external-link">cor2cov</a></span><span class="op">(</span><span class="va">family.cor</span>, <span class="va">family.sd</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-build-the-cfa">Example Model: Build the CFA<a class="anchor" aria-label="anchor" href="#example-model-build-the-cfa"></a>
</h2>
<ul>
<li>First, we are going to test the measurement model – just the CFAs
with a covariance between them.</li>
<li>Then, we are going to change it to a full SEM, predicting the
direction of the relationship between latents.</li>
<li>We should ensure the measurement model does not change
significantly.</li>
</ul>
</div>
<div class="section level2">
<h2 id="example-model-build-the-cfa-1">Example Model: Build the CFA<a class="anchor" aria-label="anchor" href="#example-model-build-the-cfa-1"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">family.model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">adjust =~ problems + intimacy</span></span>
<span><span class="st">family =~ father + mother + famo'</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-analyze-the-cfa">Example Model: Analyze the CFA<a class="anchor" aria-label="anchor" href="#example-model-analyze-the-cfa"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">family.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">family.model</span>,</span>
<span>                  sample.cov <span class="op">=</span> <span class="va">family.cov</span>,</span>
<span>                  sample.nobs <span class="op">=</span> <span class="fl">203</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: lavaan-&gt;lav_object_post_check():  </span></span>
<span><span class="co">#&gt;    covariance matrix of latent variables is not positive definite ; use </span></span>
<span><span class="co">#&gt;    lavInspect(fit, "cov.lv") to investigate.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-deal-with-error">Example Model: Deal with Error<a class="anchor" aria-label="anchor" href="#example-model-deal-with-error"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">inspect</a></span><span class="op">(</span><span class="va">family.fit</span>, <span class="st">"cov.lv"</span><span class="op">)</span></span>
<span><span class="co">#&gt;         adjust  family</span></span>
<span><span class="co">#&gt; adjust 129.870        </span></span>
<span><span class="co">#&gt; family 152.798 160.332</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">inspect</a></span><span class="op">(</span><span class="va">family.fit</span>, <span class="st">"cor.lv"</span><span class="op">)</span></span>
<span><span class="co">#&gt;        adjust family</span></span>
<span><span class="co">#&gt; adjust  1.000       </span></span>
<span><span class="co">#&gt; family  1.059  1.000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-analyze-the-cfa-1">Example Model: Analyze the CFA<a class="anchor" aria-label="anchor" href="#example-model-analyze-the-cfa-1"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">family.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">family.model</span>,</span>
<span>                  sample.cov <span class="op">=</span> <span class="va">family.cor</span>,</span>
<span>                  sample.nobs <span class="op">=</span> <span class="fl">203</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-summarize-the-model">Example Model: Summarize the Model<a class="anchor" aria-label="anchor" href="#example-model-summarize-the-model"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">family.fit</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 23 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           203</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               197.939</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 4</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                               533.051</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                10</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.629</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.073</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)              -1270.160</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -1171.191</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                2562.321</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                              2598.766</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)       2563.915</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.489</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.432</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.548</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.186</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   adjust =~                                                             </span></span>
<span><span class="co">#&gt;     problems          1.000                               0.807    0.809</span></span>
<span><span class="co">#&gt;     intimacy          0.901    0.134    6.741    0.000    0.727    0.729</span></span>
<span><span class="co">#&gt;   family =~                                                             </span></span>
<span><span class="co">#&gt;     father            1.000                               0.789    0.790</span></span>
<span><span class="co">#&gt;     mother            1.143    0.112   10.165    0.000    0.901    0.903</span></span>
<span><span class="co">#&gt;     famo              0.630    0.092    6.847    0.000    0.497    0.498</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   adjust ~~                                                             </span></span>
<span><span class="co">#&gt;     family            0.384    0.071    5.441    0.000    0.604    0.604</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .problems          0.344    0.092    3.720    0.000    0.344    0.345</span></span>
<span><span class="co">#&gt;    .intimacy          0.466    0.084    5.571    0.000    0.466    0.468</span></span>
<span><span class="co">#&gt;    .father            0.373    0.062    6.035    0.000    0.373    0.375</span></span>
<span><span class="co">#&gt;    .mother            0.183    0.066    2.758    0.006    0.183    0.184</span></span>
<span><span class="co">#&gt;    .famo              0.748    0.079    9.530    0.000    0.748    0.752</span></span>
<span><span class="co">#&gt;     adjust            0.651    0.126    5.157    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt;     family            0.622    0.104    5.974    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     problems          0.655</span></span>
<span><span class="co">#&gt;     intimacy          0.532</span></span>
<span><span class="co">#&gt;     father            0.625</span></span>
<span><span class="co">#&gt;     mother            0.816</span></span>
<span><span class="co">#&gt;     famo              0.248</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-improve-the-model">Example Model: Improve the Model?<a class="anchor" aria-label="anchor" href="#example-model-improve-the-model"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/modificationIndices.html" class="external-link">modificationindices</a></span><span class="op">(</span><span class="va">family.fit</span>, sort <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt;         lhs op    rhs      mi    epc sepc.lv sepc.all sepc.nox</span></span>
<span><span class="co">#&gt; 16   adjust =~   famo 136.963  1.467   1.184    1.187    1.187</span></span>
<span><span class="co">#&gt; 26   father ~~ mother 136.963  1.785   1.785    6.825    6.825</span></span>
<span><span class="co">#&gt; 22 problems ~~   famo  58.596  0.371   0.371    0.732    0.732</span></span>
<span><span class="co">#&gt; 27   father ~~   famo  25.310 -0.283  -0.283   -0.536   -0.536</span></span>
<span><span class="co">#&gt; 15   adjust =~ mother  25.310 -0.767  -0.619   -0.621   -0.621</span></span>
<span><span class="co">#&gt; 25 intimacy ~~   famo  13.685  0.183   0.183    0.310    0.310</span></span>
<span><span class="co">#&gt; 14   adjust =~ father   7.800 -0.370  -0.299   -0.299   -0.299</span></span>
<span><span class="co">#&gt; 28   mother ~~   famo   7.800 -0.179  -0.179   -0.482   -0.482</span></span>
<span><span class="co">#&gt; 20 problems ~~ father   6.001 -0.103  -0.103   -0.287   -0.287</span></span>
<span><span class="co">#&gt; 24 intimacy ~~ mother   4.674 -0.096  -0.096   -0.329   -0.329</span></span>
<span><span class="co">#&gt; 21 problems ~~ mother   2.723 -0.076  -0.076   -0.302   -0.302</span></span>
<span><span class="co">#&gt; 23 intimacy ~~ father   0.117  0.014   0.014    0.034    0.034</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-improve-the-model-1">Example Model: Improve the Model?<a class="anchor" aria-label="anchor" href="#example-model-improve-the-model-1"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">family.model2</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">adjust =~ problems + intimacy</span></span>
<span><span class="st">family =~ father + mother + famo</span></span>
<span><span class="st">father ~~ mother'</span></span>
<span></span>
<span><span class="va">family.fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">cfa</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">family.model2</span>,</span>
<span>                  sample.cov <span class="op">=</span> <span class="va">family.cov</span>,</span>
<span>                  sample.nobs <span class="op">=</span> <span class="fl">203</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: lavaan-&gt;lav_object_post_check():  </span></span>
<span><span class="co">#&gt;    covariance matrix of latent variables is not positive definite ; use </span></span>
<span><span class="co">#&gt;    lavInspect(fit, "cov.lv") to investigate.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">inspect</a></span><span class="op">(</span><span class="va">family.fit2</span>, <span class="st">"cor.lv"</span><span class="op">)</span></span>
<span><span class="co">#&gt;        adjust family</span></span>
<span><span class="co">#&gt; adjust  1.000       </span></span>
<span><span class="co">#&gt; family  1.038  1.000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-diagram-the-model">Example Model: Diagram the Model<a class="anchor" aria-label="anchor" href="#example-model-diagram-the-model"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html" class="external-link">semPaths</a></span><span class="op">(</span><span class="va">family.fit</span>, </span>
<span>         whatLabels<span class="op">=</span><span class="st">"std"</span>, </span>
<span>         layout<span class="op">=</span><span class="st">"tree"</span>, </span>
<span>         edge.label.cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_sem_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="example-model-build-full-sem">Example Model: Build Full SEM<a class="anchor" aria-label="anchor" href="#example-model-build-full-sem"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict.model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">adjust =~ problems + intimacy</span></span>
<span><span class="st">family =~ father + mother + famo</span></span>
<span><span class="st">adjust~family'</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-analyze-full-sem">Example Model: Analyze Full SEM<a class="anchor" aria-label="anchor" href="#example-model-analyze-full-sem"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predict.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">predict.model</span>,</span>
<span>                   sample.cov <span class="op">=</span> <span class="va">family.cor</span>,</span>
<span>                   sample.nobs <span class="op">=</span> <span class="fl">203</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-summarize-full-sem">Example Model: Summarize Full SEM<a class="anchor" aria-label="anchor" href="#example-model-summarize-full-sem"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">predict.fit</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 20 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           203</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                               197.939</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 4</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                               533.051</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                10</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.629</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.073</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)              -1270.160</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -1171.191</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                2562.321</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                              2598.766</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)       2563.915</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.489</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.432</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.548</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.186</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   adjust =~                                                             </span></span>
<span><span class="co">#&gt;     problems          1.000                               0.807    0.809</span></span>
<span><span class="co">#&gt;     intimacy          0.901    0.134    6.741    0.000    0.727    0.729</span></span>
<span><span class="co">#&gt;   family =~                                                             </span></span>
<span><span class="co">#&gt;     father            1.000                               0.789    0.790</span></span>
<span><span class="co">#&gt;     mother            1.143    0.112   10.165    0.000    0.901    0.903</span></span>
<span><span class="co">#&gt;     famo              0.630    0.092    6.847    0.000    0.497    0.498</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   adjust ~                                                              </span></span>
<span><span class="co">#&gt;     family            0.618    0.092    6.705    0.000    0.604    0.604</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .problems          0.344    0.092    3.720    0.000    0.344    0.345</span></span>
<span><span class="co">#&gt;    .intimacy          0.466    0.084    5.571    0.000    0.466    0.468</span></span>
<span><span class="co">#&gt;    .father            0.373    0.062    6.035    0.000    0.373    0.375</span></span>
<span><span class="co">#&gt;    .mother            0.183    0.066    2.758    0.006    0.183    0.184</span></span>
<span><span class="co">#&gt;    .famo              0.748    0.079    9.530    0.000    0.748    0.752</span></span>
<span><span class="co">#&gt;    .adjust            0.414    0.095    4.364    0.000    0.636    0.636</span></span>
<span><span class="co">#&gt;     family            0.622    0.104    5.974    0.000    1.000    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     problems          0.655</span></span>
<span><span class="co">#&gt;     intimacy          0.532</span></span>
<span><span class="co">#&gt;     father            0.625</span></span>
<span><span class="co">#&gt;     mother            0.816</span></span>
<span><span class="co">#&gt;     famo              0.248</span></span>
<span><span class="co">#&gt;     adjust            0.364</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-model-diagram-full-sem">Example Model: Diagram Full SEM<a class="anchor" aria-label="anchor" href="#example-model-diagram-full-sem"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html" class="external-link">semPaths</a></span><span class="op">(</span><span class="va">predict.fit</span>, </span>
<span>         whatLabels<span class="op">=</span><span class="st">"std"</span>, </span>
<span>         layout<span class="op">=</span><span class="st">"tree"</span>, </span>
<span>         edge.label.cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_sem_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="example-2-composite-variables">Example 2: Composite Variables<a class="anchor" aria-label="anchor" href="#example-2-composite-variables"></a>
</h2>
<p><img src="pictures%2Ffull_example.png" width="75%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="example-2-setup">Example 2: Setup<a class="anchor" aria-label="anchor" href="#example-2-setup"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">family.cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/lav_matrix.html" class="external-link">lav_matrix_lower2full</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.00</span>, </span>
<span>                                     <span class="fl">.42</span>,   <span class="fl">1.00</span>, </span>
<span>                                    <span class="op">-</span><span class="fl">.43</span>,   <span class="op">-</span><span class="fl">.50</span>,   <span class="fl">1.00</span>, </span>
<span>                                    <span class="op">-</span><span class="fl">.39</span>,   <span class="op">-</span><span class="fl">.43</span>,   <span class="fl">.78</span>,    <span class="fl">1.00</span>,   </span>
<span>                                    <span class="op">-</span><span class="fl">.24</span>,   <span class="op">-</span><span class="fl">.37</span>,   <span class="fl">.69</span>,    <span class="fl">.73</span>,    <span class="fl">1.00</span>, </span>
<span>                                    <span class="op">-</span><span class="fl">.31</span>,   <span class="op">-</span><span class="fl">.33</span>,   <span class="fl">.63</span>,    <span class="fl">.87</span>,    <span class="fl">.72</span>,    <span class="fl">1.00</span>,   </span>
<span>                                    <span class="op">-</span><span class="fl">.25</span>,   <span class="op">-</span><span class="fl">.25</span>,   <span class="fl">.49</span>,    <span class="fl">.53</span>,    <span class="fl">.60</span>,    <span class="fl">.59</span>,    <span class="fl">1.00</span>, </span>
<span>                                     <span class="op">-</span><span class="fl">.25</span>,  <span class="op">-</span><span class="fl">.26</span>,   <span class="fl">.42</span>,    <span class="fl">.42</span>,    <span class="fl">.44</span>,    <span class="fl">.45</span>,    <span class="fl">.77</span>,    <span class="fl">1.00</span>,   </span>
<span>                                     <span class="op">-</span><span class="fl">.16</span>,  <span class="op">-</span><span class="fl">.18</span>,   <span class="fl">.23</span>,    <span class="fl">.36</span>,    <span class="fl">.38</span>,    <span class="fl">.38</span>,    <span class="fl">.59</span>,    <span class="fl">.58</span>, <span class="fl">1.00</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">family.sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13.00</span>,   <span class="fl">13.50</span>,  <span class="fl">13.10</span>,  <span class="fl">12.50</span>,  <span class="fl">13.50</span>,  <span class="fl">14.20</span>,  <span class="fl">9.50</span>,   <span class="fl">11.10</span>,  <span class="fl">8.70</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">family.cor</span><span class="op">)</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">family.cor</span><span class="op">)</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">family.sd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parent_psych"</span>,<span class="st">"low_SES"</span>,<span class="st">"verbal"</span>,</span>
<span>                        <span class="st">"reading"</span>,<span class="st">"math"</span>,<span class="st">"spelling"</span>,<span class="st">"motivation"</span>,<span class="st">"harmony"</span>,<span class="st">"stable"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">family.cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/getCov.html" class="external-link">cor2cov</a></span><span class="op">(</span><span class="va">family.cor</span>, <span class="va">family.sd</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-2-build-the-model">Example 2: Build the Model<a class="anchor" aria-label="anchor" href="#example-2-build-the-model"></a>
</h2>
<ul>
<li>How to define a composite variable?</li>
<li>We have been using <code>=~</code> to define a latent variable that
predicts manifest variables.</li>
<li>Use <code>&lt;~</code> to create a composite variable that is
predicted by the manifest variables.</li>
</ul>
</div>
<div class="section level2">
<h2 id="example-2-build-the-model-1">Example 2: Build the Model<a class="anchor" aria-label="anchor" href="#example-2-build-the-model-1"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">composite.model</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">risk &lt;~ low_SES + parent_psych + verbal</span></span>
<span><span class="st">achieve =~ reading + math + spelling</span></span>
<span><span class="st">adjustment =~ motivation + harmony + stable</span></span>
<span><span class="st">risk =~ achieve + adjustment</span></span>
<span><span class="st">'</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-2-analyze-the-model">Example 2: Analyze the Model<a class="anchor" aria-label="anchor" href="#example-2-analyze-the-model"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">composite.fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">composite.model</span>, </span>
<span>                      sample.cov <span class="op">=</span> <span class="va">family.cov</span>, </span>
<span>                      sample.nobs <span class="op">=</span> <span class="fl">158</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-2-summarize-the-model">Example 2: Summarize the Model<a class="anchor" aria-label="anchor" href="#example-2-summarize-the-model"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">composite.fit</span>, </span>
<span>        rsquare <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>        standardized <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        fit.measures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 78 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           158</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                94.965</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                23</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test statistic                               852.585</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                33</span></span>
<span><span class="co">#&gt;   P-value                                        0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; User Model versus Baseline Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Comparative Fit Index (CFI)                    0.912</span></span>
<span><span class="co">#&gt;   Tucker-Lewis Index (TLI)                       0.874</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Loglikelihood and Information Criteria:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Loglikelihood user model (H0)              -3270.643</span></span>
<span><span class="co">#&gt;   Loglikelihood unrestricted model (H1)      -3223.160</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Akaike (AIC)                                6573.286</span></span>
<span><span class="co">#&gt;   Bayesian (BIC)                              6622.287</span></span>
<span><span class="co">#&gt;   Sample-size adjusted Bayesian (SABIC)       6571.640</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Root Mean Square Error of Approximation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   RMSEA                                          0.141</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - lower         0.112</span></span>
<span><span class="co">#&gt;   90 Percent confidence interval - upper         0.171</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &lt;= 0.050                    0.000</span></span>
<span><span class="co">#&gt;   P-value H_0: RMSEA &gt;= 0.080                    1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Standardized Root Mean Square Residual:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SRMR                                           0.089</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Estimates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Standard errors                             Standard</span></span>
<span><span class="co">#&gt;   Information                                 Expected</span></span>
<span><span class="co">#&gt;   Information saturated (h1) model          Structured</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   achieve =~                                                            </span></span>
<span><span class="co">#&gt;     reading           1.000                              12.183    0.978</span></span>
<span><span class="co">#&gt;     math              0.843    0.062   13.545    0.000   10.265    0.763</span></span>
<span><span class="co">#&gt;     spelling          1.030    0.053   19.583    0.000   12.546    0.886</span></span>
<span><span class="co">#&gt;   adjustment =~                                                         </span></span>
<span><span class="co">#&gt;     motivation        1.000                               8.632    0.912</span></span>
<span><span class="co">#&gt;     harmony           1.089    0.092   11.861    0.000    9.402    0.850</span></span>
<span><span class="co">#&gt;     stable            0.654    0.074    8.828    0.000    5.642    0.651</span></span>
<span><span class="co">#&gt;   risk =~                                                               </span></span>
<span><span class="co">#&gt;     achieve           1.000                               0.794    0.794</span></span>
<span><span class="co">#&gt;     adjustment        0.457    0.074    6.206    0.000    0.511    0.511</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Composites:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;   risk &lt;~                                                               </span></span>
<span><span class="co">#&gt;     low_SES          -0.033    0.050   -0.647    0.518   -0.003   -0.045</span></span>
<span><span class="co">#&gt;     parent_psych     -0.055    0.050   -1.095    0.274   -0.006   -0.074</span></span>
<span><span class="co">#&gt;     verbal            0.698    0.055   12.576    0.000    0.072    0.942</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span></span>
<span><span class="co">#&gt;    .reading           6.831    3.848    1.775    0.076    6.831    0.044</span></span>
<span><span class="co">#&gt;    .math             75.732    9.120    8.304    0.000   75.732    0.418</span></span>
<span><span class="co">#&gt;    .spelling         42.954    6.357    6.757    0.000   42.954    0.214</span></span>
<span><span class="co">#&gt;    .motivation       15.162    4.920    3.082    0.002   15.162    0.169</span></span>
<span><span class="co">#&gt;    .harmony          34.034    6.723    5.062    0.000   34.034    0.278</span></span>
<span><span class="co">#&gt;    .stable           43.376    5.381    8.060    0.000   43.376    0.577</span></span>
<span><span class="co">#&gt;     risk              0.000                               0.000    0.000</span></span>
<span><span class="co">#&gt;    .achieve          54.931    7.452    7.372    0.000    0.370    0.370</span></span>
<span><span class="co">#&gt;    .adjustment       55.023    8.469    6.497    0.000    0.738    0.738</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-Square:</span></span>
<span><span class="co">#&gt;                    Estimate</span></span>
<span><span class="co">#&gt;     reading           0.956</span></span>
<span><span class="co">#&gt;     math              0.582</span></span>
<span><span class="co">#&gt;     spelling          0.786</span></span>
<span><span class="co">#&gt;     motivation        0.831</span></span>
<span><span class="co">#&gt;     harmony           0.722</span></span>
<span><span class="co">#&gt;     stable            0.423</span></span>
<span><span class="co">#&gt;     achieve           0.630</span></span>
<span><span class="co">#&gt;     adjustment        0.262</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-2-improve-the-model">Example 2: Improve the Model?<a class="anchor" aria-label="anchor" href="#example-2-improve-the-model"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/modificationIndices.html" class="external-link">modificationindices</a></span><span class="op">(</span><span class="va">composite.fit</span>, sort <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt;             lhs op          rhs     mi     epc sepc.lv sepc.all sepc.nox</span></span>
<span><span class="co">#&gt; 29         risk =~     spelling 22.091  -0.607  -5.874   -0.415   -0.415</span></span>
<span><span class="co">#&gt; 39      reading ~~         math 22.090 -27.301 -27.301   -1.200   -1.200</span></span>
<span><span class="co">#&gt; 54         risk ~~      achieve 15.658  42.911      NA       NA       NA</span></span>
<span><span class="co">#&gt; 56      achieve ~~   adjustment 15.658  19.593   0.356    0.356    0.356</span></span>
<span><span class="co">#&gt; 18         risk ~~         risk 15.658  42.911   0.000    0.000    0.000</span></span>
<span><span class="co">#&gt; 55         risk ~~   adjustment 15.658  19.593      NA       NA       NA</span></span>
<span><span class="co">#&gt; 37   adjustment =~         math 12.595   0.345   2.979    0.221    0.221</span></span>
<span><span class="co">#&gt; 33      achieve =~   motivation  8.857   0.140   1.710    0.181    0.181</span></span>
<span><span class="co">#&gt; 48     spelling ~~   motivation  8.351   8.974   8.974    0.352    0.352</span></span>
<span><span class="co">#&gt; 40      reading ~~     spelling  8.135  25.450  25.450    1.486    1.486</span></span>
<span><span class="co">#&gt; 28         risk =~         math  8.135   0.379   3.665    0.272    0.272</span></span>
<span><span class="co">#&gt; 45         math ~~   motivation  7.454  10.793  10.793    0.319    0.319</span></span>
<span><span class="co">#&gt; 38   adjustment =~     spelling  7.118   0.208   1.794    0.127    0.127</span></span>
<span><span class="co">#&gt; 44         math ~~     spelling  6.189  15.229  15.229    0.267    0.267</span></span>
<span><span class="co">#&gt; 27         risk =~      reading  6.189   0.320   3.090    0.248    0.248</span></span>
<span><span class="co">#&gt; 51   motivation ~~      harmony  4.044 -27.644 -27.644   -1.217   -1.217</span></span>
<span><span class="co">#&gt; 32         risk =~       stable  4.044  -0.138  -1.331   -0.153   -0.153</span></span>
<span><span class="co">#&gt; 41      reading ~~   motivation  3.494  -4.224  -4.224   -0.415   -0.415</span></span>
<span><span class="co">#&gt; 30         risk =~   motivation  2.929   0.122   1.183    0.125    0.125</span></span>
<span><span class="co">#&gt; 53      harmony ~~       stable  2.929  10.495  10.495    0.273    0.273</span></span>
<span><span class="co">#&gt; 43      reading ~~       stable  1.885   3.814   3.814    0.222    0.222</span></span>
<span><span class="co">#&gt; 36   adjustment =~      reading  1.618  -0.073  -0.634   -0.051   -0.051</span></span>
<span><span class="co">#&gt; 34      achieve =~      harmony  1.128  -0.059  -0.717   -0.065   -0.065</span></span>
<span><span class="co">#&gt; 46         math ~~      harmony  0.939  -4.694  -4.694   -0.092   -0.092</span></span>
<span><span class="co">#&gt; 31         risk =~      harmony  0.121  -0.028  -0.269   -0.024   -0.024</span></span>
<span><span class="co">#&gt; 52   motivation ~~       stable  0.121  -2.010  -2.010   -0.078   -0.078</span></span>
<span><span class="co">#&gt; 50     spelling ~~       stable  0.070   1.008   1.008    0.023    0.023</span></span>
<span><span class="co">#&gt; 49     spelling ~~      harmony  0.033  -0.687  -0.687   -0.018   -0.018</span></span>
<span><span class="co">#&gt; 42      reading ~~      harmony  0.021  -0.400  -0.400   -0.026   -0.026</span></span>
<span><span class="co">#&gt; 35      achieve =~       stable  0.017   0.007   0.082    0.009    0.009</span></span>
<span><span class="co">#&gt; 47         math ~~       stable  0.009   0.448   0.448    0.008    0.008</span></span>
<span><span class="co">#&gt; 58      low_SES  ~       verbal  0.000   0.000   0.000    0.000    0.000</span></span>
<span><span class="co">#&gt; 57      low_SES  ~ parent_psych  0.000   0.000   0.000    0.000    0.000</span></span>
<span><span class="co">#&gt; 60 parent_psych  ~       verbal  0.000   0.000   0.000    0.000    0.000</span></span>
<span><span class="co">#&gt; 59 parent_psych  ~      low_SES  0.000   0.000   0.000    0.000    0.000</span></span>
<span><span class="co">#&gt; 62       verbal  ~ parent_psych  0.000   0.000   0.000    0.000    0.000</span></span>
<span><span class="co">#&gt; 26       verbal ~~       verbal  0.000   0.000   0.000    0.000    0.000</span></span>
<span><span class="co">#&gt; 61       verbal  ~      low_SES  0.000   0.000   0.000    0.000    0.000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-2-diagram-the-model">Example 2: Diagram the Model<a class="anchor" aria-label="anchor" href="#example-2-diagram-the-model"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/semPlot/man/semPaths.html" class="external-link">semPaths</a></span><span class="op">(</span><span class="va">composite.fit</span>, </span>
<span>         whatLabels<span class="op">=</span><span class="st">"std"</span>, </span>
<span>         layout<span class="op">=</span><span class="st">"tree"</span>,</span>
<span>         edge.label.cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="lecture_sem_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<ul>
<li>
<p>In this lecture you’ve learned:</p>
<ul>
<li>How to build on our previous work of measurement models</li>
<li>How to build a composite variable and run those models</li>
<li>How to examine for invariance when building a full SEM</li>
</ul>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Erin M. Buchanan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
